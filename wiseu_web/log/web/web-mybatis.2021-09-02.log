09-02 12:12:34.570 ocalhost-startStop-1 Logging initialized using 'class org.apache.ibatis.logging.slf4j.Slf4jImpl' adapter.
09-02 12:12:44.456 ocalhost-startStop-1 MenuLang.getLangList
09-02 12:12:44.458 ocalhost-startStop-1 ==>  Preparing: SELECT lang FROM nvmenu_lang GROUP BY lang 
09-02 12:12:44.465 ocalhost-startStop-1 ==> Parameters: 
09-02 12:12:44.513 ocalhost-startStop-1 <==      Total: 1
09-02 12:12:44.519 ocalhost-startStop-1 Menu.getTopMenuList
09-02 12:12:44.519 ocalhost-startStop-1 ==>  Preparing: SELECT menu_cd, pmenu_cd, coalesce(level_no,0) level_no, menu_nm, menu_link_url, menu_icon_img, active_yn, module_nm, coalesce(sort_no,0) sort_no, m_type FROM nvmenu WHERE pmenu_cd IS NULL AND active_yn = 'Y' ORDER BY sort_no 
09-02 12:12:44.560 ocalhost-startStop-1 ==> Parameters: 
09-02 12:12:44.637 ocalhost-startStop-1 <==      Total: 7
09-02 12:12:44.640 ocalhost-startStop-1 Menu.getSubMenuList
09-02 12:12:44.640 ocalhost-startStop-1 ==>  Preparing: SELECT a.menu_cd, a.pmenu_cd, coalesce(a.level_no,0) level_no, b.menu_nm, a.menu_link_url, a.menu_icon_img, a.active_yn, a.module_nm, coalesce(a.sort_no,0) sort_no, a.m_type FROM nvmenu a, nvmenu_lang b WHERE a.menu_cd = b.menu_cd AND a.pmenu_cd IS NOT NULL AND a.active_yn = 'Y' AND b.lang = ? ORDER BY a.pmenu_cd, a.sort_no, a.menu_cd 
09-02 12:12:44.640 ocalhost-startStop-1 ==> Parameters: ko(String)
09-02 12:12:44.747 ocalhost-startStop-1 <==      Total: 37
09-02 12:12:44.777 ocalhost-startStop-1 MenuLang.selectMenuNames
09-02 12:12:44.777 ocalhost-startStop-1 ==>  Preparing: SELECT menu_cd, menu_nm FROM nvmenu_lang WHERE lang = ? 
09-02 12:12:44.777 ocalhost-startStop-1 ==> Parameters: ko(String)
09-02 12:12:44.801 ocalhost-startStop-1 <==      Total: 56
09-02 12:26:06.587 ocalhost-startStop-1 Logging initialized using 'class org.apache.ibatis.logging.slf4j.Slf4jImpl' adapter.
09-02 12:26:17.325 ocalhost-startStop-1 MenuLang.getLangList
09-02 12:26:17.328 ocalhost-startStop-1 ==>  Preparing: SELECT lang FROM nvmenu_lang GROUP BY lang 
09-02 12:26:17.345 ocalhost-startStop-1 ==> Parameters: 
09-02 12:26:17.390 ocalhost-startStop-1 <==      Total: 1
09-02 12:26:17.400 ocalhost-startStop-1 Menu.getTopMenuList
09-02 12:26:17.400 ocalhost-startStop-1 ==>  Preparing: SELECT menu_cd, pmenu_cd, coalesce(level_no,0) level_no, menu_nm, menu_link_url, menu_icon_img, active_yn, module_nm, coalesce(sort_no,0) sort_no, m_type FROM nvmenu WHERE pmenu_cd IS NULL AND active_yn = 'Y' ORDER BY sort_no 
09-02 12:26:17.400 ocalhost-startStop-1 ==> Parameters: 
09-02 12:26:17.408 ocalhost-startStop-1 <==      Total: 7
09-02 12:26:17.446 ocalhost-startStop-1 Menu.getSubMenuList
09-02 12:26:17.446 ocalhost-startStop-1 ==>  Preparing: SELECT a.menu_cd, a.pmenu_cd, coalesce(a.level_no,0) level_no, b.menu_nm, a.menu_link_url, a.menu_icon_img, a.active_yn, a.module_nm, coalesce(a.sort_no,0) sort_no, a.m_type FROM nvmenu a, nvmenu_lang b WHERE a.menu_cd = b.menu_cd AND a.pmenu_cd IS NOT NULL AND a.active_yn = 'Y' AND b.lang = ? ORDER BY a.pmenu_cd, a.sort_no, a.menu_cd 
09-02 12:26:17.447 ocalhost-startStop-1 ==> Parameters: ko(String)
09-02 12:26:17.468 ocalhost-startStop-1 <==      Total: 37
09-02 12:26:17.474 ocalhost-startStop-1 MenuLang.selectMenuNames
09-02 12:26:17.474 ocalhost-startStop-1 ==>  Preparing: SELECT menu_cd, menu_nm FROM nvmenu_lang WHERE lang = ? 
09-02 12:26:17.474 ocalhost-startStop-1 ==> Parameters: ko(String)
09-02 12:26:17.487 ocalhost-startStop-1 <==      Total: 56
09-02 12:26:22.353 ttp-nio-18084-exec-2 User.selectAdminByAdminId
09-02 12:26:22.353 ttp-nio-18084-exec-2 ==>  Preparing: SELECT a.user_id, a.pass_wd, a.pass_salt, a.grp_cd, a.name_kor, a.name_eng, a.tel_no, a.email, a.user_class, a.usertype_cd, a.lastupdate_dt, a.active_yn, a.accept_yn , a.list_count_per_page, a.soeid, a.geid, a.isa_role, a.work_doc, a.user_role, a.create_user, a.permit_sts, a.permit_dt, a.login_cnt, a.lastlogin_dt , b.grp_nm, b.req_dept_id as req_dept, a.user_id as req_user FROM nvuser a, nvusergrp b WHERE a.grp_cd = b.grp_cd AND a.user_id = ? AND a.active_yn = 'Y' AND a.accept_yn = 'Y' 
09-02 12:26:22.354 ttp-nio-18084-exec-2 ==> Parameters: admin(String)
09-02 12:26:22.514 ttp-nio-18084-exec-2 <==      Total: 1
09-02 12:26:22.521 ttp-nio-18084-exec-2 Menu.selectRoleMap
09-02 12:26:22.521 ttp-nio-18084-exec-2 ==>  Preparing: SELECT a.menu_link_url, a.menu_cd, b.read_auth, b.write_auth, b.execute_auth FROM nvmenu a, nvmenurole b WHERE a.menu_cd = b.menu_cd AND a.menu_link_url IS NOT NULL AND b.user_id = ? 
09-02 12:26:22.522 ttp-nio-18084-exec-2 ==> Parameters: admin(String)
09-02 12:26:22.603 ttp-nio-18084-exec-2 <==      Total: 46
09-02 12:26:22.614 ttp-nio-18084-exec-2 User.updateLoginFailCountToInitial
09-02 12:26:22.615 ttp-nio-18084-exec-2 ==>  Preparing: UPDATE nvuser SET login_cnt = '0', lastlogin_dt = to_char(sysdate, 'yyyyMMdd') WHERE user_id = ? 
09-02 12:26:22.615 ttp-nio-18084-exec-2 ==> Parameters: admin(String)
09-02 12:26:22.649 ttp-nio-18084-exec-2 <==    Updates: 1
09-02 12:26:22.868 ttp-nio-18084-exec-2 MenuRole.getUserMenuList
09-02 12:26:22.868 ttp-nio-18084-exec-2 ==>  Preparing: SELECT a.user_id, a.menu_cd, a.read_auth, a.write_auth, a.execute_auth, b.menu_link_url FROM nvmenurole a, nvmenu b WHERE a.menu_cd = b.menu_cd AND a.user_id = ? AND b.active_yn = 'Y' AND b.pmenu_cd IS NOT NULL ORDER BY menu_cd, sort_no 
09-02 12:26:22.868 ttp-nio-18084-exec-2 ==> Parameters: admin(String)
09-02 12:26:22.876 ttp-nio-18084-exec-2 <==      Total: 37
09-02 12:26:23.095 ttp-nio-18084-exec-3 Scenario.getScenarioTotalCount
09-02 12:26:23.095 ttp-nio-18084-exec-3 ==>  Preparing: SELECT count(*) FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? 
09-02 12:26:23.095 ttp-nio-18084-exec-3 ==> Parameters: 20200902(String), 20210902(String)
09-02 12:26:23.151 ttp-nio-18084-exec-3 <==      Total: 1
09-02 12:26:23.166 ttp-nio-18084-exec-3 Scenario.getCampaignScenarioList
09-02 12:26:23.166 ttp-nio-18084-exec-3 ==>  Preparing: SELECT coalesce(scenario_no,0) scenario_no, user_id, grp_cd, scenario_nm, finish_yn , (SELECT grp_nm FROM nvusergrp WHERE grp_cd = x.grp_cd) grp_nm , (SELECT name_kor FROM nvuser WHERE user_id = x.user_id) name_kor , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = x.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100221' AND cd = x.relation_type AND lang = ?) relation_type_nm , to_char(to_date(create_dt, 'yyyymmdd'), 'yy-mm-dd') create_dt , coalesce(campaign_no,0) campaign_no, coalesce(campaign_preface,'') campaign_preface , CASE WHEN sendstart_dtm = '' THEN '' ELSE to_char(to_date(sendstart_dtm, 'yyyymmddhh24miss'), 'yy-mm-dd hh24:mi') END sendstart_dtm , CASE WHEN campaign_sts = 'P' THEN (CASE WHEN approval_sts IS NULL THEN campaign_sts ELSE approval_sts END) ELSE campaign_sts END campaign_sts , relation_type, coalesce(depth_no,0) depth_no, channel_type, campaign_level , divide_yn, ab_test_type, campaign_preface_ab, coalesce(segment_no,-1) segment_no, relation_tree , tag_nm, coalesce(result_seq,0) result_seq, coalesce(segment_size,0) target_cnt FROM ( SELECT row_number() OVER(ORDER BY a.scenario_no DESC, c.relation_tree, c.campaign_no) rnum , a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_type, a.finish_yn, a.create_dt, b.tag_nm , c.campaign_no, c.campaign_preface, concat(coalesce(c.sendstart_dt,''), coalesce(c.sendstart_tm,'')) sendstart_dtm , c.campaign_sts, c.approval_sts, c.relation_type, c.depth_no, c.channel_type, c.campaign_level , c.divide_yn, c.ab_test_type, c.campaign_preface_ab, c.segment_no, c.relation_tree , d.result_seq, e.segment_size FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no LEFT OUTER JOIN nvsegment e ON c.segment_no = e.segment_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? ORDER BY a.scenario_no DESC, relation_tree, c.campaign_no DESC ) x WHERE rnum >= ((? - 1) * ? + 1) AND rnum <= ? * ? ORDER BY scenario_no DESC, relation_tree, campaign_no DESC 
09-02 12:26:23.173 ttp-nio-18084-exec-3 ==> Parameters: ko(String), ko(String), 20200902(String), 20210902(String), 1(Integer), 10(Integer), 1(Integer), 10(Integer)
09-02 12:26:23.256 ttp-nio-18084-exec-3 <==      Total: 10
09-02 12:26:29.787 ttp-nio-18084-exec-1 Scenario.getScenarioTotalCount
09-02 12:26:29.787 ttp-nio-18084-exec-1 ==>  Preparing: SELECT count(*) FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? 
09-02 12:26:29.788 ttp-nio-18084-exec-1 ==> Parameters: 20200902(String), 20210902(String)
09-02 12:26:29.789 ttp-nio-18084-exec-1 <==      Total: 1
09-02 12:26:29.793 ttp-nio-18084-exec-1 Scenario.getCampaignScenarioList
09-02 12:26:29.794 ttp-nio-18084-exec-1 ==>  Preparing: SELECT coalesce(scenario_no,0) scenario_no, user_id, grp_cd, scenario_nm, finish_yn , (SELECT grp_nm FROM nvusergrp WHERE grp_cd = x.grp_cd) grp_nm , (SELECT name_kor FROM nvuser WHERE user_id = x.user_id) name_kor , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = x.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100221' AND cd = x.relation_type AND lang = ?) relation_type_nm , to_char(to_date(create_dt, 'yyyymmdd'), 'yy-mm-dd') create_dt , coalesce(campaign_no,0) campaign_no, coalesce(campaign_preface,'') campaign_preface , CASE WHEN sendstart_dtm = '' THEN '' ELSE to_char(to_date(sendstart_dtm, 'yyyymmddhh24miss'), 'yy-mm-dd hh24:mi') END sendstart_dtm , CASE WHEN campaign_sts = 'P' THEN (CASE WHEN approval_sts IS NULL THEN campaign_sts ELSE approval_sts END) ELSE campaign_sts END campaign_sts , relation_type, coalesce(depth_no,0) depth_no, channel_type, campaign_level , divide_yn, ab_test_type, campaign_preface_ab, coalesce(segment_no,-1) segment_no, relation_tree , tag_nm, coalesce(result_seq,0) result_seq, coalesce(segment_size,0) target_cnt FROM ( SELECT row_number() OVER(ORDER BY a.scenario_no DESC, c.relation_tree, c.campaign_no) rnum , a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_type, a.finish_yn, a.create_dt, b.tag_nm , c.campaign_no, c.campaign_preface, concat(coalesce(c.sendstart_dt,''), coalesce(c.sendstart_tm,'')) sendstart_dtm , c.campaign_sts, c.approval_sts, c.relation_type, c.depth_no, c.channel_type, c.campaign_level , c.divide_yn, c.ab_test_type, c.campaign_preface_ab, c.segment_no, c.relation_tree , d.result_seq, e.segment_size FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no LEFT OUTER JOIN nvsegment e ON c.segment_no = e.segment_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? ORDER BY a.scenario_no DESC, relation_tree, c.campaign_no DESC ) x WHERE rnum >= ((? - 1) * ? + 1) AND rnum <= ? * ? ORDER BY scenario_no DESC, relation_tree, campaign_no DESC 
09-02 12:26:29.795 ttp-nio-18084-exec-1 ==> Parameters: ko(String), ko(String), 20200902(String), 20210902(String), 2(Integer), 10(Integer), 2(Integer), 10(Integer)
09-02 12:26:29.813 ttp-nio-18084-exec-1 <==      Total: 10
09-02 12:26:31.491 ttp-nio-18084-exec-3 Scenario.selectScenarioBasicInfo
09-02 12:26:31.491 ttp-nio-18084-exec-3 ==>  Preparing: SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_desc, b.campaign_preface, b.campaign_sts , b.campaign_type, b.sendstart_dt, b.sendstart_tm, b.target_cnt, b.survey_no, coalesce(b.retry_cnt,1) retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm, b.sender_tel , b.retmail_receiver, b.channel_type, b.promotion_type, b.campaign_level, b.depth_no, b.approval_sts, b.req_dept_id req_dept, b.req_user_id req_user, b.divide_yn, b.divide_interval , coalesce(b.divide_cnt,0) divide_cnt, b.ab_test_type, b.ab_test_cond, coalesce(b.ab_test_rate,0) ab_test_rate, b.campaign_preface_ab , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = b.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100121' AND cd = b.approval_sts AND lang = ?) approval_sts_nm , (CASE WHEN b.channel_type = 'm' THEN 4 WHEN b.channel_type = 's' THEN 3 WHEN b.channel_type = 't' THEN 2 ELSE 1 END) seq , c.tag_nm, d.grp_nm, e.name_kor, f.supracampaign_no, '' req_grp_nm FROM nvscenario a, nvcampaign b, nvcamptag c, nvusergrp d, nvuser e, nvschedule f WHERE a.scenario_no = b.scenario_no AND a.tag_no = c.tag_no AND a.grp_cd = d.grp_cd AND a.user_id = e.user_id AND b.campaign_no = f.campaign_no AND a.scenario_no = ? AND b.campaign_no = ? ORDER BY seq DESC 
09-02 12:26:31.492 ttp-nio-18084-exec-3 ==> Parameters: ko(String), ko(String), 14(Integer), 10(Integer)
09-02 12:26:31.513 ttp-nio-18084-exec-3 <==      Total: 1
09-02 12:26:31.524 ttp-nio-18084-exec-3 Scenario.selectOmniChannelCampaigns
09-02 12:26:31.524 ttp-nio-18084-exec-3 ==>  Preparing: SELECT c.scenario_no, c.scenario_nm, c.campaign_no, c.depth_no, c.channel_type, c.relation_type , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = c.campaign_sts AND lang = ?) campaign_sts_nm , concat(c.sendstart_dt, c.sendstart_tm) as sendstart_dtm, d.segment_size as target_cnt FROM ( SELECT a.scenario_no, a.scenario_nm, b.campaign_no, b.segment_no, b.depth_no, b.channel_type, b.relation_type, b.campaign_sts, b.sendstart_dt, b.sendstart_tm, b.relation_tree FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = (SELECT scenario_no FROM nvcampaign WHERE campaign_no = ?) AND b.relation_type IN ('N', 'S', 'F', 'O') ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ORDER BY rpad( c.relation_tree , (SELECT max(depth_no) FROM nvcampaign WHERE scenario_no = (SELECT scenario_no FROM nvcampaign WHERE campaign_no = ?)) , 0 ), c.campaign_no 
09-02 12:26:31.525 ttp-nio-18084-exec-3 ==> Parameters: ko(String), 10(Integer), 10(Integer)
09-02 12:26:31.528 ttp-nio-18084-exec-3 <==      Total: 3
09-02 12:31:51.310 ttp-nio-18084-exec-5 Scenario.getScenarioTotalCount
09-02 12:31:51.310 ttp-nio-18084-exec-5 ==>  Preparing: SELECT count(*) FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? 
09-02 12:31:51.310 ttp-nio-18084-exec-5 ==> Parameters: 20200902(String), 20210902(String)
09-02 12:31:51.312 ttp-nio-18084-exec-5 <==      Total: 1
09-02 12:31:51.317 ttp-nio-18084-exec-5 Scenario.getCampaignScenarioList
09-02 12:31:51.318 ttp-nio-18084-exec-5 ==>  Preparing: SELECT coalesce(scenario_no,0) scenario_no, user_id, grp_cd, scenario_nm, finish_yn , (SELECT grp_nm FROM nvusergrp WHERE grp_cd = x.grp_cd) grp_nm , (SELECT name_kor FROM nvuser WHERE user_id = x.user_id) name_kor , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = x.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100221' AND cd = x.relation_type AND lang = ?) relation_type_nm , to_char(to_date(create_dt, 'yyyymmdd'), 'yy-mm-dd') create_dt , coalesce(campaign_no,0) campaign_no, coalesce(campaign_preface,'') campaign_preface , CASE WHEN sendstart_dtm = '' THEN '' ELSE to_char(to_date(sendstart_dtm, 'yyyymmddhh24miss'), 'yy-mm-dd hh24:mi') END sendstart_dtm , CASE WHEN campaign_sts = 'P' THEN (CASE WHEN approval_sts IS NULL THEN campaign_sts ELSE approval_sts END) ELSE campaign_sts END campaign_sts , relation_type, coalesce(depth_no,0) depth_no, channel_type, campaign_level , divide_yn, ab_test_type, campaign_preface_ab, coalesce(segment_no,-1) segment_no, relation_tree , tag_nm, coalesce(result_seq,0) result_seq, coalesce(segment_size,0) target_cnt FROM ( SELECT row_number() OVER(ORDER BY a.scenario_no DESC, c.relation_tree, c.campaign_no) rnum , a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_type, a.finish_yn, a.create_dt, b.tag_nm , c.campaign_no, c.campaign_preface, concat(coalesce(c.sendstart_dt,''), coalesce(c.sendstart_tm,'')) sendstart_dtm , c.campaign_sts, c.approval_sts, c.relation_type, c.depth_no, c.channel_type, c.campaign_level , c.divide_yn, c.ab_test_type, c.campaign_preface_ab, c.segment_no, c.relation_tree , d.result_seq, e.segment_size FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no LEFT OUTER JOIN nvsegment e ON c.segment_no = e.segment_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? ORDER BY a.scenario_no DESC, relation_tree, c.campaign_no DESC ) x WHERE rnum >= ((? - 1) * ? + 1) AND rnum <= ? * ? ORDER BY scenario_no DESC, relation_tree, campaign_no DESC 
09-02 12:31:51.320 ttp-nio-18084-exec-5 ==> Parameters: ko(String), ko(String), 20200902(String), 20210902(String), 1(Integer), 10(Integer), 1(Integer), 10(Integer)
09-02 12:31:51.327 ttp-nio-18084-exec-5 <==      Total: 10
09-02 12:31:53.309 ttp-nio-18084-exec-1 Scenario.getScenarioTotalCount
09-02 12:31:53.309 ttp-nio-18084-exec-1 ==>  Preparing: SELECT count(*) FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? 
09-02 12:31:53.309 ttp-nio-18084-exec-1 ==> Parameters: 20200902(String), 20210902(String)
09-02 12:31:53.312 ttp-nio-18084-exec-1 <==      Total: 1
09-02 12:31:53.318 ttp-nio-18084-exec-1 Scenario.getCampaignScenarioList
09-02 12:31:53.319 ttp-nio-18084-exec-1 ==>  Preparing: SELECT coalesce(scenario_no,0) scenario_no, user_id, grp_cd, scenario_nm, finish_yn , (SELECT grp_nm FROM nvusergrp WHERE grp_cd = x.grp_cd) grp_nm , (SELECT name_kor FROM nvuser WHERE user_id = x.user_id) name_kor , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = x.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100221' AND cd = x.relation_type AND lang = ?) relation_type_nm , to_char(to_date(create_dt, 'yyyymmdd'), 'yy-mm-dd') create_dt , coalesce(campaign_no,0) campaign_no, coalesce(campaign_preface,'') campaign_preface , CASE WHEN sendstart_dtm = '' THEN '' ELSE to_char(to_date(sendstart_dtm, 'yyyymmddhh24miss'), 'yy-mm-dd hh24:mi') END sendstart_dtm , CASE WHEN campaign_sts = 'P' THEN (CASE WHEN approval_sts IS NULL THEN campaign_sts ELSE approval_sts END) ELSE campaign_sts END campaign_sts , relation_type, coalesce(depth_no,0) depth_no, channel_type, campaign_level , divide_yn, ab_test_type, campaign_preface_ab, coalesce(segment_no,-1) segment_no, relation_tree , tag_nm, coalesce(result_seq,0) result_seq, coalesce(segment_size,0) target_cnt FROM ( SELECT row_number() OVER(ORDER BY a.scenario_no DESC, c.relation_tree, c.campaign_no) rnum , a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_type, a.finish_yn, a.create_dt, b.tag_nm , c.campaign_no, c.campaign_preface, concat(coalesce(c.sendstart_dt,''), coalesce(c.sendstart_tm,'')) sendstart_dtm , c.campaign_sts, c.approval_sts, c.relation_type, c.depth_no, c.channel_type, c.campaign_level , c.divide_yn, c.ab_test_type, c.campaign_preface_ab, c.segment_no, c.relation_tree , d.result_seq, e.segment_size FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no LEFT OUTER JOIN nvsegment e ON c.segment_no = e.segment_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? ORDER BY a.scenario_no DESC, relation_tree, c.campaign_no DESC ) x WHERE rnum >= ((? - 1) * ? + 1) AND rnum <= ? * ? ORDER BY scenario_no DESC, relation_tree, campaign_no DESC 
09-02 12:31:53.320 ttp-nio-18084-exec-1 ==> Parameters: ko(String), ko(String), 20200902(String), 20210902(String), 3(Integer), 10(Integer), 3(Integer), 10(Integer)
09-02 12:31:53.325 ttp-nio-18084-exec-1 <==      Total: 10
09-02 12:32:14.230 ttp-nio-18084-exec-4 Scenario.selectScenarioBasicInfo
09-02 12:32:14.230 ttp-nio-18084-exec-4 ==>  Preparing: SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_desc, b.campaign_preface, b.campaign_sts , b.campaign_type, b.sendstart_dt, b.sendstart_tm, b.target_cnt, b.survey_no, coalesce(b.retry_cnt,1) retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm, b.sender_tel , b.retmail_receiver, b.channel_type, b.promotion_type, b.campaign_level, b.depth_no, b.approval_sts, b.req_dept_id req_dept, b.req_user_id req_user, b.divide_yn, b.divide_interval , coalesce(b.divide_cnt,0) divide_cnt, b.ab_test_type, b.ab_test_cond, coalesce(b.ab_test_rate,0) ab_test_rate, b.campaign_preface_ab , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = b.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100121' AND cd = b.approval_sts AND lang = ?) approval_sts_nm , (CASE WHEN b.channel_type = 'm' THEN 4 WHEN b.channel_type = 's' THEN 3 WHEN b.channel_type = 't' THEN 2 ELSE 1 END) seq , c.tag_nm, d.grp_nm, e.name_kor, f.supracampaign_no, '' req_grp_nm FROM nvscenario a, nvcampaign b, nvcamptag c, nvusergrp d, nvuser e, nvschedule f WHERE a.scenario_no = b.scenario_no AND a.tag_no = c.tag_no AND a.grp_cd = d.grp_cd AND a.user_id = e.user_id AND b.campaign_no = f.campaign_no AND a.scenario_no = ? AND b.campaign_no = ? ORDER BY seq DESC 
09-02 12:32:14.231 ttp-nio-18084-exec-4 ==> Parameters: ko(String), ko(String), 5(Integer), 3(Integer)
09-02 12:32:14.233 ttp-nio-18084-exec-4 <==      Total: 1
09-02 12:32:14.266 ttp-nio-18084-exec-4 Scenario.selectOmniChannelCampaigns
09-02 12:32:14.266 ttp-nio-18084-exec-4 ==>  Preparing: SELECT c.scenario_no, c.scenario_nm, c.campaign_no, c.depth_no, c.channel_type, c.relation_type , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = c.campaign_sts AND lang = ?) campaign_sts_nm , concat(c.sendstart_dt, c.sendstart_tm) as sendstart_dtm, d.segment_size as target_cnt FROM ( SELECT a.scenario_no, a.scenario_nm, b.campaign_no, b.segment_no, b.depth_no, b.channel_type, b.relation_type, b.campaign_sts, b.sendstart_dt, b.sendstart_tm, b.relation_tree FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = (SELECT scenario_no FROM nvcampaign WHERE campaign_no = ?) AND b.relation_type IN ('N', 'S', 'F', 'O') ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ORDER BY rpad( c.relation_tree , (SELECT max(depth_no) FROM nvcampaign WHERE scenario_no = (SELECT scenario_no FROM nvcampaign WHERE campaign_no = ?)) , 0 ), c.campaign_no 
09-02 12:32:14.266 ttp-nio-18084-exec-4 ==> Parameters: ko(String), 3(Integer), 3(Integer)
09-02 12:32:14.268 ttp-nio-18084-exec-4 <==      Total: 1
09-02 12:32:16.380 ttp-nio-18084-exec-3 Scenario.getScenarioTotalCount
09-02 12:32:16.380 ttp-nio-18084-exec-3 ==>  Preparing: SELECT count(*) FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? 
09-02 12:32:16.380 ttp-nio-18084-exec-3 ==> Parameters: 20200902(String), 20210902(String)
09-02 12:32:16.383 ttp-nio-18084-exec-3 <==      Total: 1
09-02 12:32:16.387 ttp-nio-18084-exec-3 Scenario.getCampaignScenarioList
09-02 12:32:16.387 ttp-nio-18084-exec-3 ==>  Preparing: SELECT coalesce(scenario_no,0) scenario_no, user_id, grp_cd, scenario_nm, finish_yn , (SELECT grp_nm FROM nvusergrp WHERE grp_cd = x.grp_cd) grp_nm , (SELECT name_kor FROM nvuser WHERE user_id = x.user_id) name_kor , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = x.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100221' AND cd = x.relation_type AND lang = ?) relation_type_nm , to_char(to_date(create_dt, 'yyyymmdd'), 'yy-mm-dd') create_dt , coalesce(campaign_no,0) campaign_no, coalesce(campaign_preface,'') campaign_preface , CASE WHEN sendstart_dtm = '' THEN '' ELSE to_char(to_date(sendstart_dtm, 'yyyymmddhh24miss'), 'yy-mm-dd hh24:mi') END sendstart_dtm , CASE WHEN campaign_sts = 'P' THEN (CASE WHEN approval_sts IS NULL THEN campaign_sts ELSE approval_sts END) ELSE campaign_sts END campaign_sts , relation_type, coalesce(depth_no,0) depth_no, channel_type, campaign_level , divide_yn, ab_test_type, campaign_preface_ab, coalesce(segment_no,-1) segment_no, relation_tree , tag_nm, coalesce(result_seq,0) result_seq, coalesce(segment_size,0) target_cnt FROM ( SELECT row_number() OVER(ORDER BY a.scenario_no DESC, c.relation_tree, c.campaign_no) rnum , a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_type, a.finish_yn, a.create_dt, b.tag_nm , c.campaign_no, c.campaign_preface, concat(coalesce(c.sendstart_dt,''), coalesce(c.sendstart_tm,'')) sendstart_dtm , c.campaign_sts, c.approval_sts, c.relation_type, c.depth_no, c.channel_type, c.campaign_level , c.divide_yn, c.ab_test_type, c.campaign_preface_ab, c.segment_no, c.relation_tree , d.result_seq, e.segment_size FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no LEFT OUTER JOIN nvsegment e ON c.segment_no = e.segment_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? ORDER BY a.scenario_no DESC, relation_tree, c.campaign_no DESC ) x WHERE rnum >= ((? - 1) * ? + 1) AND rnum <= ? * ? ORDER BY scenario_no DESC, relation_tree, campaign_no DESC 
09-02 12:32:16.388 ttp-nio-18084-exec-3 ==> Parameters: ko(String), ko(String), 20200902(String), 20210902(String), 1(Integer), 10(Integer), 1(Integer), 10(Integer)
09-02 12:32:16.394 ttp-nio-18084-exec-3 <==      Total: 10
09-02 12:33:34.716 ttp-nio-18084-exec-5 Scenario.getScenarioTotalCount
09-02 12:33:34.717 ttp-nio-18084-exec-5 ==>  Preparing: SELECT count(*) FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? 
09-02 12:33:34.717 ttp-nio-18084-exec-5 ==> Parameters: 20200902(String), 20210902(String)
09-02 12:33:34.719 ttp-nio-18084-exec-5 <==      Total: 1
09-02 12:33:34.723 ttp-nio-18084-exec-5 Scenario.getCampaignScenarioList
09-02 12:33:34.723 ttp-nio-18084-exec-5 ==>  Preparing: SELECT coalesce(scenario_no,0) scenario_no, user_id, grp_cd, scenario_nm, finish_yn , (SELECT grp_nm FROM nvusergrp WHERE grp_cd = x.grp_cd) grp_nm , (SELECT name_kor FROM nvuser WHERE user_id = x.user_id) name_kor , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = x.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100221' AND cd = x.relation_type AND lang = ?) relation_type_nm , to_char(to_date(create_dt, 'yyyymmdd'), 'yy-mm-dd') create_dt , coalesce(campaign_no,0) campaign_no, coalesce(campaign_preface,'') campaign_preface , CASE WHEN sendstart_dtm = '' THEN '' ELSE to_char(to_date(sendstart_dtm, 'yyyymmddhh24miss'), 'yy-mm-dd hh24:mi') END sendstart_dtm , CASE WHEN campaign_sts = 'P' THEN (CASE WHEN approval_sts IS NULL THEN campaign_sts ELSE approval_sts END) ELSE campaign_sts END campaign_sts , relation_type, coalesce(depth_no,0) depth_no, channel_type, campaign_level , divide_yn, ab_test_type, campaign_preface_ab, coalesce(segment_no,-1) segment_no, relation_tree , tag_nm, coalesce(result_seq,0) result_seq, coalesce(segment_size,0) target_cnt FROM ( SELECT row_number() OVER(ORDER BY a.scenario_no DESC, c.relation_tree, c.campaign_no) rnum , a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_type, a.finish_yn, a.create_dt, b.tag_nm , c.campaign_no, c.campaign_preface, concat(coalesce(c.sendstart_dt,''), coalesce(c.sendstart_tm,'')) sendstart_dtm , c.campaign_sts, c.approval_sts, c.relation_type, c.depth_no, c.channel_type, c.campaign_level , c.divide_yn, c.ab_test_type, c.campaign_preface_ab, c.segment_no, c.relation_tree , d.result_seq, e.segment_size FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no LEFT OUTER JOIN nvsegment e ON c.segment_no = e.segment_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? ORDER BY a.scenario_no DESC, relation_tree, c.campaign_no DESC ) x WHERE rnum >= ((? - 1) * ? + 1) AND rnum <= ? * ? ORDER BY scenario_no DESC, relation_tree, campaign_no DESC 
09-02 12:33:34.723 ttp-nio-18084-exec-5 ==> Parameters: ko(String), ko(String), 20200902(String), 20210902(String), 2(Integer), 10(Integer), 2(Integer), 10(Integer)
09-02 12:33:34.727 ttp-nio-18084-exec-5 <==      Total: 10
09-02 12:33:36.323 ttp-nio-18084-exec-1 Scenario.getScenarioTotalCount
09-02 12:33:36.323 ttp-nio-18084-exec-1 ==>  Preparing: SELECT count(*) FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? 
09-02 12:33:36.323 ttp-nio-18084-exec-1 ==> Parameters: 20200902(String), 20210902(String)
09-02 12:33:36.325 ttp-nio-18084-exec-1 <==      Total: 1
09-02 12:33:36.327 ttp-nio-18084-exec-1 Scenario.getCampaignScenarioList
09-02 12:33:36.328 ttp-nio-18084-exec-1 ==>  Preparing: SELECT coalesce(scenario_no,0) scenario_no, user_id, grp_cd, scenario_nm, finish_yn , (SELECT grp_nm FROM nvusergrp WHERE grp_cd = x.grp_cd) grp_nm , (SELECT name_kor FROM nvuser WHERE user_id = x.user_id) name_kor , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = x.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100221' AND cd = x.relation_type AND lang = ?) relation_type_nm , to_char(to_date(create_dt, 'yyyymmdd'), 'yy-mm-dd') create_dt , coalesce(campaign_no,0) campaign_no, coalesce(campaign_preface,'') campaign_preface , CASE WHEN sendstart_dtm = '' THEN '' ELSE to_char(to_date(sendstart_dtm, 'yyyymmddhh24miss'), 'yy-mm-dd hh24:mi') END sendstart_dtm , CASE WHEN campaign_sts = 'P' THEN (CASE WHEN approval_sts IS NULL THEN campaign_sts ELSE approval_sts END) ELSE campaign_sts END campaign_sts , relation_type, coalesce(depth_no,0) depth_no, channel_type, campaign_level , divide_yn, ab_test_type, campaign_preface_ab, coalesce(segment_no,-1) segment_no, relation_tree , tag_nm, coalesce(result_seq,0) result_seq, coalesce(segment_size,0) target_cnt FROM ( SELECT row_number() OVER(ORDER BY a.scenario_no DESC, c.relation_tree, c.campaign_no) rnum , a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_type, a.finish_yn, a.create_dt, b.tag_nm , c.campaign_no, c.campaign_preface, concat(coalesce(c.sendstart_dt,''), coalesce(c.sendstart_tm,'')) sendstart_dtm , c.campaign_sts, c.approval_sts, c.relation_type, c.depth_no, c.channel_type, c.campaign_level , c.divide_yn, c.ab_test_type, c.campaign_preface_ab, c.segment_no, c.relation_tree , d.result_seq, e.segment_size FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no LEFT OUTER JOIN nvsegment e ON c.segment_no = e.segment_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? ORDER BY a.scenario_no DESC, relation_tree, c.campaign_no DESC ) x WHERE rnum >= ((? - 1) * ? + 1) AND rnum <= ? * ? ORDER BY scenario_no DESC, relation_tree, campaign_no DESC 
09-02 12:33:36.328 ttp-nio-18084-exec-1 ==> Parameters: ko(String), ko(String), 20200902(String), 20210902(String), 3(Integer), 10(Integer), 3(Integer), 10(Integer)
09-02 12:33:36.331 ttp-nio-18084-exec-1 <==      Total: 10
09-02 15:01:46.389 ttp-nio-18084-exec-3 User.selectAdminByAdminId
09-02 15:01:46.410 ttp-nio-18084-exec-3 ==>  Preparing: SELECT a.user_id, a.pass_wd, a.pass_salt, a.grp_cd, a.name_kor, a.name_eng, a.tel_no, a.email, a.user_class, a.usertype_cd, a.lastupdate_dt, a.active_yn, a.accept_yn , a.list_count_per_page, a.soeid, a.geid, a.isa_role, a.work_doc, a.user_role, a.create_user, a.permit_sts, a.permit_dt, a.login_cnt, a.lastlogin_dt , b.grp_nm, b.req_dept_id as req_dept, a.user_id as req_user FROM nvuser a, nvusergrp b WHERE a.grp_cd = b.grp_cd AND a.user_id = ? AND a.active_yn = 'Y' AND a.accept_yn = 'Y' 
09-02 15:01:46.411 ttp-nio-18084-exec-3 ==> Parameters: admin(String)
09-02 15:01:46.416 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:01:46.429 ttp-nio-18084-exec-3 Menu.selectRoleMap
09-02 15:01:46.430 ttp-nio-18084-exec-3 ==>  Preparing: SELECT a.menu_link_url, a.menu_cd, b.read_auth, b.write_auth, b.execute_auth FROM nvmenu a, nvmenurole b WHERE a.menu_cd = b.menu_cd AND a.menu_link_url IS NOT NULL AND b.user_id = ? 
09-02 15:01:46.430 ttp-nio-18084-exec-3 ==> Parameters: admin(String)
09-02 15:01:46.483 ttp-nio-18084-exec-3 <==      Total: 46
09-02 15:01:46.484 ttp-nio-18084-exec-3 User.updateLoginFailCountToInitial
09-02 15:01:46.484 ttp-nio-18084-exec-3 ==>  Preparing: UPDATE nvuser SET login_cnt = '0', lastlogin_dt = to_char(sysdate, 'yyyyMMdd') WHERE user_id = ? 
09-02 15:01:46.485 ttp-nio-18084-exec-3 ==> Parameters: admin(String)
09-02 15:01:46.526 ttp-nio-18084-exec-3 <==    Updates: 1
09-02 15:01:46.527 ttp-nio-18084-exec-3 MenuRole.getUserMenuList
09-02 15:01:46.527 ttp-nio-18084-exec-3 ==>  Preparing: SELECT a.user_id, a.menu_cd, a.read_auth, a.write_auth, a.execute_auth, b.menu_link_url FROM nvmenurole a, nvmenu b WHERE a.menu_cd = b.menu_cd AND a.user_id = ? AND b.active_yn = 'Y' AND b.pmenu_cd IS NOT NULL ORDER BY menu_cd, sort_no 
09-02 15:01:46.527 ttp-nio-18084-exec-3 ==> Parameters: admin(String)
09-02 15:01:46.530 ttp-nio-18084-exec-3 <==      Total: 37
09-02 15:01:46.568 ttp-nio-18084-exec-5 Scenario.getScenarioTotalCount
09-02 15:01:46.569 ttp-nio-18084-exec-5 ==>  Preparing: SELECT count(*) FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? 
09-02 15:01:46.569 ttp-nio-18084-exec-5 ==> Parameters: 20200902(String), 20210902(String)
09-02 15:01:46.572 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:01:46.583 ttp-nio-18084-exec-5 Scenario.getCampaignScenarioList
09-02 15:01:46.583 ttp-nio-18084-exec-5 ==>  Preparing: SELECT coalesce(scenario_no,0) scenario_no, user_id, grp_cd, scenario_nm, finish_yn , (SELECT grp_nm FROM nvusergrp WHERE grp_cd = x.grp_cd) grp_nm , (SELECT name_kor FROM nvuser WHERE user_id = x.user_id) name_kor , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = x.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100221' AND cd = x.relation_type AND lang = ?) relation_type_nm , to_char(to_date(create_dt, 'yyyymmdd'), 'yy-mm-dd') create_dt , coalesce(campaign_no,0) campaign_no, coalesce(campaign_preface,'') campaign_preface , CASE WHEN sendstart_dtm = '' THEN '' ELSE to_char(to_date(sendstart_dtm, 'yyyymmddhh24miss'), 'yy-mm-dd hh24:mi') END sendstart_dtm , CASE WHEN campaign_sts = 'P' THEN (CASE WHEN approval_sts IS NULL THEN campaign_sts ELSE approval_sts END) ELSE campaign_sts END campaign_sts , relation_type, coalesce(depth_no,0) depth_no, channel_type, campaign_level , divide_yn, ab_test_type, campaign_preface_ab, coalesce(segment_no,-1) segment_no, relation_tree , tag_nm, coalesce(result_seq,0) result_seq, coalesce(segment_size,0) target_cnt FROM ( SELECT row_number() OVER(ORDER BY a.scenario_no DESC, c.relation_tree, c.campaign_no) rnum , a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_type, a.finish_yn, a.create_dt, b.tag_nm , c.campaign_no, c.campaign_preface, concat(coalesce(c.sendstart_dt,''), coalesce(c.sendstart_tm,'')) sendstart_dtm , c.campaign_sts, c.approval_sts, c.relation_type, c.depth_no, c.channel_type, c.campaign_level , c.divide_yn, c.ab_test_type, c.campaign_preface_ab, c.segment_no, c.relation_tree , d.result_seq, e.segment_size FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no LEFT OUTER JOIN nvsegment e ON c.segment_no = e.segment_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? ORDER BY a.scenario_no DESC, relation_tree, c.campaign_no DESC ) x WHERE rnum >= ((? - 1) * ? + 1) AND rnum <= ? * ? ORDER BY scenario_no DESC, relation_tree, campaign_no DESC 
09-02 15:01:46.584 ttp-nio-18084-exec-5 ==> Parameters: ko(String), ko(String), 20200902(String), 20210902(String), 1(Integer), 10(Integer), 1(Integer), 10(Integer)
09-02 15:01:46.590 ttp-nio-18084-exec-5 <==      Total: 10
09-02 15:01:48.917 ttp-nio-18084-exec-1 Scenario.selectScenarioBasicInfo
09-02 15:01:48.917 ttp-nio-18084-exec-1 ==>  Preparing: SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_desc, b.campaign_preface, b.campaign_sts , b.campaign_type, b.sendstart_dt, b.sendstart_tm, b.target_cnt, b.survey_no, coalesce(b.retry_cnt,1) retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm, b.sender_tel , b.retmail_receiver, b.channel_type, b.promotion_type, b.campaign_level, b.depth_no, b.approval_sts, b.req_dept_id req_dept, b.req_user_id req_user, b.divide_yn, b.divide_interval , coalesce(b.divide_cnt,0) divide_cnt, b.ab_test_type, b.ab_test_cond, coalesce(b.ab_test_rate,0) ab_test_rate, b.campaign_preface_ab , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = b.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100121' AND cd = b.approval_sts AND lang = ?) approval_sts_nm , (CASE WHEN b.channel_type = 'm' THEN 4 WHEN b.channel_type = 's' THEN 3 WHEN b.channel_type = 't' THEN 2 ELSE 1 END) seq , c.tag_nm, d.grp_nm, e.name_kor, f.supracampaign_no, '' req_grp_nm FROM nvscenario a, nvcampaign b, nvcamptag c, nvusergrp d, nvuser e, nvschedule f WHERE a.scenario_no = b.scenario_no AND a.tag_no = c.tag_no AND a.grp_cd = d.grp_cd AND a.user_id = e.user_id AND b.campaign_no = f.campaign_no AND a.scenario_no = ? AND b.campaign_no = ? ORDER BY seq DESC 
09-02 15:01:48.918 ttp-nio-18084-exec-1 ==> Parameters: ko(String), ko(String), 31(Integer), 31(Integer)
09-02 15:01:48.946 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:01:48.949 ttp-nio-18084-exec-1 Scenario.selectOmniChannelCampaigns
09-02 15:01:48.950 ttp-nio-18084-exec-1 ==>  Preparing: SELECT c.scenario_no, c.scenario_nm, c.campaign_no, c.depth_no, c.channel_type, c.relation_type , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = c.campaign_sts AND lang = ?) campaign_sts_nm , concat(c.sendstart_dt, c.sendstart_tm) as sendstart_dtm, d.segment_size as target_cnt FROM ( SELECT a.scenario_no, a.scenario_nm, b.campaign_no, b.segment_no, b.depth_no, b.channel_type, b.relation_type, b.campaign_sts, b.sendstart_dt, b.sendstart_tm, b.relation_tree FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = (SELECT scenario_no FROM nvcampaign WHERE campaign_no = ?) AND b.relation_type IN ('N', 'S', 'F', 'O') ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ORDER BY rpad( c.relation_tree , (SELECT max(depth_no) FROM nvcampaign WHERE scenario_no = (SELECT scenario_no FROM nvcampaign WHERE campaign_no = ?)) , 0 ), c.campaign_no 
09-02 15:01:48.950 ttp-nio-18084-exec-1 ==> Parameters: ko(String), 31(Integer), 31(Integer)
09-02 15:01:48.951 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:01:52.351 ttp-nio-18084-exec-2 Campaign.getScenarioChannelInfo
09-02 15:01:52.352 ttp-nio-18084-exec-2 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:01:52.352 ttp-nio-18084-exec-2 ==> Parameters: 31(Integer)
09-02 15:01:52.354 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:01:52.355 ttp-nio-18084-exec-2 Scenario.selectScenarioDetailInfo
09-02 15:01:52.355 ttp-nio-18084-exec-2 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:01:52.355 ttp-nio-18084-exec-2 ==> Parameters: 31(Integer), 31(Integer)
09-02 15:01:52.378 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:01:52.407 ttp-nio-18084-exec-2 Campaign.selectCampaignSenderTel
09-02 15:01:52.407 ttp-nio-18084-exec-2 ==>  Preparing: SELECT sender_tel FROM nvcampaign WHERE campaign_no IN ( SELECT max(campaign_no) FROM nvcampaign WHERE scenario_no IN ( SELECT scenario_no FROM nvscenario WHERE user_id = ? AND grp_cd = ? AND tag_no = ? ) AND channel_type = ? AND sender_tel IS NOT NULL ) 
09-02 15:01:52.408 ttp-nio-18084-exec-2 ==> Parameters: admin(String), 01(String), 1(Integer), S(String)
09-02 15:01:52.409 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:01:52.412 ttp-nio-18084-exec-2 TraceInfo.selectTraceInfo
09-02 15:01:52.412 ttp-nio-18084-exec-2 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:01:52.412 ttp-nio-18084-exec-2 ==> Parameters: 31(Integer)
09-02 15:01:52.432 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:01:52.442 ttp-nio-18084-exec-2 ServerInfo.selectServerInfo
09-02 15:01:52.442 ttp-nio-18084-exec-2 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:01:52.442 ttp-nio-18084-exec-2 ==> Parameters: 
09-02 15:01:52.545 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:01:53.360 ttp-nio-18084-exec-4 Campaign.selectEditorCampaign
09-02 15:01:53.360 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:01:53.360 ttp-nio-18084-exec-4 ==> Parameters: 31(Integer)
09-02 15:01:53.364 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:01:53.679 ttp-nio-18084-exec-1 MobileContents.selectEditorSmsContentsListMax
09-02 15:01:53.679 ttp-nio-18084-exec-1 ==>  Preparing: SELECT count(*) FROM nvmobilecontents WHERE file_type = 'D' 
09-02 15:01:53.679 ttp-nio-18084-exec-1 ==> Parameters: 
09-02 15:01:53.681 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:01:53.683 ttp-nio-18084-exec-1 MobileContents.selectEditorSmsContentsList
09-02 15:01:53.683 ttp-nio-18084-exec-1 ==>  Preparing: SELECT user_id, conts_nm, conts_txt , to_char(to_date(create_dt,'YYYYMMDD'),'YYYY-MM-DD') as create_dt, to_char(to_date(create_tm,'HH24MISS'),'HH:MI:SS') as create_tm FROM ( SELECT row_number() OVER (ORDER BY conts_no DESC) as rnum, conts_no, user_id, conts_nm, conts_txt, create_dt, create_tm FROM nvmobilecontents WHERE file_type = 'D' ORDER BY conts_no DESC ) WHERE rnum BETWEEN ? AND ? 
09-02 15:01:53.683 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer), 6(Integer)
09-02 15:01:53.685 ttp-nio-18084-exec-1 <==      Total: 0
09-02 15:01:53.889 ttp-nio-18084-exec-2 Application.selectEditorCampaignHandler
09-02 15:01:53.889 ttp-nio-18084-exec-2 ==>  Preparing: SELECT type, appsource FROM nvapplication WHERE campaign_no = ? 
09-02 15:01:53.889 ttp-nio-18084-exec-2 ==> Parameters: 31(Integer)
09-02 15:01:53.904 ttp-nio-18084-exec-5 Campaign.selectEditorCampaign
09-02 15:01:53.905 ttp-nio-18084-exec-5 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:01:53.905 ttp-nio-18084-exec-5 ==> Parameters: 31(Integer)
09-02 15:01:53.906 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:01:53.909 ttp-nio-18084-exec-5 DefaultHandler.selectHandlerUseList
09-02 15:01:53.909 ttp-nio-18084-exec-5 ==>  Preparing: SELECT seq, handle_nm, handle_desc FROM nvdefaulthandler c WHERE EXISTS ( SELECT 0 FROM nvcampaign a, nvscenario b WHERE a.scenario_no = b.scenario_no AND a.channel_type = c.channel AND b.handler_type = c.handle_type AND a.campaign_no = ? AND c.service_type IS NULL AND c.ab_test_yn = (CASE a.ab_test_type WHEN 'N' THEN 'N' ELSE 'Y' END) ) ORDER BY seq 
09-02 15:01:53.910 ttp-nio-18084-exec-5 ==> Parameters: 31(Integer)
09-02 15:01:53.919 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:01:53.919 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:01:53.955 ttp-nio-18084-exec-3 Semantic.selectSemanticListBySegmentNo
09-02 15:01:53.955 ttp-nio-18084-exec-3 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:01:53.955 ttp-nio-18084-exec-3 ==> Parameters: 8(Integer)
09-02 15:01:54.019 ttp-nio-18084-exec-3 <==      Total: 5
09-02 15:01:54.116 ttp-nio-18084-exec-6 Template.selectEditorCampaignTemplate
09-02 15:01:54.116 ttp-nio-18084-exec-6 ==>  Preparing: SELECT seg, template, kakao_buttons, CASE WHEN seg = ' ' THEN 0 ELSE 1 END seg_no FROM nvtemplate WHERE campaign_no = ? ORDER BY seg_no 
09-02 15:01:54.116 ttp-nio-18084-exec-6 ==> Parameters: 31(Integer)
09-02 15:01:54.119 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:01:54.121 ttp-nio-18084-exec-6 Semantic.selectSemanticListBySegmentNo
09-02 15:01:54.121 ttp-nio-18084-exec-6 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:01:54.121 ttp-nio-18084-exec-6 ==> Parameters: 8(Integer)
09-02 15:01:54.122 ttp-nio-18084-exec-6 <==      Total: 5
09-02 15:01:56.282 ttp-nio-18084-exec-4 Campaign.updateEditorCampaign
09-02 15:01:56.283 ttp-nio-18084-exec-4 ==>  Preparing: UPDATE nvcampaign SET template_type = ? , campaign_preface = ? WHERE campaign_no = ? 
09-02 15:01:56.283 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer), null, 31(Integer)
09-02 15:01:56.285 ttp-nio-18084-exec-4 <==    Updates: 1
09-02 15:01:56.295 ttp-nio-18084-exec-1 Application.selectEditorCampaignHandlerCount
09-02 15:01:56.295 ttp-nio-18084-exec-1 ==>  Preparing: SELECT count(*) FROM nvapplication WHERE campaign_no = ? 
09-02 15:01:56.295 ttp-nio-18084-exec-1 ==> Parameters: 31(Integer)
09-02 15:01:56.297 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:01:56.298 ttp-nio-18084-exec-1 Application.updateEditorCampaignHandler
09-02 15:01:56.298 ttp-nio-18084-exec-1 ==>  Preparing: UPDATE nvapplication SET appsource = ? WHERE campaign_no = ? 
09-02 15:01:56.298 ttp-nio-18084-exec-1 ==> Parameters: import com.mnwise.ASE.agent.messageagent.MessageAgent
import com.mnwise.ASE.agent.messageagent.MessageBaseItem
import com.mnwise.ASE.agent.util.ExceptionLogger
import com.mnwise.ASE.agent.util.TextReader
import com.mnwise.ASE.pscript.Message
import com.mnwise.common.util.LoggerAid

MessageAgent smsagent = new MessageAgent(context)

smsagent.open()
TextReader target = new TextReader(context)
Message message = new Message(context)
message.prepareGroovyTemplate()

int _KEY_FIELD_SEQ = context.getInt("_KEY_FIELD_SEQ")
int _NAME_FIELD_SEQ = context.getInt("_NAME_FIELD_SEQ")
int _SMS_FIELD_SEQ = context.getInt("_SMS_FIELD_SEQ")

ExceptionLogger exlogger = new ExceptionLogger(context)
MessageBaseItem smsitem = null;
boolean isSendMode = "N".equals(context.get("_PREVIEW_YN"));
while (target.next()) {
  try {
    smsitem = new MessageBaseItem();
    // 부서별 과금을 위해 사용
    smsitem.setReqDeptId(context.get("_REQ_DEPT_ID"))
    smsitem.setReqUserId(context.get("_REQ_USER_ID"))
    smsitem.setCallback(context.get("_SENDER_TEL"))
    context.put("record", target.getRecord())

    smsitem.setPhoneNo(target.getString(_SMS_FIELD_SEQ))
    smsitem.setUserId(target.getString(_KEY_FIELD_SEQ));
    smsitem.setUserName(target.getString(_NAME_FIELD_SEQ));
    smsitem.setSlot1("0")
    smsitem.setSlot2("")
    smsitem.setMsg(message.execGroovyTemplate())
    smsagent.send(smsitem)

  } catch(Exception e) {
    context.put("_EXCEPTION", e);
    exlogger.write(target.toString(), e)
    if(isSendMode) {
      errMsg = LoggerAid.onlyOneLine(e).substring(0, 125)
      exlogger.insertSendLog(target, target.getString(_SMS_FIELD_SEQ), target.getString(_KEY_FIELD_SEQ), target.getString(_NAME_FIELD_SEQ), errMsg, target.getString(_KEY_FIELD_SEQ), context.get("_REQ_DEPT_ID"))
    }
  }
}

exlogger.close()
target.close()
smsagent.close()(String), 31(Integer)
09-02 15:01:56.301 ttp-nio-18084-exec-1 <==    Updates: 1
09-02 15:01:56.400 ttp-nio-18084-exec-2 Semantic.selectSemanticListBySegmentNo
09-02 15:01:56.400 ttp-nio-18084-exec-2 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:01:56.400 ttp-nio-18084-exec-2 ==> Parameters: 8(Integer)
09-02 15:01:56.401 ttp-nio-18084-exec-2 <==      Total: 5
09-02 15:01:56.402 ttp-nio-18084-exec-2 Template.selectEditorCampaignTemplateCount
09-02 15:01:56.402 ttp-nio-18084-exec-2 ==>  Preparing: SELECT count(*) FROM nvtemplate WHERE campaign_no = ? AND seg = ? 
09-02 15:01:56.403 ttp-nio-18084-exec-2 ==> Parameters: 31(Integer),  (String)
09-02 15:01:56.403 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:01:56.404 ttp-nio-18084-exec-2 Template.updateEditorCampaignTemplate
09-02 15:01:56.404 ttp-nio-18084-exec-2 ==>  Preparing: UPDATE nvtemplate SET template = ? WHERE campaign_no = ? AND seg = ? 
09-02 15:01:56.405 ttp-nio-18084-exec-2 ==> Parameters: <%com.mnwise.ASE.agent.util.TextReader record=context.get("record")%>SMS로 문자발송 테스트하기(String), 31(Integer),  (String)
09-02 15:01:56.407 ttp-nio-18084-exec-2 <==    Updates: 1
09-02 15:01:56.441 ttp-nio-18084-exec-5 Campaign.getScenarioChannelInfo
09-02 15:01:56.441 ttp-nio-18084-exec-5 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:01:56.442 ttp-nio-18084-exec-5 ==> Parameters: 31(Integer)
09-02 15:01:56.443 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:01:56.445 ttp-nio-18084-exec-5 Scenario.selectScenarioDetailInfo
09-02 15:01:56.445 ttp-nio-18084-exec-5 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:01:56.446 ttp-nio-18084-exec-5 ==> Parameters: 31(Integer), 31(Integer)
09-02 15:01:56.448 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:01:56.449 ttp-nio-18084-exec-5 Campaign.selectCampaignSenderTel
09-02 15:01:56.449 ttp-nio-18084-exec-5 ==>  Preparing: SELECT sender_tel FROM nvcampaign WHERE campaign_no IN ( SELECT max(campaign_no) FROM nvcampaign WHERE scenario_no IN ( SELECT scenario_no FROM nvscenario WHERE user_id = ? AND grp_cd = ? AND tag_no = ? ) AND channel_type = ? AND sender_tel IS NOT NULL ) 
09-02 15:01:56.449 ttp-nio-18084-exec-5 ==> Parameters: admin(String), 01(String), 1(Integer), S(String)
09-02 15:01:56.450 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:01:56.450 ttp-nio-18084-exec-5 TraceInfo.selectTraceInfo
09-02 15:01:56.450 ttp-nio-18084-exec-5 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:01:56.450 ttp-nio-18084-exec-5 ==> Parameters: 31(Integer)
09-02 15:01:56.451 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:01:56.455 ttp-nio-18084-exec-5 ServerInfo.selectServerInfo
09-02 15:01:56.455 ttp-nio-18084-exec-5 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:01:56.455 ttp-nio-18084-exec-5 ==> Parameters: 
09-02 15:01:56.457 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:01:56.458 ttp-nio-18084-exec-5 Scenario.updateScenario2StepInfo
09-02 15:01:56.458 ttp-nio-18084-exec-5 ==>  Preparing: UPDATE nvscenario SET lastupdate_dt = ? , lastupdate_tm = ? , finish_yn = ? , finish_dt = ? WHERE scenario_no = ? 
09-02 15:01:56.458 ttp-nio-18084-exec-5 ==> Parameters: 20210902(String), 150156(String), N(String), null, 31(Integer)
09-02 15:01:56.460 ttp-nio-18084-exec-5 <==    Updates: 1
09-02 15:01:56.465 ttp-nio-18084-exec-5 Campaign.updateCampaign2StepInfo
09-02 15:01:56.466 ttp-nio-18084-exec-5 ==>  Preparing: UPDATE nvcampaign SET grp_cd = ? , user_id = ? , segment_no = ? , campaign_nm = ? , campaign_desc = ? , lastupdate_dt = ? , lastupdate_tm = ? , campaign_type = ? , sending_sts = ? , sending_cycle = ? , target_cnt = ? , survey_end_yn = ? , survey_response_cnt = ? , survey_start_dt = ? , survey_start_tm = ? , survey_end_dt = ? , survey_end_tm = ? , retry_cnt = ? , sender_nm = ? , sender_email = ? , receiver_nm = ? , sender_tel = ? , retmail_receiver = ? , campaign_class = ? , relation_type = ? , campaign_level = ? , editor_id = ? , approval_sts = ? , kakao_image_no = ? , failback_send_yn = ? , failback_subject = '' WHERE campaign_no = ? 
09-02 15:01:56.466 ttp-nio-18084-exec-5 ==> Parameters: 01(String), admin(String), 8(Integer), 옴니채널 테스트 하채(String), null, 20210902(String), 150156(String), Y(String), null, null, 2(Integer), null, 0(Integer), null, null, null, null, 1(Integer), (String), null, null, 0286545210(String), null, A(String), N(String), 3(String), null, null, 0(Integer), N(String), 31(Integer)
09-02 15:01:56.468 ttp-nio-18084-exec-5 <==    Updates: 1
09-02 15:01:56.469 ttp-nio-18084-exec-5 TraceInfo.selectTraceInfoCnt
09-02 15:01:56.469 ttp-nio-18084-exec-5 ==>  Preparing: SELECT count(*) FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:01:56.469 ttp-nio-18084-exec-5 ==> Parameters: 31(Integer)
09-02 15:01:56.470 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:01:56.471 ttp-nio-18084-exec-5 TraceInfo.updateTraceInfo
09-02 15:01:56.471 ttp-nio-18084-exec-5 ==>  Preparing: UPDATE nvtraceinfo SET start_dt = ? , start_tm = ? , end_dt = ? , end_tm = ? WHERE campaign_no = ? 
09-02 15:01:56.471 ttp-nio-18084-exec-5 ==> Parameters: 20210902(String), 150100(String), 20210909(String), 235959(String), 31(Integer)
09-02 15:01:56.474 ttp-nio-18084-exec-5 <==    Updates: 1
09-02 15:01:56.483 ttp-nio-18084-exec-3 Campaign.getScenarioChannelInfo
09-02 15:01:56.483 ttp-nio-18084-exec-3 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:01:56.483 ttp-nio-18084-exec-3 ==> Parameters: 31(Integer)
09-02 15:01:56.484 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:01:56.485 ttp-nio-18084-exec-3 Scenario.selectScenarioDetailInfo
09-02 15:01:56.485 ttp-nio-18084-exec-3 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:01:56.485 ttp-nio-18084-exec-3 ==> Parameters: 31(Integer), 31(Integer)
09-02 15:01:56.487 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:01:56.488 ttp-nio-18084-exec-3 TraceInfo.selectTraceInfo
09-02 15:01:56.488 ttp-nio-18084-exec-3 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:01:56.488 ttp-nio-18084-exec-3 ==> Parameters: 31(Integer)
09-02 15:01:56.488 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:01:56.490 ttp-nio-18084-exec-3 ServerInfo.selectServerInfo
09-02 15:01:56.490 ttp-nio-18084-exec-3 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:01:56.490 ttp-nio-18084-exec-3 ==> Parameters: 
09-02 15:01:56.492 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:01:57.194 ttp-nio-18084-exec-7 Campaign.selectEditorCampaign
09-02 15:01:57.194 ttp-nio-18084-exec-7 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:01:57.194 ttp-nio-18084-exec-7 ==> Parameters: 31(Integer)
09-02 15:01:57.195 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:01:57.198 ttp-nio-18084-exec-4 MobileContents.selectEditorSmsContentsListMax
09-02 15:01:57.198 ttp-nio-18084-exec-4 ==>  Preparing: SELECT count(*) FROM nvmobilecontents WHERE file_type = 'D' 
09-02 15:01:57.198 ttp-nio-18084-exec-4 ==> Parameters: 
09-02 15:01:57.199 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:01:57.200 ttp-nio-18084-exec-4 MobileContents.selectEditorSmsContentsList
09-02 15:01:57.201 ttp-nio-18084-exec-4 ==>  Preparing: SELECT user_id, conts_nm, conts_txt , to_char(to_date(create_dt,'YYYYMMDD'),'YYYY-MM-DD') as create_dt, to_char(to_date(create_tm,'HH24MISS'),'HH:MI:SS') as create_tm FROM ( SELECT row_number() OVER (ORDER BY conts_no DESC) as rnum, conts_no, user_id, conts_nm, conts_txt, create_dt, create_tm FROM nvmobilecontents WHERE file_type = 'D' ORDER BY conts_no DESC ) WHERE rnum BETWEEN ? AND ? 
09-02 15:01:57.201 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer), 6(Integer)
09-02 15:01:57.202 ttp-nio-18084-exec-4 <==      Total: 0
09-02 15:01:57.245 ttp-nio-18084-exec-2 Application.selectEditorCampaignHandler
09-02 15:01:57.245 ttp-nio-18084-exec-2 ==>  Preparing: SELECT type, appsource FROM nvapplication WHERE campaign_no = ? 
09-02 15:01:57.246 ttp-nio-18084-exec-2 ==> Parameters: 31(Integer)
09-02 15:01:57.246 ttp-nio-18084-exec-1 Campaign.selectEditorCampaign
09-02 15:01:57.246 ttp-nio-18084-exec-1 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:01:57.247 ttp-nio-18084-exec-1 ==> Parameters: 31(Integer)
09-02 15:01:57.247 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:01:57.248 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:01:57.249 ttp-nio-18084-exec-1 DefaultHandler.selectHandlerUseList
09-02 15:01:57.249 ttp-nio-18084-exec-1 ==>  Preparing: SELECT seq, handle_nm, handle_desc FROM nvdefaulthandler c WHERE EXISTS ( SELECT 0 FROM nvcampaign a, nvscenario b WHERE a.scenario_no = b.scenario_no AND a.channel_type = c.channel AND b.handler_type = c.handle_type AND a.campaign_no = ? AND c.service_type IS NULL AND c.ab_test_yn = (CASE a.ab_test_type WHEN 'N' THEN 'N' ELSE 'Y' END) ) ORDER BY seq 
09-02 15:01:57.249 ttp-nio-18084-exec-1 ==> Parameters: 31(Integer)
09-02 15:01:57.251 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:01:57.332 ttp-nio-18084-exec-5 Template.selectEditorCampaignTemplate
09-02 15:01:57.332 ttp-nio-18084-exec-5 ==>  Preparing: SELECT seg, template, kakao_buttons, CASE WHEN seg = ' ' THEN 0 ELSE 1 END seg_no FROM nvtemplate WHERE campaign_no = ? ORDER BY seg_no 
09-02 15:01:57.332 ttp-nio-18084-exec-5 ==> Parameters: 31(Integer)
09-02 15:01:57.333 ttp-nio-18084-exec-3 Semantic.selectSemanticListBySegmentNo
09-02 15:01:57.333 ttp-nio-18084-exec-3 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:01:57.333 ttp-nio-18084-exec-3 ==> Parameters: 8(Integer)
09-02 15:01:57.333 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:01:57.334 ttp-nio-18084-exec-5 Semantic.selectSemanticListBySegmentNo
09-02 15:01:57.334 ttp-nio-18084-exec-5 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:01:57.335 ttp-nio-18084-exec-5 ==> Parameters: 8(Integer)
09-02 15:01:57.335 ttp-nio-18084-exec-3 <==      Total: 5
09-02 15:01:57.336 ttp-nio-18084-exec-5 <==      Total: 5
09-02 15:01:58.573 ttp-nio-18084-exec-6 Scenario.selectScenarioBasicInfo
09-02 15:01:58.573 ttp-nio-18084-exec-6 ==>  Preparing: SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_desc, b.campaign_preface, b.campaign_sts , b.campaign_type, b.sendstart_dt, b.sendstart_tm, b.target_cnt, b.survey_no, coalesce(b.retry_cnt,1) retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm, b.sender_tel , b.retmail_receiver, b.channel_type, b.promotion_type, b.campaign_level, b.depth_no, b.approval_sts, b.req_dept_id req_dept, b.req_user_id req_user, b.divide_yn, b.divide_interval , coalesce(b.divide_cnt,0) divide_cnt, b.ab_test_type, b.ab_test_cond, coalesce(b.ab_test_rate,0) ab_test_rate, b.campaign_preface_ab , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = b.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100121' AND cd = b.approval_sts AND lang = ?) approval_sts_nm , (CASE WHEN b.channel_type = 'm' THEN 4 WHEN b.channel_type = 's' THEN 3 WHEN b.channel_type = 't' THEN 2 ELSE 1 END) seq , c.tag_nm, d.grp_nm, e.name_kor, f.supracampaign_no, '' req_grp_nm FROM nvscenario a, nvcampaign b, nvcamptag c, nvusergrp d, nvuser e, nvschedule f WHERE a.scenario_no = b.scenario_no AND a.tag_no = c.tag_no AND a.grp_cd = d.grp_cd AND a.user_id = e.user_id AND b.campaign_no = f.campaign_no AND a.scenario_no = ? AND b.campaign_no = ? AND b.depth_no = ? ORDER BY seq DESC 
09-02 15:01:58.573 ttp-nio-18084-exec-6 ==> Parameters: ko(String), ko(String), 31(Integer), 31(Integer), 1(Integer)
09-02 15:01:58.581 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:01:58.582 ttp-nio-18084-exec-6 Segment.selectSegmentByPk
09-02 15:01:58.582 ttp-nio-18084-exec-6 ==>  Preparing: SELECT segment_no, user_id, grp_cd, segment_nm, coalesce(dbinfo_seq,0) dbinfo_seq, segment_desc, sqlhead, sqltail, sqlbody, sqlfilter , lastupdate_dt, coalesce(segment_size,0) segment_size, crtgrp_cd, segment_type, filetodb_yn, editor_id, coalesce(share_yn,'N') share_yn, coalesce(active_yn,'Y') active_yn, category_cd, segment_sts , coalesce(tag_no,0) tag_no, coalesce(psegment_no,0) psegment_no, plink_seq, seg_type, testquery, updatequery , (SELECT name_kor FROM nvuser WHERE user_id = coalesce(a.editor_id, a.user_id)) name_kor , (SELECT tag_nm FROM nvsegmenttag WHERE tag_no = a.tag_no) as tag_nm FROM nvsegment a WHERE segment_no = ? 
09-02 15:01:58.582 ttp-nio-18084-exec-6 ==> Parameters: 8(Integer)
09-02 15:01:58.666 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:01:58.668 ttp-nio-18084-exec-6 ServerInfo.selectServerInfo
09-02 15:01:58.668 ttp-nio-18084-exec-6 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:01:58.668 ttp-nio-18084-exec-6 ==> Parameters: 
09-02 15:01:58.669 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:01:58.670 ttp-nio-18084-exec-6 Campaign.selectSubCampaignList
09-02 15:01:58.670 ttp-nio-18084-exec-6 ==>  Preparing: SELECT campaign_no, scenario_no, campaign_nm, channel_type, depth_no, relation_type FROM nvcampaign WHERE scenario_no = ? AND depth_no = ? AND relation_tree LIKE concat((SELECT relation_tree FROM nvcampaign WHERE campaign_no = ?), '%') 
09-02 15:01:58.670 ttp-nio-18084-exec-6 ==> Parameters: 31(Integer), 2(Integer), 31(Integer)
09-02 15:01:58.672 ttp-nio-18084-exec-6 <==      Total: 0
09-02 15:01:58.673 ttp-nio-18084-exec-6 Semantic.selectCampaignSemanticKey
09-02 15:01:58.673 ttp-nio-18084-exec-6 ==>  Preparing: SELECT field_key FROM nvsemantic WHERE segment_no = (SELECT segment_no FROM nvcampaign WHERE scenario_no = ? AND depth_no = 1) AND field_key IS NOT NULL 
09-02 15:01:58.673 ttp-nio-18084-exec-6 ==> Parameters: 31(Integer)
09-02 15:01:58.674 ttp-nio-18084-exec-6 <==      Total: 5
09-02 15:02:02.437 ttp-nio-18084-exec-3 Scenario.getScenarioTotalCount
09-02 15:02:02.437 ttp-nio-18084-exec-3 ==>  Preparing: SELECT count(*) FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? 
09-02 15:02:02.438 ttp-nio-18084-exec-3 ==> Parameters: 20200902(String), 20210902(String)
09-02 15:02:02.440 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:02.442 ttp-nio-18084-exec-3 Scenario.getCampaignScenarioList
09-02 15:02:02.443 ttp-nio-18084-exec-3 ==>  Preparing: SELECT coalesce(scenario_no,0) scenario_no, user_id, grp_cd, scenario_nm, finish_yn , (SELECT grp_nm FROM nvusergrp WHERE grp_cd = x.grp_cd) grp_nm , (SELECT name_kor FROM nvuser WHERE user_id = x.user_id) name_kor , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = x.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100221' AND cd = x.relation_type AND lang = ?) relation_type_nm , to_char(to_date(create_dt, 'yyyymmdd'), 'yy-mm-dd') create_dt , coalesce(campaign_no,0) campaign_no, coalesce(campaign_preface,'') campaign_preface , CASE WHEN sendstart_dtm = '' THEN '' ELSE to_char(to_date(sendstart_dtm, 'yyyymmddhh24miss'), 'yy-mm-dd hh24:mi') END sendstart_dtm , CASE WHEN campaign_sts = 'P' THEN (CASE WHEN approval_sts IS NULL THEN campaign_sts ELSE approval_sts END) ELSE campaign_sts END campaign_sts , relation_type, coalesce(depth_no,0) depth_no, channel_type, campaign_level , divide_yn, ab_test_type, campaign_preface_ab, coalesce(segment_no,-1) segment_no, relation_tree , tag_nm, coalesce(result_seq,0) result_seq, coalesce(segment_size,0) target_cnt FROM ( SELECT row_number() OVER(ORDER BY a.scenario_no DESC, c.relation_tree, c.campaign_no) rnum , a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_type, a.finish_yn, a.create_dt, b.tag_nm , c.campaign_no, c.campaign_preface, concat(coalesce(c.sendstart_dt,''), coalesce(c.sendstart_tm,'')) sendstart_dtm , c.campaign_sts, c.approval_sts, c.relation_type, c.depth_no, c.channel_type, c.campaign_level , c.divide_yn, c.ab_test_type, c.campaign_preface_ab, c.segment_no, c.relation_tree , d.result_seq, e.segment_size FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no LEFT OUTER JOIN nvsegment e ON c.segment_no = e.segment_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? ORDER BY a.scenario_no DESC, relation_tree, c.campaign_no DESC ) x WHERE rnum >= ((? - 1) * ? + 1) AND rnum <= ? * ? ORDER BY scenario_no DESC, relation_tree, campaign_no DESC 
09-02 15:02:02.443 ttp-nio-18084-exec-3 ==> Parameters: ko(String), ko(String), 20200902(String), 20210902(String), 1(Integer), 10(Integer), 1(Integer), 10(Integer)
09-02 15:02:02.446 ttp-nio-18084-exec-3 <==      Total: 10
09-02 15:02:04.554 ttp-nio-18084-exec-5 Scenario.getScenarioTotalCount
09-02 15:02:04.554 ttp-nio-18084-exec-5 ==>  Preparing: SELECT count(*) FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? 
09-02 15:02:04.554 ttp-nio-18084-exec-5 ==> Parameters: 20200902(String), 20210902(String)
09-02 15:02:04.557 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:02:04.558 ttp-nio-18084-exec-5 Scenario.getCampaignScenarioList
09-02 15:02:04.558 ttp-nio-18084-exec-5 ==>  Preparing: SELECT coalesce(scenario_no,0) scenario_no, user_id, grp_cd, scenario_nm, finish_yn , (SELECT grp_nm FROM nvusergrp WHERE grp_cd = x.grp_cd) grp_nm , (SELECT name_kor FROM nvuser WHERE user_id = x.user_id) name_kor , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = x.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100221' AND cd = x.relation_type AND lang = ?) relation_type_nm , to_char(to_date(create_dt, 'yyyymmdd'), 'yy-mm-dd') create_dt , coalesce(campaign_no,0) campaign_no, coalesce(campaign_preface,'') campaign_preface , CASE WHEN sendstart_dtm = '' THEN '' ELSE to_char(to_date(sendstart_dtm, 'yyyymmddhh24miss'), 'yy-mm-dd hh24:mi') END sendstart_dtm , CASE WHEN campaign_sts = 'P' THEN (CASE WHEN approval_sts IS NULL THEN campaign_sts ELSE approval_sts END) ELSE campaign_sts END campaign_sts , relation_type, coalesce(depth_no,0) depth_no, channel_type, campaign_level , divide_yn, ab_test_type, campaign_preface_ab, coalesce(segment_no,-1) segment_no, relation_tree , tag_nm, coalesce(result_seq,0) result_seq, coalesce(segment_size,0) target_cnt FROM ( SELECT row_number() OVER(ORDER BY a.scenario_no DESC, c.relation_tree, c.campaign_no) rnum , a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_type, a.finish_yn, a.create_dt, b.tag_nm , c.campaign_no, c.campaign_preface, concat(coalesce(c.sendstart_dt,''), coalesce(c.sendstart_tm,'')) sendstart_dtm , c.campaign_sts, c.approval_sts, c.relation_type, c.depth_no, c.channel_type, c.campaign_level , c.divide_yn, c.ab_test_type, c.campaign_preface_ab, c.segment_no, c.relation_tree , d.result_seq, e.segment_size FROM nvscenario a, nvcamptag b, nvcampaign c LEFT OUTER JOIN nvsendresult d ON c.campaign_no = d.campaign_no LEFT OUTER JOIN nvsegment e ON c.segment_no = e.segment_no WHERE a.tag_no = b.tag_no AND a.scenario_no = c.scenario_no AND d.resend_sts is null AND c.use_yn = 'Y' AND a.create_dt >= ? AND a.create_dt <= ? ORDER BY a.scenario_no DESC, relation_tree, c.campaign_no DESC ) x WHERE rnum >= ((? - 1) * ? + 1) AND rnum <= ? * ? ORDER BY scenario_no DESC, relation_tree, campaign_no DESC 
09-02 15:02:04.558 ttp-nio-18084-exec-5 ==> Parameters: ko(String), ko(String), 20200902(String), 20210902(String), 4(Integer), 10(Integer), 4(Integer), 10(Integer)
09-02 15:02:04.560 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:02:19.337 ttp-nio-18084-exec-6 Scenario.selectScenarioBasicInfo
09-02 15:02:19.337 ttp-nio-18084-exec-6 ==>  Preparing: SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_desc, b.campaign_preface, b.campaign_sts , b.campaign_type, b.sendstart_dt, b.sendstart_tm, b.target_cnt, b.survey_no, coalesce(b.retry_cnt,1) retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm, b.sender_tel , b.retmail_receiver, b.channel_type, b.promotion_type, b.campaign_level, b.depth_no, b.approval_sts, b.req_dept_id req_dept, b.req_user_id req_user, b.divide_yn, b.divide_interval , coalesce(b.divide_cnt,0) divide_cnt, b.ab_test_type, b.ab_test_cond, coalesce(b.ab_test_rate,0) ab_test_rate, b.campaign_preface_ab , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = b.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100121' AND cd = b.approval_sts AND lang = ?) approval_sts_nm , (CASE WHEN b.channel_type = 'm' THEN 4 WHEN b.channel_type = 's' THEN 3 WHEN b.channel_type = 't' THEN 2 ELSE 1 END) seq , c.tag_nm, d.grp_nm, e.name_kor, f.supracampaign_no, '' req_grp_nm FROM nvscenario a, nvcampaign b, nvcamptag c, nvusergrp d, nvuser e, nvschedule f WHERE a.scenario_no = b.scenario_no AND a.tag_no = c.tag_no AND a.grp_cd = d.grp_cd AND a.user_id = e.user_id AND b.campaign_no = f.campaign_no AND a.scenario_no = ? AND b.campaign_no = ? ORDER BY seq DESC 
09-02 15:02:19.338 ttp-nio-18084-exec-6 ==> Parameters: ko(String), ko(String), 1(Integer), 1(Integer)
09-02 15:02:19.339 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:02:19.341 ttp-nio-18084-exec-6 Scenario.selectOmniChannelCampaigns
09-02 15:02:19.341 ttp-nio-18084-exec-6 ==>  Preparing: SELECT c.scenario_no, c.scenario_nm, c.campaign_no, c.depth_no, c.channel_type, c.relation_type , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = c.campaign_sts AND lang = ?) campaign_sts_nm , concat(c.sendstart_dt, c.sendstart_tm) as sendstart_dtm, d.segment_size as target_cnt FROM ( SELECT a.scenario_no, a.scenario_nm, b.campaign_no, b.segment_no, b.depth_no, b.channel_type, b.relation_type, b.campaign_sts, b.sendstart_dt, b.sendstart_tm, b.relation_tree FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = (SELECT scenario_no FROM nvcampaign WHERE campaign_no = ?) AND b.relation_type IN ('N', 'S', 'F', 'O') ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ORDER BY rpad( c.relation_tree , (SELECT max(depth_no) FROM nvcampaign WHERE scenario_no = (SELECT scenario_no FROM nvcampaign WHERE campaign_no = ?)) , 0 ), c.campaign_no 
09-02 15:02:19.342 ttp-nio-18084-exec-6 ==> Parameters: ko(String), 1(Integer), 1(Integer)
09-02 15:02:19.343 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:02:20.540 ttp-nio-18084-exec-2 Scenario.selectScenarioBasicInfo
09-02 15:02:20.540 ttp-nio-18084-exec-2 ==>  Preparing: SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_desc, b.campaign_preface, b.campaign_sts , b.campaign_type, b.sendstart_dt, b.sendstart_tm, b.target_cnt, b.survey_no, coalesce(b.retry_cnt,1) retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm, b.sender_tel , b.retmail_receiver, b.channel_type, b.promotion_type, b.campaign_level, b.depth_no, b.approval_sts, b.req_dept_id req_dept, b.req_user_id req_user, b.divide_yn, b.divide_interval , coalesce(b.divide_cnt,0) divide_cnt, b.ab_test_type, b.ab_test_cond, coalesce(b.ab_test_rate,0) ab_test_rate, b.campaign_preface_ab , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = b.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100121' AND cd = b.approval_sts AND lang = ?) approval_sts_nm , (CASE WHEN b.channel_type = 'm' THEN 4 WHEN b.channel_type = 's' THEN 3 WHEN b.channel_type = 't' THEN 2 ELSE 1 END) seq , c.tag_nm, d.grp_nm, e.name_kor, f.supracampaign_no, '' req_grp_nm FROM nvscenario a, nvcampaign b, nvcamptag c, nvusergrp d, nvuser e, nvschedule f WHERE a.scenario_no = b.scenario_no AND a.tag_no = c.tag_no AND a.grp_cd = d.grp_cd AND a.user_id = e.user_id AND b.campaign_no = f.campaign_no AND a.scenario_no = ? AND b.campaign_no = ? AND b.depth_no = ? ORDER BY seq DESC 
09-02 15:02:20.540 ttp-nio-18084-exec-2 ==> Parameters: ko(String), ko(String), 1(Integer), 1(Integer), 1(Integer)
09-02 15:02:20.542 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:20.542 ttp-nio-18084-exec-2 Segment.selectSegmentByPk
09-02 15:02:20.542 ttp-nio-18084-exec-2 ==>  Preparing: SELECT segment_no, user_id, grp_cd, segment_nm, coalesce(dbinfo_seq,0) dbinfo_seq, segment_desc, sqlhead, sqltail, sqlbody, sqlfilter , lastupdate_dt, coalesce(segment_size,0) segment_size, crtgrp_cd, segment_type, filetodb_yn, editor_id, coalesce(share_yn,'N') share_yn, coalesce(active_yn,'Y') active_yn, category_cd, segment_sts , coalesce(tag_no,0) tag_no, coalesce(psegment_no,0) psegment_no, plink_seq, seg_type, testquery, updatequery , (SELECT name_kor FROM nvuser WHERE user_id = coalesce(a.editor_id, a.user_id)) name_kor , (SELECT tag_nm FROM nvsegmenttag WHERE tag_no = a.tag_no) as tag_nm FROM nvsegment a WHERE segment_no = ? 
09-02 15:02:20.542 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:20.543 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:20.544 ttp-nio-18084-exec-2 TraceInfo.selectTraceInfo
09-02 15:02:20.544 ttp-nio-18084-exec-2 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:20.544 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:20.544 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:20.545 ttp-nio-18084-exec-2 ServerInfo.selectServerInfo
09-02 15:02:20.545 ttp-nio-18084-exec-2 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:02:20.545 ttp-nio-18084-exec-2 ==> Parameters: 
09-02 15:02:20.546 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:20.546 ttp-nio-18084-exec-2 Campaign.selectSubCampaignList
09-02 15:02:20.546 ttp-nio-18084-exec-2 ==>  Preparing: SELECT campaign_no, scenario_no, campaign_nm, channel_type, depth_no, relation_type FROM nvcampaign WHERE scenario_no = ? AND depth_no = ? AND relation_tree LIKE concat((SELECT relation_tree FROM nvcampaign WHERE campaign_no = ?), '%') 
09-02 15:02:20.546 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer), 2(Integer), 1(Integer)
09-02 15:02:20.547 ttp-nio-18084-exec-2 <==      Total: 0
09-02 15:02:20.547 ttp-nio-18084-exec-2 Semantic.selectCampaignSemanticKey
09-02 15:02:20.547 ttp-nio-18084-exec-2 ==>  Preparing: SELECT field_key FROM nvsemantic WHERE segment_no = (SELECT segment_no FROM nvcampaign WHERE scenario_no = ? AND depth_no = 1) AND field_key IS NOT NULL 
09-02 15:02:20.548 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:20.548 ttp-nio-18084-exec-2 <==      Total: 3
09-02 15:02:23.910 ttp-nio-18084-exec-1 Campaign.getScenarioChannelInfo
09-02 15:02:23.910 ttp-nio-18084-exec-1 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:02:23.910 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer)
09-02 15:02:23.912 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:23.912 ttp-nio-18084-exec-1 Scenario.selectScenarioDetailInfo
09-02 15:02:23.913 ttp-nio-18084-exec-1 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:02:23.913 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer), 1(Integer)
09-02 15:02:23.916 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:23.968 ttp-nio-18084-exec-1 TraceInfo.selectTraceInfo
09-02 15:02:23.968 ttp-nio-18084-exec-1 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:23.968 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer)
09-02 15:02:23.969 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:23.970 ttp-nio-18084-exec-1 ServerInfo.selectServerInfo
09-02 15:02:23.970 ttp-nio-18084-exec-1 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:02:23.970 ttp-nio-18084-exec-1 ==> Parameters: 
09-02 15:02:23.971 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:24.685 ttp-nio-18084-exec-1 Campaign.selectEditorCampaign
09-02 15:02:24.685 ttp-nio-18084-exec-1 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:24.685 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer)
09-02 15:02:24.686 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:24.725 ttp-nio-18084-exec-4 Campaign.selectEditorCampaign
09-02 15:02:24.725 ttp-nio-18084-exec-3 Application.selectEditorCampaignHandler
09-02 15:02:24.725 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:24.725 ttp-nio-18084-exec-3 ==>  Preparing: SELECT type, appsource FROM nvapplication WHERE campaign_no = ? 
09-02 15:02:24.725 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer)
09-02 15:02:24.725 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer)
09-02 15:02:24.726 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:02:24.727 ttp-nio-18084-exec-4 DefaultHandler.selectHandlerUseList
09-02 15:02:24.727 ttp-nio-18084-exec-4 ==>  Preparing: SELECT seq, handle_nm, handle_desc FROM nvdefaulthandler c WHERE EXISTS ( SELECT 0 FROM nvcampaign a, nvscenario b WHERE a.scenario_no = b.scenario_no AND a.channel_type = c.channel AND b.handler_type = c.handle_type AND a.campaign_no = ? AND c.service_type IS NULL AND c.ab_test_yn = (CASE a.ab_test_type WHEN 'N' THEN 'N' ELSE 'Y' END) ) ORDER BY seq 
09-02 15:02:24.727 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer)
09-02 15:02:24.728 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:02:24.752 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:24.818 ttp-nio-18084-exec-6 MultipartFile.selectEditorCampaignMultipartFile
09-02 15:02:24.819 ttp-nio-18084-exec-6 ==>  Preparing: SELECT file_alias, file_path, file_size, file_name FROM nvmultipartfile WHERE campaign_no = ? 
09-02 15:02:24.819 ttp-nio-18084-exec-6 ==> Parameters: 1(Integer)
09-02 15:02:24.821 ttp-nio-18084-exec-6 <==      Total: 0
09-02 15:02:24.856 ttp-nio-18084-exec-5 Semantic.selectSemanticListBySegmentNo
09-02 15:02:24.856 ttp-nio-18084-exec-5 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:02:24.856 ttp-nio-18084-exec-5 ==> Parameters: 1(Integer)
09-02 15:02:24.857 ttp-nio-18084-exec-5 <==      Total: 3
09-02 15:02:24.875 ttp-nio-18084-exec-2 Template.selectEditorCampaignTemplate
09-02 15:02:24.875 ttp-nio-18084-exec-2 ==>  Preparing: SELECT seg, template, kakao_buttons, CASE WHEN seg = ' ' THEN 0 ELSE 1 END seg_no FROM nvtemplate WHERE campaign_no = ? ORDER BY seg_no 
09-02 15:02:24.875 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:24.877 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:24.878 ttp-nio-18084-exec-2 Semantic.selectSemanticListBySegmentNo
09-02 15:02:24.878 ttp-nio-18084-exec-2 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:02:24.878 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:24.878 ttp-nio-18084-exec-2 <==      Total: 3
09-02 15:02:24.909 ttp-nio-18084-exec-1 LinkTrace.selectEditorCampaignLinkseqMax
09-02 15:02:24.909 ttp-nio-18084-exec-1 ==>  Preparing: SELECT coalesce(max(link_seq),0) link_seq FROM nvlinktrace WHERE campaign_no = ? 
09-02 15:02:24.909 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer)
09-02 15:02:24.910 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:26.385 ttp-nio-18084-exec-7 Segment.selectBookmarkListTotalCount
09-02 15:02:26.386 ttp-nio-18084-exec-7 ==>  Preparing: SELECT count(*) FROM nvsegment a, nvsegmenttag b, nvuser c, ( SELECT segment_no FROM nvsemantic WHERE field_key = ? ) d WHERE a.tag_no = b.tag_no AND a.user_id = c.user_id AND a.segment_no = d.segment_no AND a.segment_type = 'N' AND (a.active_yn = 'Y' OR a.active_yn IS NULL) AND seg_type = ? 
09-02 15:02:26.386 ttp-nio-18084-exec-7 ==> Parameters: E(String), F(String)
09-02 15:02:26.392 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:02:26.394 ttp-nio-18084-exec-7 Segment.selectBookmarkList
09-02 15:02:26.394 ttp-nio-18084-exec-7 ==>  Preparing: SELECT * FROM ( SELECT row_number() OVER (ORDER BY a.segment_no DESC) as rnum , a.segment_no, a.segment_nm, a.segment_size, a.filetodb_yn, a.lastupdate_dt, a.seg_type, b.tag_nm, c.name_kor FROM nvsegment a, nvsegmenttag b, nvuser c, ( SELECT segment_no FROM nvsemantic WHERE field_key = ? ) d WHERE a.tag_no = b.tag_no AND a.user_id = c.user_id AND a.segment_no = d.segment_no AND a.segment_type = 'N' AND (a.active_yn = 'Y' OR a.active_yn IS NULL) AND seg_type = ? ORDER BY a.segment_no DESC ) e WHERE rnum >= ? AND rnum <= ? 
09-02 15:02:26.395 ttp-nio-18084-exec-7 ==> Parameters: E(String), F(String), 1(Integer), 10(Integer)
09-02 15:02:26.422 ttp-nio-18084-exec-7 <==      Total: 2
09-02 15:02:28.039 ttp-nio-18084-exec-3 Semantic.selectSemanticListBySegmentNo
09-02 15:02:28.039 ttp-nio-18084-exec-3 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:02:28.039 ttp-nio-18084-exec-3 ==> Parameters: 8(Integer)
09-02 15:02:28.040 ttp-nio-18084-exec-3 <==      Total: 5
09-02 15:02:29.336 ttp-nio-18084-exec-5 Campaign.updateEditorCampaign
09-02 15:02:29.336 ttp-nio-18084-exec-5 ==>  Preparing: UPDATE nvcampaign SET template_type = ? , campaign_preface = ? WHERE campaign_no = ? 
09-02 15:02:29.336 ttp-nio-18084-exec-5 ==> Parameters: 1(Integer), test(String), 1(Integer)
09-02 15:02:29.347 ttp-nio-18084-exec-5 <==    Updates: 1
09-02 15:02:29.348 ttp-nio-18084-exec-5 Application.selectEditorCampaignHandlerCount
09-02 15:02:29.348 ttp-nio-18084-exec-5 ==>  Preparing: SELECT count(*) FROM nvapplication WHERE campaign_no = ? 
09-02 15:02:29.348 ttp-nio-18084-exec-5 ==> Parameters: 1(Integer)
09-02 15:02:29.349 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:02:29.349 ttp-nio-18084-exec-6 Campaign.selectCampaignInfo
09-02 15:02:29.349 ttp-nio-18084-exec-6 ==>  Preparing: SELECT campaign_no, campaign_sts, approval_sts, sendstart_dt, sendstart_tm, coalesce(segment_no,0) segment_no FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:29.349 ttp-nio-18084-exec-6 ==> Parameters: 1(Integer)
09-02 15:02:29.350 ttp-nio-18084-exec-5 Application.updateEditorCampaignHandler
09-02 15:02:29.350 ttp-nio-18084-exec-5 ==>  Preparing: UPDATE nvapplication SET appsource = ? WHERE campaign_no = ? 
09-02 15:02:29.350 ttp-nio-18084-exec-5 ==> Parameters: import com.mnwise.ASE.agent.mailagent.MailAgent5
import com.mnwise.ASE.agent.mailagent.MailBody
import com.mnwise.ASE.agent.util.ExceptionLogger
import com.mnwise.ASE.agent.util.TextReader
import com.mnwise.ASE.pscript.Message
import com.mnwise.common.util.LoggerAid

MailAgent5 mailagent = new MailAgent5(context)
mailagent.setRetry(context.get("_RETRY_CNT"))
mailagent.open()
TextReader target = new TextReader(context)
Message message = new Message(context)
message.prepareGroovyTemplate()

// 캠페인에서 사용 기능 파악 필요
int _KEY_FIELD_SEQ = context.getInt("_KEY_FIELD_SEQ")
int _NAME_FIELD_SEQ = context.getInt("_NAME_FIELD_SEQ")
int _EMAIL_FIELD_SEQ = context.getInt("_EMAIL_FIELD_SEQ")

ExceptionLogger exlogger = new ExceptionLogger(context)
String errMsg= "";
boolean isSendMode = "N".equals(context.get("_PREVIEW_YN"));
while (target.next()) {
  try {
    mailagent.setMailFrom(context.get("_RETMAIL_RECEIVER"))
    context.put("record", target.getRecord())
    MailBody body = new MailBody(context)
    body.setEncodingType("base64")
    body.setCharset("euc-kr")

    body.setSubject(context.get("_SERVICE_PREFACE", target))

    body.setFrom(context.get("_SENDER_NM"), context.get("_SENDER_EMAIL"))
    body.setTo(target.getString(1), target.getString(3))
    mailagent.setRcpt(target.getString(3), target.getString(2), target.getString(1), "0")
    String msg = message.execGroovyTemplate()
    body.setContent("text/html", msg)
    body.makeHeader()
    body.makeBody()
    mailagent.send(body)
  } catch(Exception e) {
    context.put("_EXCEPTION", e);
    exlogger.write(target.toString(), e)
    if(isSendMode) {
      errMsg = LoggerAid.onlyOneLine(e).substring(0, 125)
      exlogger.insertSendLog(target, target.getString(_EMAIL_FIELD_SEQ), target.getString(_KEY_FIELD_SEQ), target.getString(_NAME_FIELD_SEQ), errMsg, target.getString(_KEY_FIELD_SEQ), context.get("_REQ_DEPT_ID"))
   }
  }
}

exlogger.close()
target.close()
mailagent.close()
(String), 1(Integer)
09-02 15:02:29.351 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:02:29.365 ttp-nio-18084-exec-5 <==    Updates: 1
09-02 15:02:29.366 ttp-nio-18084-exec-5 ServerInfo.selectServerInfo
09-02 15:02:29.366 ttp-nio-18084-exec-5 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:02:29.366 ttp-nio-18084-exec-5 ==> Parameters: 
09-02 15:02:29.368 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:02:29.369 ttp-nio-18084-exec-5 Semantic.selectSemanticListBySegmentNo
09-02 15:02:29.369 ttp-nio-18084-exec-5 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:02:29.369 ttp-nio-18084-exec-5 ==> Parameters: 8(Integer)
09-02 15:02:29.370 ttp-nio-18084-exec-5 <==      Total: 5
09-02 15:02:29.371 ttp-nio-18084-exec-5 Template.selectEditorCampaignTemplateCount
09-02 15:02:29.371 ttp-nio-18084-exec-5 ==>  Preparing: SELECT count(*) FROM nvtemplate WHERE campaign_no = ? AND seg = ? 
09-02 15:02:29.371 ttp-nio-18084-exec-5 ==> Parameters: 1(Integer),  (String)
09-02 15:02:29.372 ttp-nio-18084-exec-5 <==      Total: 1
09-02 15:02:29.372 ttp-nio-18084-exec-5 Template.updateEditorCampaignTemplate
09-02 15:02:29.372 ttp-nio-18084-exec-5 ==>  Preparing: UPDATE nvtemplate SET template = ? WHERE campaign_no = ? AND seg = ? 
09-02 15:02:29.373 ttp-nio-18084-exec-5 ==> Parameters: <%
com.mnwise.ASE.agent.util.TextReader record=context.get("record");
StringBuffer sb = new StringBuffer()
sb.append("http://127.0.0.1:9000/servlet/LinkTraceEM")
sb.append("?SEND_MODE=")
sb.append(context.get("_SEND_MODE"))
sb.append("&CAMPAIGN_NO=")
sb.append(context.get("_CAMPAIGN_NO"))
sb.append("&RESULT_SEQ=")
sb.append(context.get("_RESULT_SEQ"))
sb.append("&START_DATE=")
sb.append(context.get("_START_DATE"))
sb.append("&END_DATE=")
sb.append(context.get("_END_DATE"))
sb.append("&LIST_SEQ=")
sb.append(context.get("_LIST_SEQ"))
sb.append("&RECORD_SEQ=")
sb.append(context.get("_RECORD_SEQ"))
sb.append("&CUSTOMER_ID=")
sb.append(context.getEncryptedString("_CUSTOMER_ID"))
String LinkTrace = sb.toString()
sb.setLength(0)
String Reject
if("Y".equals(context.get("_PREVIEW_YN"))) {
Reject = "#"
} else {
sb.append("http://127.0.0.1:9000/servlet/RejectEM")
sb.append("?SEND_MODE=")
sb.append(context.get("_SEND_MODE"))
sb.append("&CAMPAIGN_NO=")
sb.append(context.get("_CAMPAIGN_NO"))
sb.append("&RESULT_SEQ=")
sb.append(context.get("_RESULT_SEQ"))
sb.append("&START_DATE=")
sb.append(context.get("_START_DATE"))
sb.append("&END_DATE=")
sb.append(context.get("_END_DATE"))
sb.append("&LIST_SEQ=")
sb.append(context.get("_LIST_SEQ"))
sb.append("&RECORD_SEQ=")
sb.append(context.get("_RECORD_SEQ"))
sb.append("&CUSTOMER_ID=")
sb.append(context.getEncryptedString("_CUSTOMER_ID"))
sb.append("&CUSTOMER_EMAIL=")
sb.append(context.getEncryptedString("_CUSTOMER_EMAIL"))
Reject = sb.toString()
}
sb.setLength(0)
String ReceiveConfirm = context.get("_RECE_CON")
if(ReceiveConfirm.equals("Y")) {
sb.append("http://127.0.0.1:9000/servlet/ReceiveConfirmEM")
sb.append("?SEND_MODE=")
sb.append(context.get("_SEND_MODE"))
sb.append("&CAMPAIGN_NO=")
sb.append(context.get("_CAMPAIGN_NO"))
sb.append("&RESULT_SEQ=")
sb.append(context.get("_RESULT_SEQ"))
sb.append("&START_DATE=")
sb.append(context.get("_START_DATE"))
sb.append("&END_DATE=")
sb.append(context.get("_END_DATE"))
sb.append("&LIST_SEQ=")
sb.append(context.get("_LIST_SEQ"))
sb.append("&RECORD_SEQ=")
sb.append(context.get("_RECORD_SEQ"))
sb.append("&CUSTOMER_ID=")
sb.append(context.getEncryptedString("_CUSTOMER_ID"))
ReceiveConfirm = sb.toString()
} else { ReceiveConfirm = "" }
%>
<html><body>
안녕하세요. 캠페인 테스트중입니다. <br/><img width='0' height='0' src='<%=(ReceiveConfirm)%>'/>
</body></html>(String), 1(Integer),  (String)
09-02 15:02:29.387 ttp-nio-18084-exec-5 <==    Updates: 1
09-02 15:02:29.421 ttp-nio-18084-exec-2 Campaign.getScenarioChannelInfo
09-02 15:02:29.421 ttp-nio-18084-exec-2 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:02:29.421 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:29.423 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:29.424 ttp-nio-18084-exec-2 Scenario.selectScenarioDetailInfo
09-02 15:02:29.424 ttp-nio-18084-exec-2 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:02:29.424 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer), 1(Integer)
09-02 15:02:29.426 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:29.431 ttp-nio-18084-exec-2 TraceInfo.selectTraceInfo
09-02 15:02:29.431 ttp-nio-18084-exec-2 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:29.431 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:29.432 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:29.440 ttp-nio-18084-exec-2 ServerInfo.selectServerInfo
09-02 15:02:29.440 ttp-nio-18084-exec-2 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:02:29.441 ttp-nio-18084-exec-2 ==> Parameters: 
09-02 15:02:29.441 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:29.441 ttp-nio-18084-exec-2 Scenario.updateScenario2StepInfo
09-02 15:02:29.441 ttp-nio-18084-exec-2 ==>  Preparing: UPDATE nvscenario SET lastupdate_dt = ? , lastupdate_tm = ? , finish_yn = ? , finish_dt = ? WHERE scenario_no = ? 
09-02 15:02:29.443 ttp-nio-18084-exec-2 ==> Parameters: 20210902(String), 150229(String), N(String), null, 1(Integer)
09-02 15:02:29.444 ttp-nio-18084-exec-2 <==    Updates: 1
09-02 15:02:29.444 ttp-nio-18084-exec-2 Campaign.updateCampaign2StepInfo
09-02 15:02:29.444 ttp-nio-18084-exec-2 ==>  Preparing: UPDATE nvcampaign SET grp_cd = ? , user_id = ? , segment_no = ? , campaign_nm = ? , campaign_desc = ? , lastupdate_dt = ? , lastupdate_tm = ? , campaign_type = ? , sending_sts = ? , sending_cycle = ? , target_cnt = ? , survey_end_yn = ? , survey_response_cnt = ? , survey_start_dt = ? , survey_start_tm = ? , survey_end_dt = ? , survey_end_tm = ? , retry_cnt = ? , sender_nm = ? , sender_email = ? , receiver_nm = ? , sender_tel = ? , retmail_receiver = ? , campaign_class = ? , relation_type = ? , campaign_level = ? , editor_id = ? , approval_sts = ? , kakao_image_no = ? , failback_send_yn = ? , failback_subject = '' WHERE campaign_no = ? 
09-02 15:02:29.444 ttp-nio-18084-exec-2 ==> Parameters: 01(String), admin(String), 8(Integer), 켐페인명 수정(String), null, 20210902(String), 150229(String), Y(String), null, null, 2(Integer), null, 0(Integer), null, null, null, null, 1(Integer), 페퍼저축은행(String), peper@mnwise.com(String), null, null, peper@mnwise.com(String), A(String), N(String), 3(String), null, null, 0(Integer), N(String), 1(Integer)
09-02 15:02:29.445 ttp-nio-18084-exec-2 <==    Updates: 1
09-02 15:02:29.446 ttp-nio-18084-exec-2 TraceInfo.selectTraceInfoCnt
09-02 15:02:29.446 ttp-nio-18084-exec-2 ==>  Preparing: SELECT count(*) FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:29.447 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:29.447 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:29.448 ttp-nio-18084-exec-2 TraceInfo.updateTraceInfo
09-02 15:02:29.448 ttp-nio-18084-exec-2 ==>  Preparing: UPDATE nvtraceinfo SET start_dt = ? , start_tm = ? , end_dt = ? , end_tm = ? WHERE campaign_no = ? 
09-02 15:02:29.448 ttp-nio-18084-exec-2 ==> Parameters: 20210813(String), 161200(String), 20210820(String), 235959(String), 1(Integer)
09-02 15:02:29.450 ttp-nio-18084-exec-2 <==    Updates: 1
09-02 15:02:29.459 ttp-nio-18084-exec-1 Campaign.getScenarioChannelInfo
09-02 15:02:29.459 ttp-nio-18084-exec-1 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:02:29.459 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer)
09-02 15:02:29.460 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:29.461 ttp-nio-18084-exec-1 Scenario.selectScenarioDetailInfo
09-02 15:02:29.461 ttp-nio-18084-exec-1 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:02:29.461 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer), 1(Integer)
09-02 15:02:29.462 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:29.514 ttp-nio-18084-exec-1 TraceInfo.selectTraceInfo
09-02 15:02:29.515 ttp-nio-18084-exec-1 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:29.515 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer)
09-02 15:02:29.516 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:29.518 ttp-nio-18084-exec-1 ServerInfo.selectServerInfo
09-02 15:02:29.518 ttp-nio-18084-exec-1 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:02:29.518 ttp-nio-18084-exec-1 ==> Parameters: 
09-02 15:02:29.519 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:30.207 ttp-nio-18084-exec-4 Campaign.selectEditorCampaign
09-02 15:02:30.207 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:30.208 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer)
09-02 15:02:30.209 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:02:30.272 ttp-nio-18084-exec-3 Campaign.selectEditorCampaign
09-02 15:02:30.272 ttp-nio-18084-exec-3 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:30.273 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer)
09-02 15:02:30.273 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:30.274 ttp-nio-18084-exec-6 Application.selectEditorCampaignHandler
09-02 15:02:30.274 ttp-nio-18084-exec-6 ==>  Preparing: SELECT type, appsource FROM nvapplication WHERE campaign_no = ? 
09-02 15:02:30.274 ttp-nio-18084-exec-6 ==> Parameters: 1(Integer)
09-02 15:02:30.274 ttp-nio-18084-exec-3 DefaultHandler.selectHandlerUseList
09-02 15:02:30.274 ttp-nio-18084-exec-3 ==>  Preparing: SELECT seq, handle_nm, handle_desc FROM nvdefaulthandler c WHERE EXISTS ( SELECT 0 FROM nvcampaign a, nvscenario b WHERE a.scenario_no = b.scenario_no AND a.channel_type = c.channel AND b.handler_type = c.handle_type AND a.campaign_no = ? AND c.service_type IS NULL AND c.ab_test_yn = (CASE a.ab_test_type WHEN 'N' THEN 'N' ELSE 'Y' END) ) ORDER BY seq 
09-02 15:02:30.274 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer)
09-02 15:02:30.275 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:30.275 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:02:30.370 ttp-nio-18084-exec-5 MultipartFile.selectEditorCampaignMultipartFile
09-02 15:02:30.370 ttp-nio-18084-exec-5 ==>  Preparing: SELECT file_alias, file_path, file_size, file_name FROM nvmultipartfile WHERE campaign_no = ? 
09-02 15:02:30.371 ttp-nio-18084-exec-5 ==> Parameters: 1(Integer)
09-02 15:02:30.371 ttp-nio-18084-exec-5 <==      Total: 0
09-02 15:02:30.395 ttp-nio-18084-exec-2 Semantic.selectSemanticListBySegmentNo
09-02 15:02:30.396 ttp-nio-18084-exec-2 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:02:30.396 ttp-nio-18084-exec-2 ==> Parameters: 8(Integer)
09-02 15:02:30.396 ttp-nio-18084-exec-2 <==      Total: 5
09-02 15:02:30.410 ttp-nio-18084-exec-1 Template.selectEditorCampaignTemplate
09-02 15:02:30.410 ttp-nio-18084-exec-1 ==>  Preparing: SELECT seg, template, kakao_buttons, CASE WHEN seg = ' ' THEN 0 ELSE 1 END seg_no FROM nvtemplate WHERE campaign_no = ? ORDER BY seg_no 
09-02 15:02:30.411 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer)
09-02 15:02:30.412 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:30.413 ttp-nio-18084-exec-1 Semantic.selectSemanticListBySegmentNo
09-02 15:02:30.413 ttp-nio-18084-exec-1 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:02:30.413 ttp-nio-18084-exec-1 ==> Parameters: 8(Integer)
09-02 15:02:30.413 ttp-nio-18084-exec-1 <==      Total: 5
09-02 15:02:30.440 ttp-nio-18084-exec-7 LinkTrace.selectEditorCampaignLinkseqMax
09-02 15:02:30.440 ttp-nio-18084-exec-7 ==>  Preparing: SELECT coalesce(max(link_seq),0) link_seq FROM nvlinktrace WHERE campaign_no = ? 
09-02 15:02:30.440 ttp-nio-18084-exec-7 ==> Parameters: 1(Integer)
09-02 15:02:30.441 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:02:32.019 ttp-nio-18084-exec-4 Scenario.selectScenarioBasicInfo
09-02 15:02:32.019 ttp-nio-18084-exec-4 ==>  Preparing: SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_desc, b.campaign_preface, b.campaign_sts , b.campaign_type, b.sendstart_dt, b.sendstart_tm, b.target_cnt, b.survey_no, coalesce(b.retry_cnt,1) retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm, b.sender_tel , b.retmail_receiver, b.channel_type, b.promotion_type, b.campaign_level, b.depth_no, b.approval_sts, b.req_dept_id req_dept, b.req_user_id req_user, b.divide_yn, b.divide_interval , coalesce(b.divide_cnt,0) divide_cnt, b.ab_test_type, b.ab_test_cond, coalesce(b.ab_test_rate,0) ab_test_rate, b.campaign_preface_ab , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = b.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100121' AND cd = b.approval_sts AND lang = ?) approval_sts_nm , (CASE WHEN b.channel_type = 'm' THEN 4 WHEN b.channel_type = 's' THEN 3 WHEN b.channel_type = 't' THEN 2 ELSE 1 END) seq , c.tag_nm, d.grp_nm, e.name_kor, f.supracampaign_no, '' req_grp_nm FROM nvscenario a, nvcampaign b, nvcamptag c, nvusergrp d, nvuser e, nvschedule f WHERE a.scenario_no = b.scenario_no AND a.tag_no = c.tag_no AND a.grp_cd = d.grp_cd AND a.user_id = e.user_id AND b.campaign_no = f.campaign_no AND a.scenario_no = ? AND b.campaign_no = ? AND b.depth_no = ? ORDER BY seq DESC 
09-02 15:02:32.019 ttp-nio-18084-exec-4 ==> Parameters: ko(String), ko(String), 1(Integer), 1(Integer), 1(Integer)
09-02 15:02:32.021 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:02:32.022 ttp-nio-18084-exec-4 Segment.selectSegmentByPk
09-02 15:02:32.022 ttp-nio-18084-exec-4 ==>  Preparing: SELECT segment_no, user_id, grp_cd, segment_nm, coalesce(dbinfo_seq,0) dbinfo_seq, segment_desc, sqlhead, sqltail, sqlbody, sqlfilter , lastupdate_dt, coalesce(segment_size,0) segment_size, crtgrp_cd, segment_type, filetodb_yn, editor_id, coalesce(share_yn,'N') share_yn, coalesce(active_yn,'Y') active_yn, category_cd, segment_sts , coalesce(tag_no,0) tag_no, coalesce(psegment_no,0) psegment_no, plink_seq, seg_type, testquery, updatequery , (SELECT name_kor FROM nvuser WHERE user_id = coalesce(a.editor_id, a.user_id)) name_kor , (SELECT tag_nm FROM nvsegmenttag WHERE tag_no = a.tag_no) as tag_nm FROM nvsegment a WHERE segment_no = ? 
09-02 15:02:32.022 ttp-nio-18084-exec-4 ==> Parameters: 8(Integer)
09-02 15:02:32.023 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:02:32.023 ttp-nio-18084-exec-4 TraceInfo.selectTraceInfo
09-02 15:02:32.024 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:32.024 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer)
09-02 15:02:32.024 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:02:32.025 ttp-nio-18084-exec-4 ServerInfo.selectServerInfo
09-02 15:02:32.025 ttp-nio-18084-exec-4 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:02:32.025 ttp-nio-18084-exec-4 ==> Parameters: 
09-02 15:02:32.025 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:02:32.026 ttp-nio-18084-exec-4 Campaign.selectSubCampaignList
09-02 15:02:32.026 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_no, scenario_no, campaign_nm, channel_type, depth_no, relation_type FROM nvcampaign WHERE scenario_no = ? AND depth_no = ? AND relation_tree LIKE concat((SELECT relation_tree FROM nvcampaign WHERE campaign_no = ?), '%') 
09-02 15:02:32.026 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer), 2(Integer), 1(Integer)
09-02 15:02:32.027 ttp-nio-18084-exec-4 <==      Total: 0
09-02 15:02:32.027 ttp-nio-18084-exec-4 Semantic.selectCampaignSemanticKey
09-02 15:02:32.027 ttp-nio-18084-exec-4 ==>  Preparing: SELECT field_key FROM nvsemantic WHERE segment_no = (SELECT segment_no FROM nvcampaign WHERE scenario_no = ? AND depth_no = 1) AND field_key IS NOT NULL 
09-02 15:02:32.027 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer)
09-02 15:02:32.028 ttp-nio-18084-exec-4 <==      Total: 5
09-02 15:02:40.321 ttp-nio-18084-exec-3 Campaign.selectCampaignInfo
09-02 15:02:40.321 ttp-nio-18084-exec-3 ==>  Preparing: SELECT campaign_no, campaign_sts, approval_sts, sendstart_dt, sendstart_tm, coalesce(segment_no,0) segment_no FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:40.321 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer)
09-02 15:02:40.322 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:40.323 ttp-nio-18084-exec-3 Campaign.selectCampaignType
09-02 15:02:40.323 ttp-nio-18084-exec-3 ==>  Preparing: SELECT campaign_type FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:40.323 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer)
09-02 15:02:40.324 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:40.325 ttp-nio-18084-exec-3 TraceInfo.selectTraceInfoCnt
09-02 15:02:40.325 ttp-nio-18084-exec-3 ==>  Preparing: SELECT count(*) FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:40.325 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer)
09-02 15:02:40.326 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:40.326 ttp-nio-18084-exec-3 TraceInfo.updateTraceInfo
09-02 15:02:40.326 ttp-nio-18084-exec-3 ==>  Preparing: UPDATE nvtraceinfo SET start_dt = ? , start_tm = ? , end_dt = ? , end_tm = ? WHERE campaign_no = ? 
09-02 15:02:40.327 ttp-nio-18084-exec-3 ==> Parameters: 20210813(String), 000000(String), 20210820(String), 235900(String), 1(Integer)
09-02 15:02:40.328 ttp-nio-18084-exec-3 <==    Updates: 1
09-02 15:02:40.329 ttp-nio-18084-exec-3 DivideSchedule.deleteDivideSchedule
09-02 15:02:40.329 ttp-nio-18084-exec-3 ==>  Preparing: DELETE FROM nvdivideschedule WHERE SERVICE_NO = ? AND client = 'EM' 
09-02 15:02:40.331 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer)
09-02 15:02:40.352 ttp-nio-18084-exec-3 <==    Updates: 0
09-02 15:02:40.353 ttp-nio-18084-exec-3 DivideSchedule.insertDivideSchedule
09-02 15:02:40.353 ttp-nio-18084-exec-3 ==>  Preparing: INSERT INTO nvdivideschedule (client, service_no, divide_seq, target_cnt, start_dt) VALUES (?, ?, ?, ?, ?) 
09-02 15:02:40.353 ttp-nio-18084-exec-3 ==> Parameters: EM(String), 1(Integer), 0(Integer), 1(Integer), 20210902150200(String)
09-02 15:02:40.641 ttp-nio-18084-exec-3 <==    Updates: 1
09-02 15:02:40.641 ttp-nio-18084-exec-3 DivideSchedule.insertDivideSchedule
09-02 15:02:40.641 ttp-nio-18084-exec-3 ==>  Preparing: INSERT INTO nvdivideschedule (client, service_no, divide_seq, target_cnt, start_dt) VALUES (?, ?, ?, ?, ?) 
09-02 15:02:40.642 ttp-nio-18084-exec-3 ==> Parameters: EM(String), 1(Integer), 1(Integer), 1(Integer), 20210902150300(String)
09-02 15:02:40.643 ttp-nio-18084-exec-3 <==    Updates: 1
09-02 15:02:40.644 ttp-nio-18084-exec-3 Campaign.updateCampaignScheduleInfo
09-02 15:02:40.644 ttp-nio-18084-exec-3 ==>  Preparing: UPDATE nvcampaign SET sendstart_dt = ?, sendstart_tm = ?, campaign_sts = ? , divide_yn = ?, divide_interval = ?, divide_cnt = ? WHERE campaign_no = ? 
09-02 15:02:40.645 ttp-nio-18084-exec-3 ==> Parameters: 20210902(String), 150200(String), P(String), Y(String), 1(Integer), 2(Integer), 1(Integer)
09-02 15:02:40.646 ttp-nio-18084-exec-3 <==    Updates: 1
09-02 15:02:40.684 ttp-nio-18084-exec-6 Scenario.selectScenarioBasicInfo
09-02 15:02:40.684 ttp-nio-18084-exec-6 ==>  Preparing: SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_desc, b.campaign_preface, b.campaign_sts , b.campaign_type, b.sendstart_dt, b.sendstart_tm, b.target_cnt, b.survey_no, coalesce(b.retry_cnt,1) retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm, b.sender_tel , b.retmail_receiver, b.channel_type, b.promotion_type, b.campaign_level, b.depth_no, b.approval_sts, b.req_dept_id req_dept, b.req_user_id req_user, b.divide_yn, b.divide_interval , coalesce(b.divide_cnt,0) divide_cnt, b.ab_test_type, b.ab_test_cond, coalesce(b.ab_test_rate,0) ab_test_rate, b.campaign_preface_ab , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = b.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100121' AND cd = b.approval_sts AND lang = ?) approval_sts_nm , (CASE WHEN b.channel_type = 'm' THEN 4 WHEN b.channel_type = 's' THEN 3 WHEN b.channel_type = 't' THEN 2 ELSE 1 END) seq , c.tag_nm, d.grp_nm, e.name_kor, f.supracampaign_no, '' req_grp_nm FROM nvscenario a, nvcampaign b, nvcamptag c, nvusergrp d, nvuser e, nvschedule f WHERE a.scenario_no = b.scenario_no AND a.tag_no = c.tag_no AND a.grp_cd = d.grp_cd AND a.user_id = e.user_id AND b.campaign_no = f.campaign_no AND a.scenario_no = ? AND b.campaign_no = ? AND b.depth_no = ? ORDER BY seq DESC 
09-02 15:02:40.685 ttp-nio-18084-exec-6 ==> Parameters: ko(String), ko(String), 1(Integer), 1(Integer), 1(Integer)
09-02 15:02:40.688 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:02:40.689 ttp-nio-18084-exec-6 Segment.selectSegmentByPk
09-02 15:02:40.689 ttp-nio-18084-exec-6 ==>  Preparing: SELECT segment_no, user_id, grp_cd, segment_nm, coalesce(dbinfo_seq,0) dbinfo_seq, segment_desc, sqlhead, sqltail, sqlbody, sqlfilter , lastupdate_dt, coalesce(segment_size,0) segment_size, crtgrp_cd, segment_type, filetodb_yn, editor_id, coalesce(share_yn,'N') share_yn, coalesce(active_yn,'Y') active_yn, category_cd, segment_sts , coalesce(tag_no,0) tag_no, coalesce(psegment_no,0) psegment_no, plink_seq, seg_type, testquery, updatequery , (SELECT name_kor FROM nvuser WHERE user_id = coalesce(a.editor_id, a.user_id)) name_kor , (SELECT tag_nm FROM nvsegmenttag WHERE tag_no = a.tag_no) as tag_nm FROM nvsegment a WHERE segment_no = ? 
09-02 15:02:40.689 ttp-nio-18084-exec-6 ==> Parameters: 8(Integer)
09-02 15:02:40.690 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:02:40.691 ttp-nio-18084-exec-6 DivideSchedule.selectDivideSchedule
09-02 15:02:40.691 ttp-nio-18084-exec-6 ==>  Preparing: SELECT client, service_no, divide_seq, target_cnt, start_dt FROM nvdivideschedule WHERE client = 'EM' AND service_no = ? 
09-02 15:02:40.692 ttp-nio-18084-exec-6 ==> Parameters: 1(Integer)
09-02 15:02:40.694 ttp-nio-18084-exec-6 <==      Total: 2
09-02 15:02:40.695 ttp-nio-18084-exec-6 TraceInfo.selectTraceInfo
09-02 15:02:40.695 ttp-nio-18084-exec-6 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:40.695 ttp-nio-18084-exec-6 ==> Parameters: 1(Integer)
09-02 15:02:40.697 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:02:40.699 ttp-nio-18084-exec-6 ServerInfo.selectServerInfo
09-02 15:02:40.699 ttp-nio-18084-exec-6 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:02:40.699 ttp-nio-18084-exec-6 ==> Parameters: 
09-02 15:02:40.701 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:02:40.702 ttp-nio-18084-exec-6 Campaign.selectSubCampaignList
09-02 15:02:40.702 ttp-nio-18084-exec-6 ==>  Preparing: SELECT campaign_no, scenario_no, campaign_nm, channel_type, depth_no, relation_type FROM nvcampaign WHERE scenario_no = ? AND depth_no = ? AND relation_tree LIKE concat((SELECT relation_tree FROM nvcampaign WHERE campaign_no = ?), '%') 
09-02 15:02:40.702 ttp-nio-18084-exec-6 ==> Parameters: 1(Integer), 2(Integer), 1(Integer)
09-02 15:02:40.703 ttp-nio-18084-exec-6 <==      Total: 0
09-02 15:02:40.704 ttp-nio-18084-exec-6 Semantic.selectCampaignSemanticKey
09-02 15:02:40.704 ttp-nio-18084-exec-6 ==>  Preparing: SELECT field_key FROM nvsemantic WHERE segment_no = (SELECT segment_no FROM nvcampaign WHERE scenario_no = ? AND depth_no = 1) AND field_key IS NOT NULL 
09-02 15:02:40.704 ttp-nio-18084-exec-6 ==> Parameters: 1(Integer)
09-02 15:02:40.705 ttp-nio-18084-exec-6 <==      Total: 5
09-02 15:02:58.535 ttp-nio-18084-exec-2 Campaign.selectCampaignInfo
09-02 15:02:58.535 ttp-nio-18084-exec-2 ==>  Preparing: SELECT campaign_no, campaign_sts, approval_sts, sendstart_dt, sendstart_tm, coalesce(segment_no,0) segment_no FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:58.536 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:58.536 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:58.537 ttp-nio-18084-exec-2 Campaign.selectCampaignType
09-02 15:02:58.537 ttp-nio-18084-exec-2 ==>  Preparing: SELECT campaign_type FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:58.537 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:58.538 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:58.540 ttp-nio-18084-exec-2 TraceInfo.selectTraceInfoCnt
09-02 15:02:58.540 ttp-nio-18084-exec-2 ==>  Preparing: SELECT count(*) FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:58.540 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:58.540 ttp-nio-18084-exec-2 <==      Total: 1
09-02 15:02:58.541 ttp-nio-18084-exec-2 TraceInfo.updateTraceInfo
09-02 15:02:58.541 ttp-nio-18084-exec-2 ==>  Preparing: UPDATE nvtraceinfo SET start_dt = ? , start_tm = ? , end_dt = ? , end_tm = ? WHERE campaign_no = ? 
09-02 15:02:58.546 ttp-nio-18084-exec-2 ==> Parameters: 20210813(String), 000000(String), 20210820(String), 235900(String), 1(Integer)
09-02 15:02:58.547 ttp-nio-18084-exec-2 <==    Updates: 1
09-02 15:02:58.548 ttp-nio-18084-exec-2 DivideSchedule.deleteDivideSchedule
09-02 15:02:58.548 ttp-nio-18084-exec-2 ==>  Preparing: DELETE FROM nvdivideschedule WHERE SERVICE_NO = ? AND client = 'EM' 
09-02 15:02:58.548 ttp-nio-18084-exec-2 ==> Parameters: 1(Integer)
09-02 15:02:58.550 ttp-nio-18084-exec-2 <==    Updates: 2
09-02 15:02:58.551 ttp-nio-18084-exec-2 DivideSchedule.insertDivideSchedule
09-02 15:02:58.551 ttp-nio-18084-exec-2 ==>  Preparing: INSERT INTO nvdivideschedule (client, service_no, divide_seq, target_cnt, start_dt) VALUES (?, ?, ?, ?, ?) 
09-02 15:02:58.551 ttp-nio-18084-exec-2 ==> Parameters: EM(String), 1(Integer), 0(Integer), 1(Integer), 20210903150300(String)
09-02 15:02:58.552 ttp-nio-18084-exec-2 <==    Updates: 1
09-02 15:02:58.552 ttp-nio-18084-exec-2 DivideSchedule.insertDivideSchedule
09-02 15:02:58.552 ttp-nio-18084-exec-2 ==>  Preparing: INSERT INTO nvdivideschedule (client, service_no, divide_seq, target_cnt, start_dt) VALUES (?, ?, ?, ?, ?) 
09-02 15:02:58.552 ttp-nio-18084-exec-2 ==> Parameters: EM(String), 1(Integer), 1(Integer), 1(Integer), 20210903150400(String)
09-02 15:02:58.554 ttp-nio-18084-exec-2 <==    Updates: 1
09-02 15:02:58.554 ttp-nio-18084-exec-2 Campaign.updateCampaignScheduleInfo
09-02 15:02:58.555 ttp-nio-18084-exec-2 ==>  Preparing: UPDATE nvcampaign SET sendstart_dt = ?, sendstart_tm = ?, campaign_sts = ? , divide_yn = ?, divide_interval = ?, divide_cnt = ? WHERE campaign_no = ? 
09-02 15:02:58.555 ttp-nio-18084-exec-2 ==> Parameters: 20210903(String), 150300(String), P(String), Y(String), 1(Integer), 2(Integer), 1(Integer)
09-02 15:02:58.556 ttp-nio-18084-exec-2 <==    Updates: 1
09-02 15:02:58.599 ttp-nio-18084-exec-1 Scenario.selectScenarioBasicInfo
09-02 15:02:58.599 ttp-nio-18084-exec-1 ==>  Preparing: SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_desc, b.campaign_preface, b.campaign_sts , b.campaign_type, b.sendstart_dt, b.sendstart_tm, b.target_cnt, b.survey_no, coalesce(b.retry_cnt,1) retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm, b.sender_tel , b.retmail_receiver, b.channel_type, b.promotion_type, b.campaign_level, b.depth_no, b.approval_sts, b.req_dept_id req_dept, b.req_user_id req_user, b.divide_yn, b.divide_interval , coalesce(b.divide_cnt,0) divide_cnt, b.ab_test_type, b.ab_test_cond, coalesce(b.ab_test_rate,0) ab_test_rate, b.campaign_preface_ab , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = b.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100121' AND cd = b.approval_sts AND lang = ?) approval_sts_nm , (CASE WHEN b.channel_type = 'm' THEN 4 WHEN b.channel_type = 's' THEN 3 WHEN b.channel_type = 't' THEN 2 ELSE 1 END) seq , c.tag_nm, d.grp_nm, e.name_kor, f.supracampaign_no, '' req_grp_nm FROM nvscenario a, nvcampaign b, nvcamptag c, nvusergrp d, nvuser e, nvschedule f WHERE a.scenario_no = b.scenario_no AND a.tag_no = c.tag_no AND a.grp_cd = d.grp_cd AND a.user_id = e.user_id AND b.campaign_no = f.campaign_no AND a.scenario_no = ? AND b.campaign_no = ? AND b.depth_no = ? ORDER BY seq DESC 
09-02 15:02:58.599 ttp-nio-18084-exec-1 ==> Parameters: ko(String), ko(String), 1(Integer), 1(Integer), 1(Integer)
09-02 15:02:58.602 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:58.603 ttp-nio-18084-exec-1 Segment.selectSegmentByPk
09-02 15:02:58.603 ttp-nio-18084-exec-1 ==>  Preparing: SELECT segment_no, user_id, grp_cd, segment_nm, coalesce(dbinfo_seq,0) dbinfo_seq, segment_desc, sqlhead, sqltail, sqlbody, sqlfilter , lastupdate_dt, coalesce(segment_size,0) segment_size, crtgrp_cd, segment_type, filetodb_yn, editor_id, coalesce(share_yn,'N') share_yn, coalesce(active_yn,'Y') active_yn, category_cd, segment_sts , coalesce(tag_no,0) tag_no, coalesce(psegment_no,0) psegment_no, plink_seq, seg_type, testquery, updatequery , (SELECT name_kor FROM nvuser WHERE user_id = coalesce(a.editor_id, a.user_id)) name_kor , (SELECT tag_nm FROM nvsegmenttag WHERE tag_no = a.tag_no) as tag_nm FROM nvsegment a WHERE segment_no = ? 
09-02 15:02:58.603 ttp-nio-18084-exec-1 ==> Parameters: 8(Integer)
09-02 15:02:58.604 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:58.605 ttp-nio-18084-exec-1 DivideSchedule.selectDivideSchedule
09-02 15:02:58.605 ttp-nio-18084-exec-1 ==>  Preparing: SELECT client, service_no, divide_seq, target_cnt, start_dt FROM nvdivideschedule WHERE client = 'EM' AND service_no = ? 
09-02 15:02:58.605 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer)
09-02 15:02:58.606 ttp-nio-18084-exec-1 <==      Total: 2
09-02 15:02:58.608 ttp-nio-18084-exec-1 TraceInfo.selectTraceInfo
09-02 15:02:58.608 ttp-nio-18084-exec-1 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:58.608 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer)
09-02 15:02:58.609 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:58.611 ttp-nio-18084-exec-1 ServerInfo.selectServerInfo
09-02 15:02:58.611 ttp-nio-18084-exec-1 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:02:58.611 ttp-nio-18084-exec-1 ==> Parameters: 
09-02 15:02:58.612 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:02:58.613 ttp-nio-18084-exec-1 Campaign.selectSubCampaignList
09-02 15:02:58.613 ttp-nio-18084-exec-1 ==>  Preparing: SELECT campaign_no, scenario_no, campaign_nm, channel_type, depth_no, relation_type FROM nvcampaign WHERE scenario_no = ? AND depth_no = ? AND relation_tree LIKE concat((SELECT relation_tree FROM nvcampaign WHERE campaign_no = ?), '%') 
09-02 15:02:58.613 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer), 2(Integer), 1(Integer)
09-02 15:02:58.614 ttp-nio-18084-exec-1 <==      Total: 0
09-02 15:02:58.615 ttp-nio-18084-exec-1 Semantic.selectCampaignSemanticKey
09-02 15:02:58.615 ttp-nio-18084-exec-1 ==>  Preparing: SELECT field_key FROM nvsemantic WHERE segment_no = (SELECT segment_no FROM nvcampaign WHERE scenario_no = ? AND depth_no = 1) AND field_key IS NOT NULL 
09-02 15:02:58.615 ttp-nio-18084-exec-1 ==> Parameters: 1(Integer)
09-02 15:02:58.616 ttp-nio-18084-exec-1 <==      Total: 5
09-02 15:02:59.536 ttp-nio-18084-exec-4 Campaign.selectCampaignInfo
09-02 15:02:59.536 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_no, campaign_sts, approval_sts, sendstart_dt, sendstart_tm, coalesce(segment_no,0) segment_no FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:59.536 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer)
09-02 15:02:59.537 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:02:59.538 ttp-nio-18084-exec-4 Campaign.selectCampaignType
09-02 15:02:59.538 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_type FROM nvcampaign WHERE campaign_no = ? 
09-02 15:02:59.538 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer)
09-02 15:02:59.539 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:02:59.540 ttp-nio-18084-exec-4 TraceInfo.selectTraceInfoCnt
09-02 15:02:59.540 ttp-nio-18084-exec-4 ==>  Preparing: SELECT count(*) FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:59.540 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer)
09-02 15:02:59.541 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:02:59.542 ttp-nio-18084-exec-4 TraceInfo.updateTraceInfo
09-02 15:02:59.542 ttp-nio-18084-exec-4 ==>  Preparing: UPDATE nvtraceinfo SET start_dt = ? , start_tm = ? , end_dt = ? , end_tm = ? WHERE campaign_no = ? 
09-02 15:02:59.542 ttp-nio-18084-exec-4 ==> Parameters: 20210813(String), 000000(String), 20210820(String), 235900(String), 1(Integer)
09-02 15:02:59.544 ttp-nio-18084-exec-4 <==    Updates: 1
09-02 15:02:59.544 ttp-nio-18084-exec-4 DivideSchedule.deleteDivideSchedule
09-02 15:02:59.544 ttp-nio-18084-exec-4 ==>  Preparing: DELETE FROM nvdivideschedule WHERE SERVICE_NO = ? AND client = 'EM' 
09-02 15:02:59.545 ttp-nio-18084-exec-4 ==> Parameters: 1(Integer)
09-02 15:02:59.546 ttp-nio-18084-exec-4 <==    Updates: 2
09-02 15:02:59.546 ttp-nio-18084-exec-4 DivideSchedule.insertDivideSchedule
09-02 15:02:59.546 ttp-nio-18084-exec-4 ==>  Preparing: INSERT INTO nvdivideschedule (client, service_no, divide_seq, target_cnt, start_dt) VALUES (?, ?, ?, ?, ?) 
09-02 15:02:59.547 ttp-nio-18084-exec-4 ==> Parameters: EM(String), 1(Integer), 0(Integer), 1(Integer), 20210903150300(String)
09-02 15:02:59.548 ttp-nio-18084-exec-4 <==    Updates: 1
09-02 15:02:59.548 ttp-nio-18084-exec-4 DivideSchedule.insertDivideSchedule
09-02 15:02:59.548 ttp-nio-18084-exec-4 ==>  Preparing: INSERT INTO nvdivideschedule (client, service_no, divide_seq, target_cnt, start_dt) VALUES (?, ?, ?, ?, ?) 
09-02 15:02:59.549 ttp-nio-18084-exec-4 ==> Parameters: EM(String), 1(Integer), 1(Integer), 1(Integer), 20210903150400(String)
09-02 15:02:59.550 ttp-nio-18084-exec-4 <==    Updates: 1
09-02 15:02:59.550 ttp-nio-18084-exec-4 Campaign.updateCampaignScheduleInfo
09-02 15:02:59.550 ttp-nio-18084-exec-4 ==>  Preparing: UPDATE nvcampaign SET sendstart_dt = ?, sendstart_tm = ?, campaign_sts = ? , divide_yn = ?, divide_interval = ?, divide_cnt = ? WHERE campaign_no = ? 
09-02 15:02:59.551 ttp-nio-18084-exec-4 ==> Parameters: 20210903(String), 150300(String), P(String), Y(String), 1(Integer), 2(Integer), 1(Integer)
09-02 15:02:59.552 ttp-nio-18084-exec-4 <==    Updates: 1
09-02 15:02:59.566 ttp-nio-18084-exec-3 Scenario.selectScenarioBasicInfo
09-02 15:02:59.566 ttp-nio-18084-exec-3 ==>  Preparing: SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_desc, b.campaign_preface, b.campaign_sts , b.campaign_type, b.sendstart_dt, b.sendstart_tm, b.target_cnt, b.survey_no, coalesce(b.retry_cnt,1) retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm, b.sender_tel , b.retmail_receiver, b.channel_type, b.promotion_type, b.campaign_level, b.depth_no, b.approval_sts, b.req_dept_id req_dept, b.req_user_id req_user, b.divide_yn, b.divide_interval , coalesce(b.divide_cnt,0) divide_cnt, b.ab_test_type, b.ab_test_cond, coalesce(b.ab_test_rate,0) ab_test_rate, b.campaign_preface_ab , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100111' AND cd = b.campaign_sts AND lang = ?) campaign_sts_nm , (SELECT val FROM nv_cd_mst WHERE cd_cat = '100121' AND cd = b.approval_sts AND lang = ?) approval_sts_nm , (CASE WHEN b.channel_type = 'm' THEN 4 WHEN b.channel_type = 's' THEN 3 WHEN b.channel_type = 't' THEN 2 ELSE 1 END) seq , c.tag_nm, d.grp_nm, e.name_kor, f.supracampaign_no, '' req_grp_nm FROM nvscenario a, nvcampaign b, nvcamptag c, nvusergrp d, nvuser e, nvschedule f WHERE a.scenario_no = b.scenario_no AND a.tag_no = c.tag_no AND a.grp_cd = d.grp_cd AND a.user_id = e.user_id AND b.campaign_no = f.campaign_no AND a.scenario_no = ? AND b.campaign_no = ? AND b.depth_no = ? ORDER BY seq DESC 
09-02 15:02:59.566 ttp-nio-18084-exec-3 ==> Parameters: ko(String), ko(String), 1(Integer), 1(Integer), 1(Integer)
09-02 15:02:59.569 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:59.570 ttp-nio-18084-exec-3 Segment.selectSegmentByPk
09-02 15:02:59.570 ttp-nio-18084-exec-3 ==>  Preparing: SELECT segment_no, user_id, grp_cd, segment_nm, coalesce(dbinfo_seq,0) dbinfo_seq, segment_desc, sqlhead, sqltail, sqlbody, sqlfilter , lastupdate_dt, coalesce(segment_size,0) segment_size, crtgrp_cd, segment_type, filetodb_yn, editor_id, coalesce(share_yn,'N') share_yn, coalesce(active_yn,'Y') active_yn, category_cd, segment_sts , coalesce(tag_no,0) tag_no, coalesce(psegment_no,0) psegment_no, plink_seq, seg_type, testquery, updatequery , (SELECT name_kor FROM nvuser WHERE user_id = coalesce(a.editor_id, a.user_id)) name_kor , (SELECT tag_nm FROM nvsegmenttag WHERE tag_no = a.tag_no) as tag_nm FROM nvsegment a WHERE segment_no = ? 
09-02 15:02:59.570 ttp-nio-18084-exec-3 ==> Parameters: 8(Integer)
09-02 15:02:59.571 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:59.572 ttp-nio-18084-exec-3 DivideSchedule.selectDivideSchedule
09-02 15:02:59.572 ttp-nio-18084-exec-3 ==>  Preparing: SELECT client, service_no, divide_seq, target_cnt, start_dt FROM nvdivideschedule WHERE client = 'EM' AND service_no = ? 
09-02 15:02:59.572 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer)
09-02 15:02:59.573 ttp-nio-18084-exec-3 <==      Total: 2
09-02 15:02:59.573 ttp-nio-18084-exec-3 TraceInfo.selectTraceInfo
09-02 15:02:59.573 ttp-nio-18084-exec-3 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:02:59.573 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer)
09-02 15:02:59.574 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:59.576 ttp-nio-18084-exec-3 ServerInfo.selectServerInfo
09-02 15:02:59.576 ttp-nio-18084-exec-3 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:02:59.576 ttp-nio-18084-exec-3 ==> Parameters: 
09-02 15:02:59.577 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:02:59.577 ttp-nio-18084-exec-3 Campaign.selectSubCampaignList
09-02 15:02:59.578 ttp-nio-18084-exec-3 ==>  Preparing: SELECT campaign_no, scenario_no, campaign_nm, channel_type, depth_no, relation_type FROM nvcampaign WHERE scenario_no = ? AND depth_no = ? AND relation_tree LIKE concat((SELECT relation_tree FROM nvcampaign WHERE campaign_no = ?), '%') 
09-02 15:02:59.578 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer), 2(Integer), 1(Integer)
09-02 15:02:59.579 ttp-nio-18084-exec-3 <==      Total: 0
09-02 15:02:59.580 ttp-nio-18084-exec-3 Semantic.selectCampaignSemanticKey
09-02 15:02:59.580 ttp-nio-18084-exec-3 ==>  Preparing: SELECT field_key FROM nvsemantic WHERE segment_no = (SELECT segment_no FROM nvcampaign WHERE scenario_no = ? AND depth_no = 1) AND field_key IS NOT NULL 
09-02 15:02:59.580 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer)
09-02 15:02:59.580 ttp-nio-18084-exec-3 <==      Total: 5
09-02 15:13:23.559 ttp-nio-18084-exec-7 Tag.selectTagNo
09-02 15:13:23.560 ttp-nio-18084-exec-7 ==>  Preparing: SELECT tag_no FROM nvcamptag WHERE (tag_nm = '' OR tag_nm IS NULL) 
09-02 15:13:23.560 ttp-nio-18084-exec-7 ==> Parameters: 
09-02 15:13:23.577 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:13:23.611 ttp-nio-18084-exec-7 ServerInfo.selectServerInfo
09-02 15:13:23.612 ttp-nio-18084-exec-7 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:13:23.612 ttp-nio-18084-exec-7 ==> Parameters: 
09-02 15:13:23.613 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:13:23.615 ttp-nio-18084-exec-7 Scenario.selectMaxScenarioNo
09-02 15:13:23.615 ttp-nio-18084-exec-7 ==>  Preparing: SELECT coalesce(max(scenario_no),0) + 1 FROM nvscenario 
09-02 15:13:23.615 ttp-nio-18084-exec-7 ==> Parameters: 
09-02 15:13:23.616 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:13:23.617 ttp-nio-18084-exec-7 Scenario.insertScenario1StepInfo
09-02 15:13:23.617 ttp-nio-18084-exec-7 ==>  Preparing: INSERT INTO nvscenario (scenario_no, user_id, grp_cd, scenario_nm, scenario_desc, scenario_type, create_dt, create_tm, lastupdate_dt, lastupdate_tm, tag_no, finish_yn, handler_type) VALUES (?, ?, ?, ?, ?, 'M', ?, ?, ?, ?, ?, 'N', ?) 
09-02 15:13:23.617 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer), admin(String), 01(String), ㅊㄱㅌ(String), (String), 20210902(String), 151323(String), 20210902(String), 151323(String), 1(Integer), G(String)
09-02 15:13:23.619 ttp-nio-18084-exec-7 <==    Updates: 1
09-02 15:13:23.620 ttp-nio-18084-exec-7 Campaign.selectNextCampaignNo
09-02 15:13:23.620 ttp-nio-18084-exec-7 ==>  Preparing: SELECT coalesce(max(campaign_no),0)+1 FROM nvcampaign 
09-02 15:13:23.620 ttp-nio-18084-exec-7 ==> Parameters: 
09-02 15:13:23.621 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:13:23.623 ttp-nio-18084-exec-7 Campaign.insertCampaign1StepInfo
09-02 15:13:23.623 ttp-nio-18084-exec-7 ==>  Preparing: INSERT INTO nvcampaign ( campaign_no, grp_cd, user_id, segment_no, campaign_nm, campaign_sts, create_dt, create_tm, lastupdate_dt, campaign_type , sending_mode, retry_cnt, campaign_class, channel_type, relation_type, campaign_level, scenario_no, req_dept_id, req_user_id, ab_test_type ) VALUES ( ?, ?, ?, NULL , ?, 'I', ?, ?, ?, 'Y' , 'P', ?, 'A', ?, coalesce(?, 'N'), '1', ?, ?, ?, ? ) 
09-02 15:13:23.623 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer), 01(String), admin(String), ㅊㄱㅌ(String), 20210902(String), 151323(String), 20210902(String), 1(Integer), C(String), null, 32(Integer), (String), admin(String), N(String)
09-02 15:13:23.637 ttp-nio-18084-exec-7 <==    Updates: 1
09-02 15:13:23.638 ttp-nio-18084-exec-7 Schedule.insertCamSchedule1StepInfo!selectKey
09-02 15:13:23.638 ttp-nio-18084-exec-7 ==>  Preparing: SELECT coalesce(max(schedule_seq),0)+1 as scheduleSeq FROM nvschedule WHERE scenario_no = ? 
09-02 15:13:23.638 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer)
09-02 15:13:23.651 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:13:23.651 ttp-nio-18084-exec-7 Schedule.insertCamSchedule1StepInfo
09-02 15:13:23.651 ttp-nio-18084-exec-7 ==>  Preparing: INSERT INTO nvschedule (scenario_no, schedule_seq, campaign_no, supracampaign_no, campaign_dt) VALUES( ?, ?, ?, 0, ?) 
09-02 15:13:23.651 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer), 1(Integer), 32(Integer), 20210902(String)
09-02 15:13:23.653 ttp-nio-18084-exec-7 <==    Updates: 1
09-02 15:13:23.653 ttp-nio-18084-exec-7 TraceInfo.insertCamTraceInfo1StepInfo
09-02 15:13:23.653 ttp-nio-18084-exec-7 ==>  Preparing: INSERT INTO nvtraceinfo (campaign_no, trace_type) VALUES(?, ?) 
09-02 15:13:23.653 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer), TRACE(String)
09-02 15:13:23.656 ttp-nio-18084-exec-7 <==    Updates: 1
09-02 15:13:23.663 ttp-nio-18084-exec-4 Campaign.getScenarioChannelInfo
09-02 15:13:23.663 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:13:23.663 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer)
09-02 15:13:23.663 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:13:23.664 ttp-nio-18084-exec-4 Scenario.selectScenarioDetailInfo
09-02 15:13:23.664 ttp-nio-18084-exec-4 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:13:23.664 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer), 32(Integer)
09-02 15:13:23.665 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:13:23.665 ttp-nio-18084-exec-4 Campaign.selectCampaignSenderTel
09-02 15:13:23.665 ttp-nio-18084-exec-4 ==>  Preparing: SELECT sender_tel FROM nvcampaign WHERE campaign_no IN ( SELECT max(campaign_no) FROM nvcampaign WHERE scenario_no IN ( SELECT scenario_no FROM nvscenario WHERE user_id = ? AND grp_cd = ? AND tag_no = ? ) AND channel_type = ? AND sender_tel IS NOT NULL ) 
09-02 15:13:23.665 ttp-nio-18084-exec-4 ==> Parameters: admin(String), 01(String), 1(Integer), C(String)
09-02 15:13:23.666 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:13:23.667 ttp-nio-18084-exec-4 TraceInfo.selectTraceInfo
09-02 15:13:23.667 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:13:23.667 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer)
09-02 15:13:23.667 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:13:23.668 ttp-nio-18084-exec-4 ServerInfo.selectServerInfo
09-02 15:13:23.668 ttp-nio-18084-exec-4 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:13:23.668 ttp-nio-18084-exec-4 ==> Parameters: 
09-02 15:13:23.669 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:13:23.670 ttp-nio-18084-exec-4 KakaoProfile.selectKakaoProfileList
09-02 15:13:23.670 ttp-nio-18084-exec-4 ==>  Preparing: SELECT user_id, kakao_sender_key, kakao_yellow_id, last_sync_dtm FROM nvkakaoprofile WHERE user_id = ? 
09-02 15:13:23.670 ttp-nio-18084-exec-4 ==> Parameters: admin(String)
09-02 15:13:23.684 ttp-nio-18084-exec-4 <==      Total: 0
09-02 15:13:27.992 ttp-nio-18084-exec-4 Campaign.selectEditorCampaign
09-02 15:13:27.992 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:13:27.993 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer)
09-02 15:13:27.994 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:13:28.020 ttp-nio-18084-exec-3 MobileContents.selectEditorMmsContentsListMax
09-02 15:13:28.020 ttp-nio-18084-exec-3 ==>  Preparing: SELECT count(*) FROM nvmobilecontents WHERE file_type = ? 
09-02 15:13:28.021 ttp-nio-18084-exec-3 ==> Parameters: C(String)
09-02 15:13:28.023 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:13:28.026 ttp-nio-18084-exec-3 MobileContents.selectEditorMmsContentsList
09-02 15:13:28.026 ttp-nio-18084-exec-3 ==>  Preparing: SELECT user_id, conts_no, conts_nm, file_path, file_name, file_type, conts_txt, file_preview_path, file_preview_name, file_size , to_char(to_date(create_dt,'YYYYMMDD'),'YYYY-MM-DD') as create_dt, to_char(to_date(create_tm,'HH24MISS'),'HH:MI:SS') as create_tm FROM ( SELECT row_number() OVER (ORDER BY conts_no DESC) as rnum , user_id, conts_no, conts_nm, file_path, file_name, file_type, conts_txt, file_preview_path, file_preview_name, file_size , create_dt, create_tm FROM nvmobilecontents WHERE file_type = ? ORDER BY conts_no DESC ) a WHERE rnum BETWEEN ? AND ? 
09-02 15:13:28.027 ttp-nio-18084-exec-3 ==> Parameters: C(String), 1(Integer), 6(Integer)
09-02 15:13:28.031 ttp-nio-18084-exec-6 Campaign.selectEditorCampaign
09-02 15:13:28.031 ttp-nio-18084-exec-6 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:13:28.032 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:13:28.034 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:13:28.034 ttp-nio-18084-exec-3 <==      Total: 0
09-02 15:13:28.036 ttp-nio-18084-exec-6 DefaultHandler.selectHandlerUseList
09-02 15:13:28.036 ttp-nio-18084-exec-6 ==>  Preparing: SELECT seq, handle_nm, handle_desc FROM nvdefaulthandler c WHERE EXISTS ( SELECT 0 FROM nvcampaign a, nvscenario b WHERE a.scenario_no = b.scenario_no AND a.channel_type = c.channel AND b.handler_type = c.handle_type AND a.campaign_no = ? AND c.service_type IS NULL AND c.ab_test_yn = (CASE a.ab_test_type WHEN 'N' THEN 'N' ELSE 'Y' END) ) ORDER BY seq 
09-02 15:13:28.036 ttp-nio-18084-exec-1 Application.selectEditorCampaignHandler
09-02 15:13:28.036 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:13:28.036 ttp-nio-18084-exec-1 ==>  Preparing: SELECT type, appsource FROM nvapplication WHERE campaign_no = ? 
09-02 15:13:28.036 ttp-nio-18084-exec-1 ==> Parameters: 32(Integer)
09-02 15:13:28.038 ttp-nio-18084-exec-1 <==      Total: 0
09-02 15:13:28.038 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:13:28.103 ttp-nio-18084-exec-7 Template.selectEditorCampaignFrtalkTemplate
09-02 15:13:28.103 ttp-nio-18084-exec-7 ==>  Preparing: SELECT a.seg, a.template, a.kakao_buttons, CASE WHEN a.seg = ' ' THEN 0 ELSE 1 END as seg_no , CASE WHEN b.kakao_image_no IS NULL THEN '' ELSE (SELECT file_preview_path FROM nvmobilecontents WHERE conts_no = b.kakao_image_no) end AS image_url FROM nvtemplate a, nvcampaign b WHERE a.campaign_no = b.campaign_no AND b.campaign_no = ? ORDER BY seg_no 
09-02 15:13:28.103 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer)
09-02 15:13:28.103 ttp-nio-18084-exec-4 Semantic.selectSemanticListBySegmentNo
09-02 15:13:28.103 ttp-nio-18084-exec-4 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:13:28.104 ttp-nio-18084-exec-4 ==> Parameters: 0(Integer)
09-02 15:13:28.105 ttp-nio-18084-exec-4 <==      Total: 0
09-02 15:13:28.109 ttp-nio-18084-exec-7 <==      Total: 0
09-02 15:13:28.961 ttp-nio-18084-exec-1 DefaultHandler.selectDefaultHandler
09-02 15:13:28.962 ttp-nio-18084-exec-1 ==>  Preparing: SELECT seq, handle_nm, handle_desc, service_type, channel, handle_attr, handle_type, user_id , to_char(to_date(create_dt, 'YYYY-MM-DD'),'YYYY-MM-DD') create_dt, to_char(to_date(create_tm, 'HH24:MI:SS'),'HH24:MI:SS') create_tm , handler, ab_test_yn, msg_type, 0 as total_rows FROM nvdefaulthandler WHERE seq = ? 
09-02 15:13:28.962 ttp-nio-18084-exec-1 ==> Parameters: 3(Integer)
09-02 15:13:29.021 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:14:26.769 ttp-nio-18084-exec-6 Campaign.getScenarioChannelInfo
09-02 15:14:26.769 ttp-nio-18084-exec-6 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:14:26.769 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:14:26.769 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:26.770 ttp-nio-18084-exec-6 Scenario.selectScenarioDetailInfo
09-02 15:14:26.770 ttp-nio-18084-exec-6 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:14:26.770 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer), 32(Integer)
09-02 15:14:26.771 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:26.771 ttp-nio-18084-exec-6 Campaign.selectCampaignSenderTel
09-02 15:14:26.771 ttp-nio-18084-exec-6 ==>  Preparing: SELECT sender_tel FROM nvcampaign WHERE campaign_no IN ( SELECT max(campaign_no) FROM nvcampaign WHERE scenario_no IN ( SELECT scenario_no FROM nvscenario WHERE user_id = ? AND grp_cd = ? AND tag_no = ? ) AND channel_type = ? AND sender_tel IS NOT NULL ) 
09-02 15:14:26.772 ttp-nio-18084-exec-6 ==> Parameters: admin(String), 01(String), 1(Integer), C(String)
09-02 15:14:26.773 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:26.773 ttp-nio-18084-exec-6 TraceInfo.selectTraceInfo
09-02 15:14:26.773 ttp-nio-18084-exec-6 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:14:26.773 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:14:26.774 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:26.774 ttp-nio-18084-exec-6 ServerInfo.selectServerInfo
09-02 15:14:26.774 ttp-nio-18084-exec-6 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:14:26.774 ttp-nio-18084-exec-6 ==> Parameters: 
09-02 15:14:26.779 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:26.780 ttp-nio-18084-exec-6 KakaoProfile.selectKakaoProfileList
09-02 15:14:26.780 ttp-nio-18084-exec-6 ==>  Preparing: SELECT user_id, kakao_sender_key, kakao_yellow_id, last_sync_dtm FROM nvkakaoprofile WHERE user_id = ? 
09-02 15:14:26.780 ttp-nio-18084-exec-6 ==> Parameters: admin(String)
09-02 15:14:26.781 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:27.575 ttp-nio-18084-exec-7 Campaign.selectEditorCampaign
09-02 15:14:27.575 ttp-nio-18084-exec-7 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:14:27.575 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer)
09-02 15:14:27.576 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:14:27.578 ttp-nio-18084-exec-3 MobileContents.selectEditorMmsContentsListMax
09-02 15:14:27.578 ttp-nio-18084-exec-3 ==>  Preparing: SELECT count(*) FROM nvmobilecontents WHERE file_type = ? 
09-02 15:14:27.578 ttp-nio-18084-exec-3 ==> Parameters: C(String)
09-02 15:14:27.579 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:27.580 ttp-nio-18084-exec-3 MobileContents.selectEditorMmsContentsList
09-02 15:14:27.580 ttp-nio-18084-exec-3 ==>  Preparing: SELECT user_id, conts_no, conts_nm, file_path, file_name, file_type, conts_txt, file_preview_path, file_preview_name, file_size , to_char(to_date(create_dt,'YYYYMMDD'),'YYYY-MM-DD') as create_dt, to_char(to_date(create_tm,'HH24MISS'),'HH:MI:SS') as create_tm FROM ( SELECT row_number() OVER (ORDER BY conts_no DESC) as rnum , user_id, conts_no, conts_nm, file_path, file_name, file_type, conts_txt, file_preview_path, file_preview_name, file_size , create_dt, create_tm FROM nvmobilecontents WHERE file_type = ? ORDER BY conts_no DESC ) a WHERE rnum BETWEEN ? AND ? 
09-02 15:14:27.581 ttp-nio-18084-exec-3 ==> Parameters: C(String), 1(Integer), 6(Integer)
09-02 15:14:27.582 ttp-nio-18084-exec-3 <==      Total: 0
09-02 15:14:27.602 ttp-nio-18084-exec-1 Campaign.selectEditorCampaign
09-02 15:14:27.603 ttp-nio-18084-exec-1 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:14:27.603 ttp-nio-18084-exec-6 Application.selectEditorCampaignHandler
09-02 15:14:27.603 ttp-nio-18084-exec-6 ==>  Preparing: SELECT type, appsource FROM nvapplication WHERE campaign_no = ? 
09-02 15:14:27.603 ttp-nio-18084-exec-1 ==> Parameters: 32(Integer)
09-02 15:14:27.603 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:14:27.604 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:14:27.605 ttp-nio-18084-exec-1 DefaultHandler.selectHandlerUseList
09-02 15:14:27.605 ttp-nio-18084-exec-1 ==>  Preparing: SELECT seq, handle_nm, handle_desc FROM nvdefaulthandler c WHERE EXISTS ( SELECT 0 FROM nvcampaign a, nvscenario b WHERE a.scenario_no = b.scenario_no AND a.channel_type = c.channel AND b.handler_type = c.handle_type AND a.campaign_no = ? AND c.service_type IS NULL AND c.ab_test_yn = (CASE a.ab_test_type WHEN 'N' THEN 'N' ELSE 'Y' END) ) ORDER BY seq 
09-02 15:14:27.605 ttp-nio-18084-exec-6 <==      Total: 0
09-02 15:14:27.606 ttp-nio-18084-exec-1 ==> Parameters: 32(Integer)
09-02 15:14:27.607 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:14:27.959 ttp-nio-18084-exec-4 DefaultHandler.selectDefaultHandler
09-02 15:14:27.959 ttp-nio-18084-exec-4 ==>  Preparing: SELECT seq, handle_nm, handle_desc, service_type, channel, handle_attr, handle_type, user_id , to_char(to_date(create_dt, 'YYYY-MM-DD'),'YYYY-MM-DD') create_dt, to_char(to_date(create_tm, 'HH24:MI:SS'),'HH24:MI:SS') create_tm , handler, ab_test_yn, msg_type, 0 as total_rows FROM nvdefaulthandler WHERE seq = ? 
09-02 15:14:27.959 ttp-nio-18084-exec-4 ==> Parameters: 3(Integer)
09-02 15:14:27.960 ttp-nio-18084-exec-6 Semantic.selectSemanticListBySegmentNo
09-02 15:14:27.960 ttp-nio-18084-exec-6 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:14:27.961 ttp-nio-18084-exec-7 Template.selectEditorCampaignFrtalkTemplate
09-02 15:14:27.961 ttp-nio-18084-exec-6 ==> Parameters: 0(Integer)
09-02 15:14:27.961 ttp-nio-18084-exec-7 ==>  Preparing: SELECT a.seg, a.template, a.kakao_buttons, CASE WHEN a.seg = ' ' THEN 0 ELSE 1 END as seg_no , CASE WHEN b.kakao_image_no IS NULL THEN '' ELSE (SELECT file_preview_path FROM nvmobilecontents WHERE conts_no = b.kakao_image_no) end AS image_url FROM nvtemplate a, nvcampaign b WHERE a.campaign_no = b.campaign_no AND b.campaign_no = ? ORDER BY seg_no 
09-02 15:14:27.961 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer)
09-02 15:14:27.961 ttp-nio-18084-exec-6 <==      Total: 0
09-02 15:14:27.961 ttp-nio-18084-exec-7 <==      Total: 0
09-02 15:14:27.962 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:14:29.399 ttp-nio-18084-exec-3 Segment.selectBookmarkListTotalCount
09-02 15:14:29.399 ttp-nio-18084-exec-3 ==>  Preparing: SELECT count(*) FROM nvsegment a, nvsegmenttag b, nvuser c, ( SELECT segment_no FROM nvsemantic WHERE field_key = ? ) d WHERE a.tag_no = b.tag_no AND a.user_id = c.user_id AND a.segment_no = d.segment_no AND a.segment_type = 'N' AND (a.active_yn = 'Y' OR a.active_yn IS NULL) AND seg_type = ? 
09-02 15:14:29.399 ttp-nio-18084-exec-3 ==> Parameters: S(String), F(String)
09-02 15:14:29.401 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:29.403 ttp-nio-18084-exec-3 Segment.selectBookmarkList
09-02 15:14:29.403 ttp-nio-18084-exec-3 ==>  Preparing: SELECT * FROM ( SELECT row_number() OVER (ORDER BY a.segment_no DESC) as rnum , a.segment_no, a.segment_nm, a.segment_size, a.filetodb_yn, a.lastupdate_dt, a.seg_type, b.tag_nm, c.name_kor FROM nvsegment a, nvsegmenttag b, nvuser c, ( SELECT segment_no FROM nvsemantic WHERE field_key = ? ) d WHERE a.tag_no = b.tag_no AND a.user_id = c.user_id AND a.segment_no = d.segment_no AND a.segment_type = 'N' AND (a.active_yn = 'Y' OR a.active_yn IS NULL) AND seg_type = ? ORDER BY a.segment_no DESC ) e WHERE rnum >= ? AND rnum <= ? 
09-02 15:14:29.404 ttp-nio-18084-exec-3 ==> Parameters: S(String), F(String), 1(Integer), 10(Integer)
09-02 15:14:29.409 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:30.822 ttp-nio-18084-exec-6 Semantic.selectSemanticListBySegmentNo
09-02 15:14:30.822 ttp-nio-18084-exec-6 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:14:30.822 ttp-nio-18084-exec-6 ==> Parameters: 8(Integer)
09-02 15:14:30.823 ttp-nio-18084-exec-6 <==      Total: 5
09-02 15:14:33.314 ttp-nio-18084-exec-7 Campaign.updateEditorCampaign
09-02 15:14:33.314 ttp-nio-18084-exec-7 ==>  Preparing: UPDATE nvcampaign SET template_type = ? , campaign_preface = ? WHERE campaign_no = ? 
09-02 15:14:33.315 ttp-nio-18084-exec-7 ==> Parameters: 1(Integer), Untitled(String), 32(Integer)
09-02 15:14:33.316 ttp-nio-18084-exec-7 <==    Updates: 1
09-02 15:14:33.328 ttp-nio-18084-exec-4 Application.selectEditorCampaignHandlerCount
09-02 15:14:33.328 ttp-nio-18084-exec-4 ==>  Preparing: SELECT count(*) FROM nvapplication WHERE campaign_no = ? 
09-02 15:14:33.328 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer)
09-02 15:14:33.329 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:14:33.329 ttp-nio-18084-exec-4 Application.insertEditorCampaignHandler
09-02 15:14:33.329 ttp-nio-18084-exec-4 ==>  Preparing: INSERT INTO nvapplication (campaign_no, type, appsource) VALUES (?, ?, ?) 
09-02 15:14:33.329 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer), G(String), //***************************************************/
// 친구톡 캠페인 핸들러
//***************************************************/
import com.mnwise.ASE.agent.dbagent.DBAgent
import com.mnwise.ASE.agent.dbagent.DBConnection
import com.mnwise.ASE.agent.dbagent.DBPreparedStatement
import com.mnwise.ASE.agent.dbagent.DBRecordSet
import com.mnwise.ASE.agent.kakaoagent.TalkAgent
import com.mnwise.ASE.agent.kakaoagent.TalkData
import com.mnwise.ASE.agent.util.AseUtil
import com.mnwise.ASE.agent.util.ExceptionLogger
import com.mnwise.ASE.agent.util.TextReader
import com.mnwise.ASE.pscript.Message
import com.mnwise.ASE.pscript.ScrProperties
import com.mnwise.common.util.DateUtil
import com.mnwise.common.util.LoggerAid
import com.mnwise.common.util.Util
import com.mnwise.mts.Config

import java.text.SimpleDateFormat

boolean useResend = Config.getLstResendUse();
boolean isSendMode = "N".equals(context.get("_PREVIEW_YN"));

TalkAgent alimtalkAgent = new TalkAgent(context);
ExceptionLogger exlogger = new ExceptionLogger(context);
Date dt = new Date();
DateUtil term = new DateUtil();
SimpleDateFormat time = new SimpleDateFormat("yyyyMMddHHmmss");
addterm = term.addTime(dt,"7","00","00","00");
context.put("_START_DATE", time.format(dt));
context.put("_END_DATE", time.format(addterm));
_KEY_FIELD_SEQ = context.getInt("_KEY_FIELD_SEQ");
_NAME_FIELD_SEQ = context.getInt("_NAME_FIELD_SEQ");
_MMS_FIELD_SEQ = context.getInt("_MMS_FIELD_SEQ");
TextReader target = new TextReader(context);
Message message = new Message(context);
message.prepareGroovyTemplateWithCustomVariable("#{", "}", "<%=(record.getString(\"", "\"))%>", true)
//챗버블 개인화
message.prepareGroovyTemplateWithCustomVariable("#{", "}", "<%=(record.getString(\"", "\"))%>", true , "KAKAO_BUTTONS" , context.get("_KAKAO_BUTTONS"))

//DB커넥션 생성
DBAgent dbagent = new DBAgent(context.get("_jdbc.driver"))
DBConnection conn = dbagent.getConnection(context.get("_jdbc.url"),context.get("_jdbc.user"),context.get("_jdbc.password"))
DBRecordSet rs = null
// 핸들러 오류 로그테이블 적재 추가
DBPreparedStatement pstmt = null;

if(isSendMode) {
    pstmt = conn.prepareStatement(getMzLogQuery(useResend));
}

//변수 정의
String errMsg = null
String msg = null

TalkData ad = null
int nEcareNo = Integer.parseInt(context.get("_CAMPAIGN_NO"))
String sResultSeq = context.get("_RESULT_SEQ")
String sSenderKey = context.get("_KAKAO_SENDER_KEY")
String sTmplCd = context.get("_KAKAO_TMPL_CD")
String sSenderTel = context.get("_SENDER_TEL")
String smsSendYn = context.get("_FAILBACK_SEND_YN")
String lmsSubject = context.get("_FAILBACK_SUBJECT")

while (target.next()) {
    try {
        // 본문에서도 수신대상자의 정보를 사용할수 있도록 context객체에 담기
        context.put("record", target.getRecord())
        msg = message.execGroovyTemplate()
        ad = new TalkData();
        ad.setSenderKey(sSenderKey)
        ad.setPhoneNo(target.getString(_MMS_FIELD_SEQ))
        ad.setUserName(target.getString(_NAME_FIELD_SEQ));
        ad.setTmplCd(sTmplCd)
        ad.setSndMsg(msg)
        ad.setSmsSndNum(sSenderTel)
        ad.setReqDeptId(context.get("_REQ_DEPT_ID"))
        ad.setReqUserId(context.get("_REQ_USER_ID"))
        ad.setReqDtm(time.format(new Date()))
        ad.setServiceType(context.get("_CLIENT"));
        ad.setServiceNo(nEcareNo);
        ad.setResultSeq(Long.parseLong(sResultSeq));
        ad.setSmsSndYn(smsSendYn);
        ad.setSubject(lmsSubject);
        ad.setKakaoButton(message.execGroovyTemplate("KAKAO_BUTTONS"))

        if(useResend) {
            ad.setUserId(target.getString(_KEY_FIELD_SEQ))
        }

        alimtalkAgent.send(ad)
    } catch(Exception e) {
        context.put("_EXCEPTION", e);
        exlogger.write(target.toString(), e)
        if(isSendMode) {
            try {
                errMsg = LoggerAid.onlyOneLine(e).substring(0, 125)
                exlogger.insertSendLog(target, target.getString(_MMS_FIELD_SEQ), target.getString(_KEY_FIELD_SEQ), target.getString(_NAME_FIELD_SEQ), errMsg, target.getString(_KEY_FIELD_SEQ), context.get("_REQ_DEPT_ID"));
                insertMzLogData(pstmt, target, context, msg, errMsg, useResend);
            } catch(Exception sub_e){
                exlogger.write("insert sendlog fail", sub_e)
            }finally {
                pstmt.clearParameters();
            }
        }
    }
}   //  end While

AseUtil.closeQuietly(pstmt);
AseUtil.closeQuietly(conn);
exlogger.close()
target.close()
alimtalkAgent.close()


/**
 * 핸들러 오류 로그테이블 적재 추가 친구톡(MZFTSENDLOG)
 */
def getMzLogQuery(boolean useResend) {
    StringBuffer sb = new StringBuffer();
    sb.append(" INSERT INTO MZFTSENDLOG (")
    sb.append(" SN, SENDER_KEY, CHANNEL, PHONE_NUM, SMS_SND_NUM, ")
    sb.append(" TMPL_CD, SND_MSG, REQ_DEPT_CD, REQ_USR_ID, REQ_DTM, ")
    sb.append(" TRAN_STS, SLOT1, SLOT2, SND_DTM, RSLT_CD, RCPT_MSG, RCPT_DTM ")
    if(useResend) {
        sb.append(" , CUSTOMER_KEY, LIST_SEQ ")
    }
    sb.append(" ) VALUES (?, ?, ?, ?, ?,")
    sb.append(" ?, ?, ?, ?, ?, ")
    sb.append(" '4', ?, ?, ?, ?, ?, ? ")
    if(useResend) {
        sb.append(" , ?, ? )")
    }
    sb.append(" )")
    return sb.toString();
}

/**
 * MZFTSENDLOG 테이블에 적재
 */
def insertMzLogData(DBPreparedStatement pstmt, TextReader target, ScrProperties context, String msg, String errMsg, boolean useResend) {
    SimpleDateFormat time = new SimpleDateFormat("yyyyMMddHHmmss");
    pstmt.setString(1, String.valueOf(Util.getResultSeq()));
    pstmt.setString(2, context.get("_KAKAO_SENDER_KEY"));
    pstmt.setString(3, "C");
    pstmt.setString(4, target.getString(_MMS_FIELD_SEQ));
    pstmt.setString(5, context.get("_SENDER_TEL"));
    pstmt.setString(6, context.get("_KAKAO_TMPL_CD"));
    pstmt.setString(7, msg.substring(0,1000));
    pstmt.setString(8, context.get("_REQ_DEPT_ID"));
    pstmt.setString(9, context.get("_REQ_USER_ID"));
    pstmt.setString(10, time.format(new Date()));
    pstmt.setString(11, context.get("_CAMPAIGN_NO"));
    pstmt.setLong(12, Long.parseLong(context.get("_RESULT_SEQ")));
    pstmt.setString(13, time.format(new Date()));
    pstmt.setString(14, "9999");
    pstmt.setString(15, errMsg);
    pstmt.setString(16, time.format(new Date()));
    if(useResend) {
        pstmt.setString(17, target.getString(_KEY_FIELD_SEQ));
        pstmt.setString(18, Util.format(target.getSeq(), 10,(char) '0'));
    }
    pstmt.executeUpdate();
}
(String)
09-02 15:14:33.360 ttp-nio-18084-exec-4 <==    Updates: 1
09-02 15:14:33.369 ttp-nio-18084-exec-1 Semantic.selectSemanticListBySegmentNo
09-02 15:14:33.369 ttp-nio-18084-exec-1 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:14:33.369 ttp-nio-18084-exec-1 ==> Parameters: 8(Integer)
09-02 15:14:33.370 ttp-nio-18084-exec-1 <==      Total: 5
09-02 15:14:33.372 ttp-nio-18084-exec-1 Template.selectEditorCampaignTemplateCount
09-02 15:14:33.372 ttp-nio-18084-exec-1 ==>  Preparing: SELECT count(*) FROM nvtemplate WHERE campaign_no = ? AND seg = ? 
09-02 15:14:33.372 ttp-nio-18084-exec-1 ==> Parameters: 32(Integer),  (String)
09-02 15:14:33.372 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:14:33.373 ttp-nio-18084-exec-1 Template.insertEditorCampaignTemplate
09-02 15:14:33.373 ttp-nio-18084-exec-1 ==>  Preparing: INSERT INTO nvtemplate (campaign_no, seg, template) VALUES (?, ?, ?) 
09-02 15:14:33.373 ttp-nio-18084-exec-1 ==> Parameters: 32(Integer),  (String), <%com.mnwise.ASE.agent.util.TextReader record=context.get("record")%>ㅅㅈㄷㅅ(String)
09-02 15:14:33.375 ttp-nio-18084-exec-1 <==    Updates: 1
09-02 15:14:33.376 ttp-nio-18084-exec-1 Template.updateCampaignKakaoButtons
09-02 15:14:33.376 ttp-nio-18084-exec-1 ==>  Preparing: UPDATE nvtemplate SET kakao_buttons = ? WHERE campaign_no = ? AND seg = ? 
09-02 15:14:33.376 ttp-nio-18084-exec-1 ==> Parameters:  (String), 32(Integer),  (String)
09-02 15:14:33.378 ttp-nio-18084-exec-1 <==    Updates: 1
09-02 15:14:33.400 ttp-nio-18084-exec-3 Campaign.getScenarioChannelInfo
09-02 15:14:33.401 ttp-nio-18084-exec-3 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:14:33.401 ttp-nio-18084-exec-3 ==> Parameters: 32(Integer)
09-02 15:14:33.401 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:33.403 ttp-nio-18084-exec-3 Scenario.selectScenarioDetailInfo
09-02 15:14:33.403 ttp-nio-18084-exec-3 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:14:33.403 ttp-nio-18084-exec-3 ==> Parameters: 32(Integer), 32(Integer)
09-02 15:14:33.404 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:33.405 ttp-nio-18084-exec-3 Campaign.selectCampaignSenderTel
09-02 15:14:33.405 ttp-nio-18084-exec-3 ==>  Preparing: SELECT sender_tel FROM nvcampaign WHERE campaign_no IN ( SELECT max(campaign_no) FROM nvcampaign WHERE scenario_no IN ( SELECT scenario_no FROM nvscenario WHERE user_id = ? AND grp_cd = ? AND tag_no = ? ) AND channel_type = ? AND sender_tel IS NOT NULL ) 
09-02 15:14:33.406 ttp-nio-18084-exec-3 ==> Parameters: admin(String), 01(String), 1(Integer), C(String)
09-02 15:14:33.407 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:33.408 ttp-nio-18084-exec-3 TraceInfo.selectTraceInfo
09-02 15:14:33.408 ttp-nio-18084-exec-3 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:14:33.408 ttp-nio-18084-exec-3 ==> Parameters: 32(Integer)
09-02 15:14:33.409 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:33.411 ttp-nio-18084-exec-3 ServerInfo.selectServerInfo
09-02 15:14:33.411 ttp-nio-18084-exec-3 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:14:33.411 ttp-nio-18084-exec-3 ==> Parameters: 
09-02 15:14:33.412 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:33.412 ttp-nio-18084-exec-3 Scenario.updateScenario2StepInfo
09-02 15:14:33.412 ttp-nio-18084-exec-3 ==>  Preparing: UPDATE nvscenario SET lastupdate_dt = ? , lastupdate_tm = ? , finish_yn = ? , finish_dt = ? WHERE scenario_no = ? 
09-02 15:14:33.412 ttp-nio-18084-exec-3 ==> Parameters: 20210902(String), 151433(String), N(String), null, 32(Integer)
09-02 15:14:33.413 ttp-nio-18084-exec-3 <==    Updates: 1
09-02 15:14:33.414 ttp-nio-18084-exec-3 Campaign.updateCampaign2StepInfo
09-02 15:14:33.415 ttp-nio-18084-exec-3 ==>  Preparing: UPDATE nvcampaign SET grp_cd = ? , user_id = ? , segment_no = ? , campaign_nm = ? , campaign_desc = ? , lastupdate_dt = ? , lastupdate_tm = ? , campaign_type = ? , sending_sts = ? , sending_cycle = ? , target_cnt = ? , survey_end_yn = ? , survey_response_cnt = ? , survey_start_dt = ? , survey_start_tm = ? , survey_end_dt = ? , survey_end_tm = ? , retry_cnt = ? , sender_nm = ? , sender_email = ? , receiver_nm = ? , sender_tel = ? , retmail_receiver = ? , campaign_class = ? , relation_type = ? , campaign_level = ? , editor_id = ? , approval_sts = ? , kakao_sender_key = ? , kakao_image_no = ? , failback_send_yn = ? , failback_subject = '' WHERE campaign_no = ? 
09-02 15:14:33.415 ttp-nio-18084-exec-3 ==> Parameters: 01(String), admin(String), 8(Integer), ㅊㄱㅌ(String), null, 20210902(String), 151433(String), Y(String), null, null, 2(Integer), null, 0(Integer), null, null, null, null, 1(Integer), (String), null, null, 0286545210(String), null, A(String), N(String), 3(String), null, null, kakao(String), 0(Integer), N(String), 32(Integer)
09-02 15:14:33.417 ttp-nio-18084-exec-3 <==    Updates: 1
09-02 15:14:33.417 ttp-nio-18084-exec-3 TraceInfo.selectTraceInfoCnt
09-02 15:14:33.417 ttp-nio-18084-exec-3 ==>  Preparing: SELECT count(*) FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:14:33.417 ttp-nio-18084-exec-3 ==> Parameters: 32(Integer)
09-02 15:14:33.418 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:33.418 ttp-nio-18084-exec-3 TraceInfo.updateTraceInfo
09-02 15:14:33.419 ttp-nio-18084-exec-3 ==>  Preparing: UPDATE nvtraceinfo SET start_dt = ? , start_tm = ? , end_dt = ? , end_tm = ? WHERE campaign_no = ? 
09-02 15:14:33.419 ttp-nio-18084-exec-3 ==> Parameters: 20210902(String), 151400(String), 20210909(String), 235959(String), 32(Integer)
09-02 15:14:33.420 ttp-nio-18084-exec-3 <==    Updates: 1
09-02 15:14:33.431 ttp-nio-18084-exec-6 Campaign.getScenarioChannelInfo
09-02 15:14:33.431 ttp-nio-18084-exec-6 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:14:33.431 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:14:33.432 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:33.432 ttp-nio-18084-exec-6 Scenario.selectScenarioDetailInfo
09-02 15:14:33.433 ttp-nio-18084-exec-6 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:14:33.433 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer), 32(Integer)
09-02 15:14:33.434 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:33.435 ttp-nio-18084-exec-6 TraceInfo.selectTraceInfo
09-02 15:14:33.436 ttp-nio-18084-exec-6 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:14:33.436 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:14:33.437 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:33.439 ttp-nio-18084-exec-6 ServerInfo.selectServerInfo
09-02 15:14:33.439 ttp-nio-18084-exec-6 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:14:33.440 ttp-nio-18084-exec-6 ==> Parameters: 
09-02 15:14:33.441 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:33.442 ttp-nio-18084-exec-6 KakaoProfile.selectKakaoProfileList
09-02 15:14:33.442 ttp-nio-18084-exec-6 ==>  Preparing: SELECT user_id, kakao_sender_key, kakao_yellow_id, last_sync_dtm FROM nvkakaoprofile WHERE user_id = ? 
09-02 15:14:33.442 ttp-nio-18084-exec-6 ==> Parameters: admin(String)
09-02 15:14:33.443 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:33.444 ttp-nio-18084-exec-6 Template.selectCampaignKakaoButtons
09-02 15:14:33.444 ttp-nio-18084-exec-6 ==>  Preparing: SELECT kakao_buttons FROM nvtemplate WHERE campaign_no = ? AND seg = ' ' 
09-02 15:14:33.444 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:14:33.445 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:34.098 ttp-nio-18084-exec-4 Campaign.selectEditorCampaign
09-02 15:14:34.098 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:14:34.098 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer)
09-02 15:14:34.099 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:14:34.099 ttp-nio-18084-exec-1 MobileContents.selectEditorMmsContentsListMax
09-02 15:14:34.100 ttp-nio-18084-exec-1 ==>  Preparing: SELECT count(*) FROM nvmobilecontents WHERE file_type = ? 
09-02 15:14:34.100 ttp-nio-18084-exec-1 ==> Parameters: C(String)
09-02 15:14:34.100 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:14:34.101 ttp-nio-18084-exec-1 MobileContents.selectEditorMmsContentsList
09-02 15:14:34.102 ttp-nio-18084-exec-1 ==>  Preparing: SELECT user_id, conts_no, conts_nm, file_path, file_name, file_type, conts_txt, file_preview_path, file_preview_name, file_size , to_char(to_date(create_dt,'YYYYMMDD'),'YYYY-MM-DD') as create_dt, to_char(to_date(create_tm,'HH24MISS'),'HH:MI:SS') as create_tm FROM ( SELECT row_number() OVER (ORDER BY conts_no DESC) as rnum , user_id, conts_no, conts_nm, file_path, file_name, file_type, conts_txt, file_preview_path, file_preview_name, file_size , create_dt, create_tm FROM nvmobilecontents WHERE file_type = ? ORDER BY conts_no DESC ) a WHERE rnum BETWEEN ? AND ? 
09-02 15:14:34.102 ttp-nio-18084-exec-1 ==> Parameters: C(String), 1(Integer), 6(Integer)
09-02 15:14:34.103 ttp-nio-18084-exec-1 <==      Total: 0
09-02 15:14:34.121 ttp-nio-18084-exec-3 Campaign.selectEditorCampaign
09-02 15:14:34.121 ttp-nio-18084-exec-3 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:14:34.122 ttp-nio-18084-exec-3 ==> Parameters: 32(Integer)
09-02 15:14:34.122 ttp-nio-18084-exec-6 Application.selectEditorCampaignHandler
09-02 15:14:34.122 ttp-nio-18084-exec-6 ==>  Preparing: SELECT type, appsource FROM nvapplication WHERE campaign_no = ? 
09-02 15:14:34.122 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:14:34.122 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:34.123 ttp-nio-18084-exec-3 DefaultHandler.selectHandlerUseList
09-02 15:14:34.123 ttp-nio-18084-exec-3 ==>  Preparing: SELECT seq, handle_nm, handle_desc FROM nvdefaulthandler c WHERE EXISTS ( SELECT 0 FROM nvcampaign a, nvscenario b WHERE a.scenario_no = b.scenario_no AND a.channel_type = c.channel AND b.handler_type = c.handle_type AND a.campaign_no = ? AND c.service_type IS NULL AND c.ab_test_yn = (CASE a.ab_test_type WHEN 'N' THEN 'N' ELSE 'Y' END) ) ORDER BY seq 
09-02 15:14:34.124 ttp-nio-18084-exec-3 ==> Parameters: 32(Integer)
09-02 15:14:34.125 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:14:34.125 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:14:34.229 ttp-nio-18084-exec-7 Template.selectEditorCampaignFrtalkTemplate
09-02 15:14:34.229 ttp-nio-18084-exec-7 ==>  Preparing: SELECT a.seg, a.template, a.kakao_buttons, CASE WHEN a.seg = ' ' THEN 0 ELSE 1 END as seg_no , CASE WHEN b.kakao_image_no IS NULL THEN '' ELSE (SELECT file_preview_path FROM nvmobilecontents WHERE conts_no = b.kakao_image_no) end AS image_url FROM nvtemplate a, nvcampaign b WHERE a.campaign_no = b.campaign_no AND b.campaign_no = ? ORDER BY seg_no 
09-02 15:14:34.229 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer)
09-02 15:14:34.229 ttp-nio-18084-exec-4 Semantic.selectSemanticListBySegmentNo
09-02 15:14:34.230 ttp-nio-18084-exec-4 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:14:34.230 ttp-nio-18084-exec-4 ==> Parameters: 8(Integer)
09-02 15:14:34.230 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:14:34.230 ttp-nio-18084-exec-4 <==      Total: 5
09-02 15:14:34.232 ttp-nio-18084-exec-7 Semantic.selectSemanticListBySegmentNo
09-02 15:14:34.232 ttp-nio-18084-exec-7 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:14:34.232 ttp-nio-18084-exec-7 ==> Parameters: 8(Integer)
09-02 15:14:34.233 ttp-nio-18084-exec-7 <==      Total: 5
09-02 15:15:12.200 ttp-nio-18084-exec-3 Campaign.updateEditorCampaign
09-02 15:15:12.200 ttp-nio-18084-exec-3 ==>  Preparing: UPDATE nvcampaign SET template_type = ? , campaign_preface = ? WHERE campaign_no = ? 
09-02 15:15:12.200 ttp-nio-18084-exec-3 ==> Parameters: 1(Integer), Untitled(String), 32(Integer)
09-02 15:15:12.201 ttp-nio-18084-exec-3 <==    Updates: 1
09-02 15:15:12.216 ttp-nio-18084-exec-6 Application.selectEditorCampaignHandlerCount
09-02 15:15:12.216 ttp-nio-18084-exec-6 ==>  Preparing: SELECT count(*) FROM nvapplication WHERE campaign_no = ? 
09-02 15:15:12.216 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:15:12.217 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:15:12.217 ttp-nio-18084-exec-6 Application.updateEditorCampaignHandler
09-02 15:15:12.217 ttp-nio-18084-exec-6 ==>  Preparing: UPDATE nvapplication SET appsource = ? WHERE campaign_no = ? 
09-02 15:15:12.218 ttp-nio-18084-exec-6 ==> Parameters: //***************************************************/
// 친구톡 캠페인 핸들러
//***************************************************/
import com.mnwise.ASE.agent.dbagent.DBAgent
import com.mnwise.ASE.agent.dbagent.DBConnection
import com.mnwise.ASE.agent.dbagent.DBPreparedStatement
import com.mnwise.ASE.agent.dbagent.DBRecordSet
import com.mnwise.ASE.agent.kakaoagent.TalkAgent
import com.mnwise.ASE.agent.kakaoagent.TalkData
import com.mnwise.ASE.agent.util.AseUtil
import com.mnwise.ASE.agent.util.ExceptionLogger
import com.mnwise.ASE.agent.util.TextReader
import com.mnwise.ASE.pscript.Message
import com.mnwise.ASE.pscript.ScrProperties
import com.mnwise.common.util.DateUtil
import com.mnwise.common.util.LoggerAid
import com.mnwise.common.util.Util
import com.mnwise.mts.Config

import java.text.SimpleDateFormat

boolean useResend = Config.getLstResendUse();
boolean isSendMode = "N".equals(context.get("_PREVIEW_YN"));

TalkAgent alimtalkAgent = new TalkAgent(context);
ExceptionLogger exlogger = new ExceptionLogger(context);
Date dt = new Date();
DateUtil term = new DateUtil();
SimpleDateFormat time = new SimpleDateFormat("yyyyMMddHHmmss");
addterm = term.addTime(dt,"7","00","00","00");
context.put("_START_DATE", time.format(dt));
context.put("_END_DATE", time.format(addterm));
_KEY_FIELD_SEQ = context.getInt("_KEY_FIELD_SEQ");
_NAME_FIELD_SEQ = context.getInt("_NAME_FIELD_SEQ");
_MMS_FIELD_SEQ = context.getInt("_MMS_FIELD_SEQ");
TextReader target = new TextReader(context);
Message message = new Message(context);
message.prepareGroovyTemplateWithCustomVariable("#{", "}", "<%=(record.getString(\"", "\"))%>", true)
//챗버블 개인화
message.prepareGroovyTemplateWithCustomVariable("#{", "}", "<%=(record.getString(\"", "\"))%>", true , "KAKAO_BUTTONS" , context.get("_KAKAO_BUTTONS"))

//DB커넥션 생성
DBAgent dbagent = new DBAgent(context.get("_jdbc.driver"))
DBConnection conn = dbagent.getConnection(context.get("_jdbc.url"),context.get("_jdbc.user"),context.get("_jdbc.password"))
DBRecordSet rs = null
// 핸들러 오류 로그테이블 적재 추가
DBPreparedStatement pstmt = null;

if(isSendMode) {
    pstmt = conn.prepareStatement(getMzLogQuery(useResend));
}

//변수 정의
String errMsg = null
String msg = null

TalkData ad = null
int nEcareNo = Integer.parseInt(context.get("_CAMPAIGN_NO"))
String sResultSeq = context.get("_RESULT_SEQ")
String sSenderKey = context.get("_KAKAO_SENDER_KEY")
String sTmplCd = context.get("_KAKAO_TMPL_CD")
String sSenderTel = context.get("_SENDER_TEL")
String smsSendYn = context.get("_FAILBACK_SEND_YN")
String lmsSubject = context.get("_FAILBACK_SUBJECT")

while (target.next()) {
    try {
        // 본문에서도 수신대상자의 정보를 사용할수 있도록 context객체에 담기
        context.put("record", target.getRecord())
        msg = message.execGroovyTemplate()
        ad = new TalkData();
        ad.setSenderKey(sSenderKey)
        ad.setPhoneNo(target.getString(_MMS_FIELD_SEQ))
        ad.setUserName(target.getString(_NAME_FIELD_SEQ));
        ad.setTmplCd(sTmplCd)
        ad.setSndMsg(msg)
        ad.setSmsSndNum(sSenderTel)
        ad.setReqDeptId(context.get("_REQ_DEPT_ID"))
        ad.setReqUserId(context.get("_REQ_USER_ID"))
        ad.setReqDtm(time.format(new Date()))
        ad.setServiceType(context.get("_CLIENT"));
        ad.setServiceNo(nEcareNo);
        ad.setResultSeq(Long.parseLong(sResultSeq));
        ad.setSmsSndYn(smsSendYn);
        ad.setSubject(lmsSubject);
        ad.setKakaoButton(message.execGroovyTemplate("KAKAO_BUTTONS"))

        if(useResend) {
            ad.setUserId(target.getString(_KEY_FIELD_SEQ))
        }

        alimtalkAgent.send(ad)
    } catch(Exception e) {
        context.put("_EXCEPTION", e);
        exlogger.write(target.toString(), e)
        if(isSendMode) {
            try {
                errMsg = LoggerAid.onlyOneLine(e).substring(0, 125)
                exlogger.insertSendLog(target, target.getString(_MMS_FIELD_SEQ), target.getString(_KEY_FIELD_SEQ), target.getString(_NAME_FIELD_SEQ), errMsg, target.getString(_KEY_FIELD_SEQ), context.get("_REQ_DEPT_ID"));
                insertMzLogData(pstmt, target, context, msg, errMsg, useResend);
            } catch(Exception sub_e){
                exlogger.write("insert sendlog fail", sub_e)
            }finally {
                pstmt.clearParameters();
            }
        }
    }
}   //  end While

AseUtil.closeQuietly(pstmt);
AseUtil.closeQuietly(conn);
exlogger.close()
target.close()
alimtalkAgent.close()


/**
 * 핸들러 오류 로그테이블 적재 추가 친구톡(MZFTSENDLOG)
 */
def getMzLogQuery(boolean useResend) {
    StringBuffer sb = new StringBuffer();
    sb.append(" INSERT INTO MZFTSENDLOG (")
    sb.append(" SN, SENDER_KEY, CHANNEL, PHONE_NUM, SMS_SND_NUM, ")
    sb.append(" TMPL_CD, SND_MSG, REQ_DEPT_CD, REQ_USR_ID, REQ_DTM, ")
    sb.append(" TRAN_STS, SLOT1, SLOT2, SND_DTM, RSLT_CD, RCPT_MSG, RCPT_DTM ")
    if(useResend) {
        sb.append(" , CUSTOMER_KEY, LIST_SEQ ")
    }
    sb.append(" ) VALUES (?, ?, ?, ?, ?,")
    sb.append(" ?, ?, ?, ?, ?, ")
    sb.append(" '4', ?, ?, ?, ?, ?, ? ")
    if(useResend) {
        sb.append(" , ?, ? )")
    }
    sb.append(" )")
    return sb.toString();
}

/**
 * MZFTSENDLOG 테이블에 적재
 */
def insertMzLogData(DBPreparedStatement pstmt, TextReader target, ScrProperties context, String msg, String errMsg, boolean useResend) {
    SimpleDateFormat time = new SimpleDateFormat("yyyyMMddHHmmss");
    pstmt.setString(1, String.valueOf(Util.getResultSeq()));
    pstmt.setString(2, context.get("_KAKAO_SENDER_KEY"));
    pstmt.setString(3, "C");
    pstmt.setString(4, target.getString(_MMS_FIELD_SEQ));
    pstmt.setString(5, context.get("_SENDER_TEL"));
    pstmt.setString(6, context.get("_KAKAO_TMPL_CD"));
    pstmt.setString(7, msg.substring(0,1000));
    pstmt.setString(8, context.get("_REQ_DEPT_ID"));
    pstmt.setString(9, context.get("_REQ_USER_ID"));
    pstmt.setString(10, time.format(new Date()));
    pstmt.setString(11, context.get("_CAMPAIGN_NO"));
    pstmt.setLong(12, Long.parseLong(context.get("_RESULT_SEQ")));
    pstmt.setString(13, time.format(new Date()));
    pstmt.setString(14, "9999");
    pstmt.setString(15, errMsg);
    pstmt.setString(16, time.format(new Date()));
    if(useResend) {
        pstmt.setString(17, target.getString(_KEY_FIELD_SEQ));
        pstmt.setString(18, Util.format(target.getSeq(), 10,(char) '0'));
    }
    pstmt.executeUpdate();
}
(String), 32(Integer)
09-02 15:15:12.220 ttp-nio-18084-exec-6 <==    Updates: 1
09-02 15:15:12.232 ttp-nio-18084-exec-1 Semantic.selectSemanticListBySegmentNo
09-02 15:15:12.232 ttp-nio-18084-exec-1 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:15:12.233 ttp-nio-18084-exec-1 ==> Parameters: 8(Integer)
09-02 15:15:12.233 ttp-nio-18084-exec-1 <==      Total: 5
09-02 15:15:12.234 ttp-nio-18084-exec-1 Template.selectEditorCampaignTemplateCount
09-02 15:15:12.235 ttp-nio-18084-exec-1 ==>  Preparing: SELECT count(*) FROM nvtemplate WHERE campaign_no = ? AND seg = ? 
09-02 15:15:12.235 ttp-nio-18084-exec-1 ==> Parameters: 32(Integer),  (String)
09-02 15:15:12.235 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:15:12.236 ttp-nio-18084-exec-1 Template.updateEditorCampaignTemplate
09-02 15:15:12.236 ttp-nio-18084-exec-1 ==>  Preparing: UPDATE nvtemplate SET template = ? WHERE campaign_no = ? AND seg = ? 
09-02 15:15:12.236 ttp-nio-18084-exec-1 ==> Parameters: <%com.mnwise.ASE.agent.util.TextReader record=context.get("record")%>ㅅㅈㄷㅅ(String), 32(Integer),  (String)
09-02 15:15:12.237 ttp-nio-18084-exec-1 <==    Updates: 1
09-02 15:15:12.238 ttp-nio-18084-exec-1 Template.updateCampaignKakaoButtons
09-02 15:15:12.238 ttp-nio-18084-exec-1 ==>  Preparing: UPDATE nvtemplate SET kakao_buttons = ? WHERE campaign_no = ? AND seg = ? 
09-02 15:15:12.238 ttp-nio-18084-exec-1 ==> Parameters: [{"ordering":1,"linkType":"WL","name":"테스트","linkMo":"http://naver.com","linkPc":"http://naver.com"}](String), 32(Integer),  (String)
09-02 15:15:12.239 ttp-nio-18084-exec-1 <==    Updates: 1
09-02 15:15:12.284 ttp-nio-18084-exec-4 Campaign.getScenarioChannelInfo
09-02 15:15:12.285 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:15:12.285 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer)
09-02 15:15:12.286 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:15:12.287 ttp-nio-18084-exec-4 Scenario.selectScenarioDetailInfo
09-02 15:15:12.287 ttp-nio-18084-exec-4 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:15:12.288 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer), 32(Integer)
09-02 15:15:12.289 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:15:12.290 ttp-nio-18084-exec-4 TraceInfo.selectTraceInfo
09-02 15:15:12.290 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:15:12.290 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer)
09-02 15:15:12.293 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:15:12.298 ttp-nio-18084-exec-4 ServerInfo.selectServerInfo
09-02 15:15:12.298 ttp-nio-18084-exec-4 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:15:12.299 ttp-nio-18084-exec-4 ==> Parameters: 
09-02 15:15:12.300 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:15:12.301 ttp-nio-18084-exec-4 Scenario.updateScenario2StepInfo
09-02 15:15:12.301 ttp-nio-18084-exec-4 ==>  Preparing: UPDATE nvscenario SET lastupdate_dt = ? , lastupdate_tm = ? , finish_yn = ? , finish_dt = ? WHERE scenario_no = ? 
09-02 15:15:12.301 ttp-nio-18084-exec-4 ==> Parameters: 20210902(String), 151512(String), N(String), null, 32(Integer)
09-02 15:15:12.368 ttp-nio-18084-exec-4 <==    Updates: 1
09-02 15:15:12.370 ttp-nio-18084-exec-4 Campaign.updateCampaign2StepInfo
09-02 15:15:12.370 ttp-nio-18084-exec-4 ==>  Preparing: UPDATE nvcampaign SET grp_cd = ? , user_id = ? , segment_no = ? , campaign_nm = ? , campaign_desc = ? , lastupdate_dt = ? , lastupdate_tm = ? , campaign_type = ? , sending_sts = ? , sending_cycle = ? , target_cnt = ? , survey_end_yn = ? , survey_response_cnt = ? , survey_start_dt = ? , survey_start_tm = ? , survey_end_dt = ? , survey_end_tm = ? , retry_cnt = ? , sender_nm = ? , sender_email = ? , receiver_nm = ? , sender_tel = ? , retmail_receiver = ? , campaign_class = ? , relation_type = ? , campaign_level = ? , editor_id = ? , approval_sts = ? , kakao_sender_key = ? , kakao_image_no = ? , failback_send_yn = ? , failback_subject = '' WHERE campaign_no = ? 
09-02 15:15:12.370 ttp-nio-18084-exec-4 ==> Parameters: 01(String), admin(String), 8(Integer), ㅊㄱㅌ(String), null, 20210902(String), 151512(String), Y(String), null, null, 2(Integer), null, 0(Integer), null, null, null, null, 1(Integer), (String), null, null, 0286545210(String), null, A(String), N(String), 3(String), null, null, kakao(String), 0(Integer), N(String), 32(Integer)
09-02 15:15:12.371 ttp-nio-18084-exec-4 <==    Updates: 1
09-02 15:15:12.371 ttp-nio-18084-exec-4 TraceInfo.selectTraceInfoCnt
09-02 15:15:12.371 ttp-nio-18084-exec-4 ==>  Preparing: SELECT count(*) FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:15:12.372 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer)
09-02 15:15:12.372 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:15:12.373 ttp-nio-18084-exec-4 TraceInfo.updateTraceInfo
09-02 15:15:12.373 ttp-nio-18084-exec-4 ==>  Preparing: UPDATE nvtraceinfo SET start_dt = ? , start_tm = ? , end_dt = ? , end_tm = ? WHERE campaign_no = ? 
09-02 15:15:12.373 ttp-nio-18084-exec-4 ==> Parameters: 20210902(String), 151400(String), 20210909(String), 235959(String), 32(Integer)
09-02 15:15:12.374 ttp-nio-18084-exec-4 <==    Updates: 1
09-02 15:15:12.383 ttp-nio-18084-exec-7 Campaign.getScenarioChannelInfo
09-02 15:15:12.383 ttp-nio-18084-exec-7 ==>  Preparing: SELECT campaign_no, campaign_preface, channel_type, relation_type, depth_no , (CASE channel_type WHEN 'M' THEN 4 WHEN 'S' THEN 3 WHEN 'T' THEN 2 WHEN 'F' THEN 1 END) as seq FROM nvcampaign WHERE scenario_no = ? ORDER BY seq DESC, depth_no 
09-02 15:15:12.383 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer)
09-02 15:15:12.384 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:15:12.385 ttp-nio-18084-exec-7 Scenario.selectScenarioDetailInfo
09-02 15:15:12.385 ttp-nio-18084-exec-7 ==>  Preparing: SELECT e.scenario_no, e.user_id, e.grp_cd, e.scenario_nm, e.scenario_desc, e.scenario_type, e.create_dt, e.create_tm, e.lastupdate_dt, e.lastupdate_tm , e.finish_yn, e.finish_dt, coalesce(e.tag_no,0) tag_no, e.handler_type, e.campaign_no, e.segment_no, e.campaign_nm, e.campaign_preface, e.campaign_sts, e.campaign_type , e.template_type, e.sendstart_dt, e.sendstart_tm, e.sendfinish_dt, e.sendfinish_tm, e.sending_mode, coalesce(e.retry_cnt,1) retry_cnt, e.sender_nm, e.sender_email, e.receiver_nm , e.sender_tel, e.retmail_receiver, e.campaign_class, e.channel_type, e.relation_type, e.relation_tree, e.campaign_level, e.depth_no, e.ab_test_type, e.campaign_preface_ab , coalesce(e.handler_seq,0) handler_seq, e.kakao_sender_key, e.kakao_tmpl_cd, coalesce(e.kakao_image_no,0) kakao_image_no, e.failback_send_yn, e.failback_subject, e.segment_nm, e.segment_size, e.seg_type , f.sender_nm env_sender_nm, f.sender_email env_sender_email, f.sender_tel env_sender_tel, f.receiver_nm env_receiver_nm, f.sender_fax env_sender_fax, f.receiver_fax env_receiver_fax, f.retmail_receiver env_retmail_receiver , (SELECT name_kor FROM nvuser WHERE user_id = e.user_id) name_kor , (SELECT tag_nm FROM nvcamptag WHERE tag_no = e.tag_no) tag_nm FROM ( SELECT c.*, d.segment_nm, d.segment_size, d.seg_type FROM ( SELECT a.scenario_no, a.user_id, a.grp_cd, a.scenario_nm, a.scenario_desc, a.scenario_type, a.create_dt, a.create_tm, a.lastupdate_dt, a.lastupdate_tm , a.finish_yn, a.finish_dt, a.tag_no, a.handler_type, b.campaign_no, b.segment_no, b.campaign_nm, b.campaign_preface, b.campaign_sts, b.campaign_type , b.template_type, b.sendstart_dt, b.sendstart_tm, b.sendfinish_dt, b.sendfinish_tm, b.sending_mode, b.retry_cnt, b.sender_nm, b.sender_email, b.receiver_nm , b.sender_tel, b.retmail_receiver, b.campaign_class, b.channel_type, b.relation_type, b.relation_tree, b.campaign_level, b.depth_no, b.ab_test_type, b.campaign_preface_ab , b.handler_seq, b.kakao_sender_key, b.kakao_tmpl_cd, b.kakao_image_no, b.failback_send_yn, b.failback_subject FROM nvscenario a, nvcampaign b WHERE a.scenario_no = b.scenario_no AND a.scenario_no = ? AND b.campaign_no = ? ) c LEFT OUTER JOIN nvsegment d ON c.segment_no = d.segment_no ) e LEFT OUTER JOIN nvusermailinfo f ON e.user_id = f.user_id 
09-02 15:15:12.385 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer), 32(Integer)
09-02 15:15:12.386 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:15:12.387 ttp-nio-18084-exec-7 TraceInfo.selectTraceInfo
09-02 15:15:12.387 ttp-nio-18084-exec-7 ==>  Preparing: SELECT campaign_no, trace_type, start_dt, start_tm, end_dt, end_tm FROM nvtraceinfo WHERE campaign_no = ? 
09-02 15:15:12.387 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer)
09-02 15:15:12.388 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:15:12.390 ttp-nio-18084-exec-7 ServerInfo.selectServerInfo
09-02 15:15:12.390 ttp-nio-18084-exec-7 ==>  Preparing: SELECT host_nm, port_no, driver_nm, driver_dsn, dbuser_id, dbpassword, openclick_path, survey_path, link_path, htmlmaker_path , openimage_path, duration_path, reject_path, smtp_ip, smtp_port, fula_ip, fula_port, ftp_yn, ftp_user_id, ftp_password , lastupdate_dt, editor_id, ret_domain, coalesce(retry_cnt,0) retry_cnt, b4_send_approve_yn, b4_send_verify_yn, b4_real_send_test_send_yn, ase_link_merge_param, ase_reject_merge_param, ase_open_scriptlet , groovy_link_merge_param, groovy_reject_merge_param, groovy_open_scriptlet, resend_include_returnmail_yn, resend_include_mail_key_yn, resend_error_cd, fax_resend_error_cd, sms_resend_error_cd, altalk_resend_error_cd, push_resend_error_cd , spool_preserve_period, log_preserve_period, result_file_download_yn, sucs_result_file_download_yn, kakao_template_last_sync_dtm , (SELECT mintime FROM nvdurationinfo WHERE durationinfo_cd = '01') as duration_time FROM nvserverinfo 
09-02 15:15:12.390 ttp-nio-18084-exec-7 ==> Parameters: 
09-02 15:15:12.391 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:15:12.392 ttp-nio-18084-exec-7 KakaoProfile.selectKakaoProfileList
09-02 15:15:12.392 ttp-nio-18084-exec-7 ==>  Preparing: SELECT user_id, kakao_sender_key, kakao_yellow_id, last_sync_dtm FROM nvkakaoprofile WHERE user_id = ? 
09-02 15:15:12.392 ttp-nio-18084-exec-7 ==> Parameters: admin(String)
09-02 15:15:12.393 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:15:12.394 ttp-nio-18084-exec-7 Template.selectCampaignKakaoButtons
09-02 15:15:12.394 ttp-nio-18084-exec-7 ==>  Preparing: SELECT kakao_buttons FROM nvtemplate WHERE campaign_no = ? AND seg = ' ' 
09-02 15:15:12.395 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer)
09-02 15:15:12.395 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:15:13.291 ttp-nio-18084-exec-6 Campaign.selectEditorCampaign
09-02 15:15:13.291 ttp-nio-18084-exec-6 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:15:13.292 ttp-nio-18084-exec-6 ==> Parameters: 32(Integer)
09-02 15:15:13.292 ttp-nio-18084-exec-6 <==      Total: 1
09-02 15:15:13.295 ttp-nio-18084-exec-1 MobileContents.selectEditorMmsContentsListMax
09-02 15:15:13.295 ttp-nio-18084-exec-1 ==>  Preparing: SELECT count(*) FROM nvmobilecontents WHERE file_type = ? 
09-02 15:15:13.295 ttp-nio-18084-exec-1 ==> Parameters: C(String)
09-02 15:15:13.296 ttp-nio-18084-exec-1 <==      Total: 1
09-02 15:15:13.297 ttp-nio-18084-exec-1 MobileContents.selectEditorMmsContentsList
09-02 15:15:13.297 ttp-nio-18084-exec-1 ==>  Preparing: SELECT user_id, conts_no, conts_nm, file_path, file_name, file_type, conts_txt, file_preview_path, file_preview_name, file_size , to_char(to_date(create_dt,'YYYYMMDD'),'YYYY-MM-DD') as create_dt, to_char(to_date(create_tm,'HH24MISS'),'HH:MI:SS') as create_tm FROM ( SELECT row_number() OVER (ORDER BY conts_no DESC) as rnum , user_id, conts_no, conts_nm, file_path, file_name, file_type, conts_txt, file_preview_path, file_preview_name, file_size , create_dt, create_tm FROM nvmobilecontents WHERE file_type = ? ORDER BY conts_no DESC ) a WHERE rnum BETWEEN ? AND ? 
09-02 15:15:13.298 ttp-nio-18084-exec-1 ==> Parameters: C(String), 1(Integer), 6(Integer)
09-02 15:15:13.298 ttp-nio-18084-exec-1 <==      Total: 0
09-02 15:15:13.315 ttp-nio-18084-exec-4 Campaign.selectEditorCampaign
09-02 15:15:13.315 ttp-nio-18084-exec-4 ==>  Preparing: SELECT campaign_preface, coalesce(template_type,0) template_type, survey_no, campaign_preface_ab, coalesce(handler_seq,0) handler_seq FROM nvcampaign WHERE campaign_no = ? 
09-02 15:15:13.315 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer)
09-02 15:15:13.317 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:15:13.318 ttp-nio-18084-exec-4 DefaultHandler.selectHandlerUseList
09-02 15:15:13.318 ttp-nio-18084-exec-7 Application.selectEditorCampaignHandler
09-02 15:15:13.318 ttp-nio-18084-exec-4 ==>  Preparing: SELECT seq, handle_nm, handle_desc FROM nvdefaulthandler c WHERE EXISTS ( SELECT 0 FROM nvcampaign a, nvscenario b WHERE a.scenario_no = b.scenario_no AND a.channel_type = c.channel AND b.handler_type = c.handle_type AND a.campaign_no = ? AND c.service_type IS NULL AND c.ab_test_yn = (CASE a.ab_test_type WHEN 'N' THEN 'N' ELSE 'Y' END) ) ORDER BY seq 
09-02 15:15:13.318 ttp-nio-18084-exec-7 ==>  Preparing: SELECT type, appsource FROM nvapplication WHERE campaign_no = ? 
09-02 15:15:13.318 ttp-nio-18084-exec-7 ==> Parameters: 32(Integer)
09-02 15:15:13.318 ttp-nio-18084-exec-4 ==> Parameters: 32(Integer)
09-02 15:15:13.319 ttp-nio-18084-exec-4 <==      Total: 1
09-02 15:15:13.320 ttp-nio-18084-exec-7 <==      Total: 1
09-02 15:15:13.681 ttp-nio-18084-exec-6 Semantic.selectSemanticListBySegmentNo
09-02 15:15:13.681 ttp-nio-18084-exec-6 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:15:13.681 ttp-nio-18084-exec-6 ==> Parameters: 8(Integer)
09-02 15:15:13.682 ttp-nio-18084-exec-6 <==      Total: 5
09-02 15:15:13.682 ttp-nio-18084-exec-3 Template.selectEditorCampaignFrtalkTemplate
09-02 15:15:13.682 ttp-nio-18084-exec-3 ==>  Preparing: SELECT a.seg, a.template, a.kakao_buttons, CASE WHEN a.seg = ' ' THEN 0 ELSE 1 END as seg_no , CASE WHEN b.kakao_image_no IS NULL THEN '' ELSE (SELECT file_preview_path FROM nvmobilecontents WHERE conts_no = b.kakao_image_no) end AS image_url FROM nvtemplate a, nvcampaign b WHERE a.campaign_no = b.campaign_no AND b.campaign_no = ? ORDER BY seg_no 
09-02 15:15:13.682 ttp-nio-18084-exec-3 ==> Parameters: 32(Integer)
09-02 15:15:13.684 ttp-nio-18084-exec-3 <==      Total: 1
09-02 15:15:13.685 ttp-nio-18084-exec-3 Semantic.selectSemanticListBySegmentNo
09-02 15:15:13.685 ttp-nio-18084-exec-3 ==>  Preparing: SELECT field_seq, field_nm, field_desc, coalesce(field_key,'') field_key FROM nvsemantic WHERE segment_no = ? ORDER BY field_seq 
09-02 15:15:13.685 ttp-nio-18084-exec-3 ==> Parameters: 8(Integer)
09-02 15:15:13.686 ttp-nio-18084-exec-3 <==      Total: 5
